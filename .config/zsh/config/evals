#!/bin/env zsh
# vim: filetype=zsh

export PATH=$HOME/.local/bin:/usr/local/bin:/usr/bin:$PATH

# make less more friendly for non-text input files
[ -x /usr/bin/lesspipe ] && eval "$(SHELL=/bin/sh lesspipe)"

# pay-respects
if (( ${+commands[pay-respects]} )); then
    eval "$(pay-respects zsh --alias f)"
fi

# proto
if (( ${+commands[proto]} )); then
    eval "$(proto activate zsh)"
fi

# zoxide
if (( ${+commands[zoxide]} )); then
    eval "$(zoxide init zsh --cmd cd)"
fi

# direnv
if (( ${+commands[direnv]} )); then
    eval "$(direnv hook zsh)"
fi

# phpenv
if (( ${+commands[phpenv]} )); then
    eval "$(phpenv init -)"
fi

# keychain
if (( ${+commands[keychain]} )); then
    _SSH_KEYS=()
    for key in ~/.ssh/id_*; do
        [[ ! -f "$key" ]] && continue   
        [[ "$key" == *.pub ]] && continue
        _SSH_KEYS+=("$key")
    done

    if (( ${#_SSH_KEYS[@]} )); then
        eval "$(keychain -q --noask "${_SSH_KEYS[@]}" 2>/dev/null)"
    fi
fi

# dircolors
if (( ${+commands[dircolors]} )); then
  local dcfile="${XDG_CONFIG_HOME:-$HOME/.config}/zsh/.dircolors"
  [[ -f $dcfile ]] || dircolors -p > "$dcfile"
  eval "$(dircolors -b "$dcfile")"
fi

