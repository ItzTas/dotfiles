{
  "version": 3,
  "sources": ["../../../node_modules/webextension-polyfill/dist/browser-polyfill.js", "../../../src/js/Background/background.ts", "../../../src/localization/compiled/_strings.ts", "../../../src/js/Core/Info.ts", "../../../src/js/Core/Storage/SyncedStorage.ts", "../../../src/js/Core/Storage/Storage.ts", "../../../src/js/Options/Data/Settings.ts", "../../../src/js/Core/ExtensionResources.ts", "../../../src/js/Core/Localization/Language.ts", "../../../src/js/Core/Background.ts", "../../../src/js/Core/Errors/ErrorParser.ts", "../../../src/js/Content/Modules/Facades/SteamStoreApiFacade.ts", "../../../src/js/Core/Localization/Localization.ts", "../../../src/js/Background/Modules/ContextMenu/ContextMenu.ts", "../../../node_modules/idb/build/wrap-idb-value.js", "../../../node_modules/idb/build/index.js", "../../../src/js/Background/Db/Migration.ts", "../../../src/js/Core/Storage/LocalStorage.ts", "../../../src/js/Core/Utils/TimeUtils.ts", "../../../src/js/Background/Db/IndexedDB.ts", "../../../src/js/Core/Errors/Errors.ts", "../../../src/js/Background/Modules/Api.ts", "../../../src/js/Core/Html/HtmlParser.ts", "../../../src/js/Background/Modules/Dom/OffscreenDomParser.ts", "../../../src/js/Background/Modules/Dom/DomParserFactory.ts", "../../../src/js/Background/Modules/Community/SteamCommunityApi.ts", "../../../src/js/Background/Modules/Store/SteamStoreApi.ts", "../../../src/js/config.ts", "../../../src/js/Background/Modules/IsThereAnyDeal/Authorization.ts", "../../../src/js/Background/Modules/IsThereAnyDeal/AccessToken.ts", "../../../src/js/Content/Modules/UserNotes/OutOfCapacityError.ts", "../../../src/js/Content/Modules/UserNotes/CapacityInfo.ts", "../../../src/js/Content/Modules/UserNotes/Adapters/SyncedStorageAdapter.ts", "../../../src/js/Background/Modules/IsThereAnyDeal/ITADApi.ts", "../../../src/js/Background/Modules/AugmentedSteam/AugmentedSteamApi.ts", "../../../src/js/Background/Modules/UserNotes/UserNotesApi.ts", "../../../src/js/Core/GameId/GameId.ts", "../../../src/js/Core/GameId/AppId.ts", "../../../src/js/Background/Modules/Inventory/InventoryApi.ts", "../../../src/js/Background/Modules/Cache/CacheApi.ts", "../../../src/js/Core/Environment.ts", "../../../src/js/Core/Version.ts", "../../../src/js/Core/Update/SettingsMigration.ts", "../../../src/js/Background/Modules/WebRequest/WebRequestHandler.ts", "../../../src/js/Background/Modules/Cache/SessionCacheApi.ts"],
  "sourcesContent": ["/* webextension-polyfill - v0.10.0 - Fri Aug 12 2022 19:42:44 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (!globalThis.chrome?.runtime?.id) {\n  throw new Error(\"This script should only be loaded in a browser extension.\");\n}\n\nif (typeof globalThis.browser === \"undefined\" || Object.getPrototypeOf(globalThis.browser) !== Object.prototype) {\n  const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = extensionAPIs => {\n    // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n    // at build time by replacing the following \"include\" with the content of the\n    // JSON file.\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"disable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"enable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"openPopup\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"browsingData\": {\n        \"remove\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"removeCache\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCookies\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeDownloads\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFormData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeHistory\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeLocalStorage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePasswords\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePluginData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"settings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"devtools\": {\n        \"inspectedWindow\": {\n          \"eval\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2,\n            \"singleCallbackArg\": false\n          }\n        },\n        \"panels\": {\n          \"create\": {\n            \"minArgs\": 3,\n            \"maxArgs\": 3,\n            \"singleCallbackArg\": true\n          },\n          \"elements\": {\n            \"createSidebarPane\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        }\n      },\n      \"downloads\": {\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"identity\": {\n        \"launchWebAuthFlow\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setEnabled\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"permissions\": {\n        \"contains\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"request\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getDevices\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"discard\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goBack\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goForward\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"topSites\": {\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    if (Object.keys(apiMetadata).length === 0) {\n      throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n    }\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.reject\n     *        The promise's rejection function.\n     * @param {object} metadata\n     *        Metadata about the wrapped method which has created the callback.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = (promise, metadata) => {\n      return (...callbackArgs) => {\n        if (extensionAPIs.runtime.lastError) {\n          promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n        } else if (metadata.singleCallbackArg ||\n                   (callbackArgs.length <= 1 && metadata.singleCallbackArg !== false)) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          if (metadata.fallbackToNoCallback) {\n            // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n            // and so the polyfill will try to call it with a callback first, and it will fallback\n            // to not passing the callback if the first call fails.\n            try {\n              target[name](...args, makeCallback({resolve, reject}, metadata));\n            } catch (cbError) {\n              console.warn(`${name} API method doesn't seem to support the callback parameter, ` +\n                           \"falling back to call it without a callback: \", cbError);\n\n              target[name](...args);\n\n              // Update the API method metadata, so that the next API calls will not try to\n              // use the unsupported callback anymore.\n              metadata.fallbackToNoCallback = false;\n              metadata.noCallback = true;\n\n              resolve();\n            }\n          } else if (metadata.noCallback) {\n            target[name](...args);\n            resolve();\n          } else {\n            target[name](...args, makeCallback({resolve, reject}, metadata));\n          }\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the original method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n      let handlers = {\n        has(proxyTarget, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(proxyTarget, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else if (hasOwnProperty(metadata, \"*\")) {\n            // Wrap all properties in * namespace.\n            value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(proxyTarget, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(proxyTarget, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(proxyTarget, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      // Per contract of the Proxy API, the \"get\" proxy handler must return the\n      // original value of the target if that value is declared read-only and\n      // non-configurable. For this reason, we create an object with the\n      // prototype set to `target` instead of using `target` directly.\n      // Otherwise we cannot return a custom object for APIs that\n      // are declared read-only and non-configurable, such as `chrome.devtools`.\n      //\n      // The proxy handlers themselves will still use the original `target`\n      // instead of the `proxyTarget`, so that the methods and properties are\n      // dereferenced via the original targets.\n      let proxyTarget = Object.create(target);\n      return new Proxy(proxyTarget, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps an onRequestFinished listener function so that it will return a\n       * `getContent()` property which returns a `Promise` rather than using a\n       * callback API.\n       *\n       * @param {object} req\n       *        The HAR entry object representing the network request.\n       */\n      return function onRequestFinished(req) {\n        const wrappedReq = wrapObject(req, {} /* wrappers */, {\n          getContent: {\n            minArgs: 0,\n            maxArgs: 0,\n          },\n        });\n        listener(wrappedReq);\n      };\n    });\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let didCallSendResponse = false;\n\n        let wrappedSendResponse;\n        let sendResponsePromise = new Promise(resolve => {\n          wrappedSendResponse = function(response) {\n            didCallSendResponse = true;\n            resolve(response);\n          };\n        });\n\n        let result;\n        try {\n          result = listener(message, sender, wrappedSendResponse);\n        } catch (err) {\n          result = Promise.reject(err);\n        }\n\n        const isResultThenable = result !== true && isThenable(result);\n\n        // If the listener didn't returned true or a Promise, or called\n        // wrappedSendResponse synchronously, we can exit earlier\n        // because there will be no response sent from this listener.\n        if (result !== true && !isResultThenable && !didCallSendResponse) {\n          return false;\n        }\n\n        // A small helper to send the message if the promise resolves\n        // and an error if the promise rejects (a wrapped sendMessage has\n        // to translate the message into a resolved promise or a rejected\n        // promise).\n        const sendPromisedResult = (promise) => {\n          promise.then(msg => {\n            // send the message value.\n            sendResponse(msg);\n          }, error => {\n            // Send a JSON representation of the error if the rejected value\n            // is an instance of error, or the object itself otherwise.\n            let message;\n            if (error && (error instanceof Error ||\n                typeof error.message === \"string\")) {\n              message = error.message;\n            } else {\n              message = \"An unexpected error occurred\";\n            }\n\n            sendResponse({\n              __mozWebExtensionPolyfillReject__: true,\n              message,\n            });\n          }).catch(err => {\n            // Print an error on the console if unable to send the response.\n            console.error(\"Failed to send onMessage rejected reply\", err);\n          });\n        };\n\n        // If the listener returned a Promise, send the resolved value as a\n        // result, otherwise wait the promise related to the wrappedSendResponse\n        // callback to resolve and send it as a response.\n        if (isResultThenable) {\n          sendPromisedResult(result);\n        } else {\n          sendPromisedResult(sendResponsePromise);\n        }\n\n        // Let Chrome know that the listener is replying.\n        return true;\n      };\n    });\n\n    const wrappedSendMessageCallback = ({reject, resolve}, reply) => {\n      if (extensionAPIs.runtime.lastError) {\n        // Detect when none of the listeners replied to the sendMessage call and resolve\n        // the promise to undefined as in Firefox.\n        // See https://github.com/mozilla/webextension-polyfill/issues/130\n        if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n          resolve();\n        } else {\n          reject(new Error(extensionAPIs.runtime.lastError.message));\n        }\n      } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n        // Convert back the JSON representation of the error into\n        // an Error instance.\n        reject(new Error(reply.message));\n      } else {\n        resolve(reply);\n      }\n    };\n\n    const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n      if (args.length < metadata.minArgs) {\n        throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      if (args.length > metadata.maxArgs) {\n        throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      return new Promise((resolve, reject) => {\n        const wrappedCb = wrappedSendMessageCallback.bind(null, {resolve, reject});\n        args.push(wrappedCb);\n        apiNamespaceObj.sendMessage(...args);\n      });\n    };\n\n    const staticWrappers = {\n      devtools: {\n        network: {\n          onRequestFinished: wrapEvent(onRequestFinishedWrappers),\n        },\n      },\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n        onMessageExternal: wrapEvent(onMessageWrappers),\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 1, maxArgs: 3}),\n      },\n      tabs: {\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 2, maxArgs: 3}),\n      },\n    };\n    const settingMetadata = {\n      clear: {minArgs: 1, maxArgs: 1},\n      get: {minArgs: 1, maxArgs: 1},\n      set: {minArgs: 1, maxArgs: 1},\n    };\n    apiMetadata.privacy = {\n      network: {\"*\": settingMetadata},\n      services: {\"*\": settingMetadata},\n      websites: {\"*\": settingMetadata},\n    };\n\n    return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n  };\n\n  // The build process adds a UMD wrapper around this file, which makes the\n  // `module` variable available.\n  module.exports = wrapAPIs(chrome);\n} else {\n  module.exports = globalThis.browser;\n}\n", "import ContextMenu from \"./Modules/ContextMenu/ContextMenu\";\r\nimport IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport SteamCommunityApi from \"./Modules/Community/SteamCommunityApi\";\r\nimport SteamStoreApi from \"./Modules/Store/SteamStoreApi\";\r\nimport ITADApi from \"./Modules/IsThereAnyDeal/ITADApi\";\r\nimport AugmentedSteamApi from \"./Modules/AugmentedSteam/AugmentedSteamApi\";\r\nimport UserNotesApi from \"./Modules/UserNotes/UserNotesApi\";\r\nimport browser, {type Runtime, type Storage as ns} from \"webextension-polyfill\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport InventoryApi from \"@Background/Modules/Inventory/InventoryApi\";\r\nimport CacheApi from \"@Background/Modules/Cache/CacheApi\";\r\nimport {SettingsStore} from \"@Options/Data/Settings\";\r\nimport Environment, {ContextType} from \"@Core/Environment\";\r\nimport SettingsMigration from \"@Core/Update/SettingsMigration\";\r\nimport Version from \"@Core/Version\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport Storage from \"@Core/Storage/Storage\";\r\nimport WebRequestHandler from \"@Background/Modules/WebRequest/WebRequestHandler\";\r\nimport SessionCacheApi from \"@Background/Modules/Cache/SessionCacheApi\";\r\n\r\nEnvironment.CurrentContext = ContextType.Background;\r\n\r\ntype MessageSender = Runtime.MessageSender;\r\n\r\ntype Message = {\r\n    action: string,\r\n    params: any\r\n};\r\n\r\nexport const Unrecognized = Symbol(\"Unrecognized\");\r\n\r\nbrowser.runtime.onInstalled.addListener(async (detail) => {\r\n    if (detail.reason !== \"update\" || detail.previousVersion === undefined) {\r\n        return;\r\n    }\r\n\r\n    const oldVersion = Version.fromString(detail.previousVersion);\r\n\r\n    await IndexedDB.init();\r\n    await SettingsMigration.migrate(oldVersion);\r\n    await (new CacheApi()).handle(EAction.CacheClear);\r\n\r\n    /*\r\n     * Local storage migration\r\n     * TODO remove in next minor version\r\n     */\r\n    await (async function() {\r\n        const localStorage = new Storage<ns.LocalStorageArea, {es_guide_tags: Record<string, string[]>}>(browser.storage.local);\r\n        await localStorage.remove(\"es_guide_tags\");\r\n    })();\r\n\r\n    console.log(\"Update done\");\r\n});\r\n\r\n\r\nconst messageHandlers: MessageHandlerInterface[] = [\r\n    new AugmentedSteamApi(),\r\n    new SteamCommunityApi(),\r\n    new InventoryApi(),\r\n    new ITADApi(),\r\n    new SteamStoreApi(),\r\n    new UserNotesApi(),\r\n    new WebRequestHandler(),\r\n    new CacheApi(),\r\n    new SessionCacheApi()\r\n];\r\n\r\nbrowser.runtime.onMessage.addListener((\r\n    message: Message,\r\n    sender: MessageSender\r\n): undefined|Promise<any> => {\r\n\r\n    if (!sender || !sender.tab) { // not from a tab, ignore\r\n        return;\r\n    }\r\n    if (!message || !message.action) {\r\n        return;\r\n    }\r\n\r\n    return (async () => {\r\n        try {\r\n            await Promise.all([IndexedDB.init(), SettingsStore.init()]);\r\n\r\n            let response: any = undefined;\r\n            for (const handler of messageHandlers) {\r\n                response = await handler.handle(message, sender.tab);\r\n                if (response !== Unrecognized) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (response === Unrecognized) {\r\n                throw new Error(\"Unknown message\");\r\n            }\r\n\r\n            return response;\r\n        } catch (err) {\r\n            console.group(`Callback: \"${message.action}\"`);\r\n            console.error(\"Failed to execute %o\", message);\r\n            console.error(err);\r\n            console.groupEnd();\r\n\r\n            throw new Error((<Error>err).toString());\r\n        }\r\n    })();\r\n});\r\n\r\nContextMenu.register();\r\n", "export const __deleteCommentPrompt = \"deleteCommentPrompt\";\r\nexport const __downloadDemoHeader = \"downloadDemoHeader\";\r\nexport const __featureHint_desc = \"featureHint_desc\";\r\nexport const __featureHint_reminder = \"featureHint_reminder\";\r\nexport const __thewordyes = \"thewordyes\";\r\nexport const __thewordno = \"thewordno\";\r\nexport const __theworderror = \"theworderror\";\r\nexport const __noData = \"noData\";\r\nexport const __toomanyrequests = \"toomanyrequests\";\r\nexport const __showComments = \"showComments\";\r\nexport const __hideComments = \"hideComments\";\r\nexport const __thewordunknown = \"thewordunknown\";\r\nexport const __calcWorkshopSize_fileSize = \"calcWorkshopSize_fileSize\";\r\nexport const __calcWorkshopSize_calcSize = \"calcWorkshopSize_calcSize\";\r\nexport const __calcWorkshopSize_calcLoading = \"calcWorkshopSize_calcLoading\";\r\nexport const __calcWorkshopSize_calcFinished = \"calcWorkshopSize_calcFinished\";\r\nexport const __calcWorkshopSize_totalSize = \"calcWorkshopSize_totalSize\";\r\nexport const __cart = \"cart\";\r\nexport const __inCart = \"inCart\";\r\nexport const __steamidOfUser = \"steamidOfUser\";\r\nexport const __copied = \"copied\";\r\nexport const __viewSteamid = \"viewSteamid\";\r\nexport const __moreOnSteampeek = \"moreOnSteampeek\";\r\nexport const __date = \"date\";\r\nexport const __rating = \"rating\";\r\nexport const __helpful = \"helpful\";\r\nexport const __funny = \"funny\";\r\nexport const __length = \"length\";\r\nexport const __visibility = \"visibility\";\r\nexport const __processing = \"processing\";\r\nexport const __wait = \"wait\";\r\nexport const __inviteFriends = \"inviteFriends\";\r\nexport const __inviteToGroup = \"inviteToGroup\";\r\nexport const __inverse = \"inverse\";\r\nexport const __transactionStatus = \"transactionStatus\";\r\nexport const __customTags = \"customTags\";\r\nexport const __addTag = \"addTag\";\r\nexport const __enterTag = \"enterTag\";\r\nexport const __status = \"status\";\r\nexport const __connect = \"connect\";\r\nexport const __connected = \"connected\";\r\nexport const __disconnect = \"disconnect\";\r\nexport const __disconnected = \"disconnected\";\r\nexport const __oneclickgoo = \"oneclickgoo\";\r\nexport const __viewInLibrary = \"viewInLibrary\";\r\nexport const __support = \"support\";\r\nexport const __email = \"email\";\r\nexport const __contact = \"contact\";\r\nexport const __favEmoticonsDragging = \"favEmoticonsDragging\";\r\nexport const __favEmoticonsNoAccess = \"favEmoticonsNoAccess\";\r\nexport const __postHistory = \"postHistory\";\r\nexport const __addNickname = \"addNickname\";\r\nexport const __totalSize = \"totalSize\";\r\nexport const __dlcDetails = \"dlcDetails\";\r\nexport const __badgeNotUnlocked = \"badgeNotUnlocked\";\r\nexport const __badgeLevel = \"badgeLevel\";\r\nexport const __each = \"each\";\r\nexport const __viewInMarket = \"viewInMarket\";\r\nexport const __remove = \"remove\";\r\nexport const __getHelp = \"getHelp\";\r\nexport const __addSelectedDlcToCart = \"addSelectedDlcToCart\";\r\nexport const __close = \"close\";\r\nexport const __error = \"error\";\r\nexport const __go = \"go\";\r\nexport const __activate = \"activate\";\r\nexport const __activateMultipleHeader = \"activateMultipleHeader\";\r\nexport const __activateMultiple = \"activateMultiple\";\r\nexport const __activateProducts = \"activateProducts\";\r\nexport const __couponApplicationNote = \"couponApplicationNote\";\r\nexport const __hide = \"hide\";\r\nexport const __filters = \"filters\";\r\nexport const __cardsOwned = \"cardsOwned\";\r\nexport const __libraryMenu = \"libraryMenu\";\r\nexport const __clearCache = \"clearCache\";\r\nexport const __translation = \"translation\";\r\nexport const __helpTranslate = \"helpTranslate\";\r\nexport const __lowest = \"lowest\";\r\nexport const __lowestPrice = \"lowestPrice\";\r\nexport const __viewBadgeProgress = \"viewBadgeProgress\";\r\nexport const __badgeProgress = \"badgeProgress\";\r\nexport const __salesTotal = \"salesTotal\";\r\nexport const __viewNormalBadge = \"viewNormalBadge\";\r\nexport const __apppageSections = \"apppageSections\";\r\nexport const __website = \"website\";\r\nexport const __games = \"games\";\r\nexport const __badgeCompletionCost = \"badgeCompletionCost\";\r\nexport const __loading = \"loading\";\r\nexport const __selling = \"selling\";\r\nexport const __saving = \"saving\";\r\nexport const __saved = \"saved\";\r\nexport const __quickSell = \"quickSell\";\r\nexport const __quickSellDesc = \"quickSellDesc\";\r\nexport const __instantSell = \"instantSell\";\r\nexport const __instantSellDesc = \"instantSellDesc\";\r\nexport const __quickSellVerify = \"quickSellVerify\";\r\nexport const __startingAt = \"startingAt\";\r\nexport const __homepageTabs = \"homepageTabs\";\r\nexport const __store = \"store\";\r\nexport const __viewInStore = \"viewInStore\";\r\nexport const __communityHub = \"communityHub\";\r\nexport const __viewOnWebsite = \"viewOnWebsite\";\r\nexport const __drmThirdParty = \"drmThirdParty\";\r\nexport const __hoursShort = \"hoursShort\";\r\nexport const __spamCommentShow = \"spamCommentShow\";\r\nexport const __addToWishlist = \"addToWishlist\";\r\nexport const __addFullgameToWishlist = \"addFullgameToWishlist\";\r\nexport const __addToWaitlist = \"addToWaitlist\";\r\nexport const __addFullgameToWaitlist = \"addFullgameToWaitlist\";\r\nexport const __removeFromWaitlistTooltip = \"removeFromWaitlistTooltip\";\r\nexport const __removeFullgameFromWaitlistTooltip = \"removeFullgameFromWaitlistTooltip\";\r\nexport const __removeFromWishlistAndWaitlistTooltip = \"removeFromWishlistAndWaitlistTooltip\";\r\nexport const __removeFullgameFromWishlistAndWaitlistTooltip = \"removeFullgameFromWishlistAndWaitlistTooltip\";\r\nexport const __language = \"language\";\r\nexport const __theworddefault = \"theworddefault\";\r\nexport const __thewordclear = \"thewordclear\";\r\nexport const __retry = \"retry\";\r\nexport const __couponLearnMore_linkText = \"couponLearnMore_linkText\";\r\nexport const __couponLearnMore_fullText = \"couponLearnMore_fullText\";\r\nexport const __show = \"show\";\r\nexport const __showAll = \"showAll\";\r\nexport const __badgesAll = \"badgesAll\";\r\nexport const __esSupporter = \"esSupporter\";\r\nexport const __community = \"community\";\r\nexport const __ownedCollection = \"ownedCollection\";\r\nexport const __viewBadge = \"viewBadge\";\r\nexport const __purchaseTotal = \"purchaseTotal\";\r\nexport const __viewFoilBadge = \"viewFoilBadge\";\r\nexport const __viewAstats = \"viewAstats\";\r\nexport const __contribute = \"contribute\";\r\nexport const __reviews = \"reviews\";\r\nexport const __readReviews = \"readReviews\";\r\nexport const __readMoreReviews = \"readMoreReviews\";\r\nexport const __youtubeGameplay = \"youtubeGameplay\";\r\nexport const __youtubeReviews = \"youtubeReviews\";\r\nexport const __packageInfo = \"packageInfo\";\r\nexport const __badgeCompletionAvg = \"badgeCompletionAvg\";\r\nexport const __volumeSoldLast_24 = \"volumeSoldLast_24\";\r\nexport const __soldLast_24 = \"soldLast_24\";\r\nexport const __homepageCurators = \"homepageCurators\";\r\nexport const __homepageTopnewreleases = \"homepageTopnewreleases\";\r\nexport const __homepageSidebar = \"homepageSidebar\";\r\nexport const __dropCalc = \"dropCalc\";\r\nexport const __price = \"price\";\r\nexport const __marketTransactions = \"marketTransactions\";\r\nexport const __loadMarketStats = \"loadMarketStats\";\r\nexport const __cardDropsRemaining = \"cardDropsRemaining\";\r\nexport const __badgesDrops = \"badgesDrops\";\r\nexport const __usingLanguageReturn = \"usingLanguageReturn\";\r\nexport const __guides = \"guides\";\r\nexport const __highlight = \"highlight\";\r\nexport const __save = \"save\";\r\nexport const __view = \"view\";\r\nexport const __gameName = \"gameName\";\r\nexport const __notinterested = \"notinterested\";\r\nexport const __ignoredOwned = \"ignoredOwned\";\r\nexport const __searchFilters_reviewsScore_between = \"searchFilters_reviewsScore_between\";\r\nexport const __searchFilters_reviewsScore_any = \"searchFilters_reviewsScore_any\";\r\nexport const __searchFilters_reviewsScore_upTo = \"searchFilters_reviewsScore_upTo\";\r\nexport const __searchFilters_reviewsScore_from = \"searchFilters_reviewsScore_from\";\r\nexport const __searchFilters_reviewsCount_count = \"searchFilters_reviewsCount_count\";\r\nexport const __searchFilters_reviewsCount_minCount = \"searchFilters_reviewsCount_minCount\";\r\nexport const __searchFilters_reviewsCount_maxCount = \"searchFilters_reviewsCount_maxCount\";\r\nexport const __searchFilters_discountPercent_count = \"searchFilters_discountPercent_count\";\r\nexport const __searchFilters_discountPercent_minCount = \"searchFilters_discountPercent_minCount\";\r\nexport const __searchFilters_discountPercent_maxCount = \"searchFilters_discountPercent_maxCount\";\r\nexport const __searchFilters_hideCart = \"searchFilters_hideCart\";\r\nexport const __searchFilters_hideEa = \"searchFilters_hideEa\";\r\nexport const __searchFilters_hideMixed = \"searchFilters_hideMixed\";\r\nexport const __searchFilters_hideNegative = \"searchFilters_hideNegative\";\r\nexport const __news = \"news\";\r\nexport const __viewinclient = \"viewinclient\";\r\nexport const __customBackground = \"customBackground\";\r\nexport const __customStyle = \"customStyle\";\r\nexport const __customStyleHelp = \"customStyleHelp\";\r\nexport const __noneselected = \"noneselected\";\r\nexport const __mostDrops = \"mostDrops\";\r\nexport const __netGain = \"netGain\";\r\nexport const __apppageRecentupdates = \"apppageRecentupdates\";\r\nexport const __apppageEaheader = \"apppageEaheader\";\r\nexport const __apppageEabanner = \"apppageEabanner\";\r\nexport const __apppageWorkshop = \"apppageWorkshop\";\r\nexport const __apppageGreenlight = \"apppageGreenlight\";\r\nexport const __apppageLegal = \"apppageLegal\";\r\nexport const __apppageFranchise = \"apppageFranchise\";\r\nexport const __apppageMorefromfranchise = \"apppageMorefromfranchise\";\r\nexport const __bugFeature = \"bugFeature\";\r\nexport const __always = \"always\";\r\nexport const __ratingDetails = \"ratingDetails\";\r\nexport const __dropsWorthAvg = \"dropsWorthAvg\";\r\nexport const __familySharingNotice_notice = \"familySharingNotice_notice\";\r\nexport const __familySharingNotice_desc = \"familySharingNotice_desc\";\r\nexport const __visitStore = \"visitStore\";\r\nexport const __all = \"all\";\r\nexport const __externalFunds = \"externalFunds\";\r\nexport const __shoppingCartHistory = \"shoppingCartHistory\";\r\nexport const __manageWebapiKey = \"manageWebapiKey\";\r\nexport const __steamCloudHeader = \"steamCloudHeader\";\r\nexport const __steamCloudSaves = \"steamCloudSaves\";\r\nexport const __gamesWithDrops = \"gamesWithDrops\";\r\nexport const __binderView = \"binderView\";\r\nexport const __usingLanguage = \"usingLanguage\";\r\nexport const __loginWarning = \"loginWarning\";\r\nexport const __visitTradeForum = \"visitTradeForum\";\r\nexport const __purchaseDate = \"purchaseDate\";\r\nexport const __customBackgroundHelp = \"customBackgroundHelp\";\r\nexport const __dateUnlocked = \"dateUnlocked\";\r\nexport const __netSpent = \"netSpent\";\r\nexport const __buy = \"buy\";\r\nexport const __buyPackage = \"buyPackage\";\r\nexport const __moreInformation = \"moreInformation\";\r\nexport const __regionUnavailable = \"regionUnavailable\";\r\nexport const __avgPrice_3cards = \"avgPrice_3cards\";\r\nexport const __groups_leaveGroupsConfirm = \"groups_leaveGroupsConfirm\";\r\nexport const __groups_manageGroups = \"groups_manageGroups\";\r\nexport const __groups_actionGroups = \"groups_actionGroups\";\r\nexport const __groups_select = \"groups_select\";\r\nexport const __groups_leave = \"groups_leave\";\r\nexport const __groups_selected = \"groups_selected\";\r\nexport const __groups_leaveAdminConfirm_currentlyAdmin = \"groups_leaveAdminConfirm_currentlyAdmin\";\r\nexport const __groups_leaveAdminConfirm_wantToLeave = \"groups_leaveAdminConfirm_wantToLeave\";\r\nexport const __export_wishlist = \"export_wishlist\";\r\nexport const __export_type = \"export_type\";\r\nexport const __export_format = \"export_format\";\r\nexport const __export_text = \"export_text\";\r\nexport const __export_download = \"export_download\";\r\nexport const __export_copyClipboard = \"export_copyClipboard\";\r\nexport const __none = \"none\";\r\nexport const __emptyWishlist_title = \"emptyWishlist_title\";\r\nexport const __emptyWishlist_confirm = \"emptyWishlist_confirm\";\r\nexport const __emptyWishlist_removing = \"emptyWishlist_removing\";\r\nexport const __about = \"about\";\r\nexport const __never = \"never\";\r\nexport const __couponAvailable = \"couponAvailable\";\r\nexport const __launchRandom = \"launchRandom\";\r\nexport const __launchRandomGameError = \"launchRandomGameError\";\r\nexport const __playGame = \"playGame\";\r\nexport const __dropsValue = \"dropsValue\";\r\nexport const __cardsRemain = \"cardsRemain\";\r\nexport const __wishlist = \"wishlist\";\r\nexport const __onWishlist = \"onWishlist\";\r\nexport const __onWaitlist = \"onWaitlist\";\r\nexport const __onWishlistAndWaitlist = \"onWishlistAndWaitlist\";\r\nexport const __ok = \"ok\";\r\nexport const __cancel = \"cancel\";\r\nexport const __wikiArticle = \"wikiArticle\";\r\nexport const __viewAll = \"viewAll\";\r\nexport const __gamesWithBooster = \"gamesWithBooster\";\r\nexport const __sortBy = \"sortBy\";\r\nexport const __playtime = \"playtime\";\r\nexport const __awards = \"awards\";\r\nexport const __year = \"year\";\r\nexport const __lastonline = \"lastonline\";\r\nexport const __members = \"members\";\r\nexport const __name = \"name\";\r\nexport const __drmThirdPartySub = \"drmThirdPartySub\";\r\nexport const __customize = \"customize\";\r\nexport const __bundleSavingText = \"bundleSavingText\";\r\nexport const __thewordoptions = \"thewordoptions\";\r\nexport const __discussions = \"discussions\";\r\nexport const __pricing_lowestPrice = \"pricing_lowestPrice\";\r\nexport const __pricing_historicalLow = \"pricing_historicalLow\";\r\nexport const __pricing_bundled = \"pricing_bundled\";\r\nexport const __pricing_withVoucher = \"pricing_withVoucher\";\r\nexport const __pricing_store = \"pricing_store\";\r\nexport const __pricing_bundleCount = \"pricing_bundleCount\";\r\nexport const __webBrowserChat = \"webBrowserChat\";\r\nexport const __steamClientChat = \"steamClientChat\";\r\nexport const __equipOnProfile = \"equipOnProfile\";\r\nexport const __previewBackground = \"previewBackground\";\r\nexport const __expandSlider = \"expandSlider\";\r\nexport const __contractSlider = \"contractSlider\";\r\nexport const __earlyAccess = \"earlyAccess\";\r\nexport const __tagShort = \"tagShort\";\r\nexport const __noPriceData = \"noPriceData\";\r\nexport const __userScore = \"userScore\";\r\nexport const __marketPopularItemsToggle = \"marketPopularItemsToggle\";\r\nexport const __showProgressbar = \"showProgressbar\";\r\nexport const __achievements_option = \"achievements_option\";\r\nexport const __achievements_summary = \"achievements_summary\";\r\nexport const __bundle_offerEnds = \"bundle_offerEnds\";\r\nexport const __bundle_includes = \"bundle_includes\";\r\nexport const __bundle_tierIncludes = \"bundle_tierIncludes\";\r\nexport const __bundle_tier = \"bundle_tier\";\r\nexport const __bundle_header = \"bundle_header\";\r\nexport const __bundle_info = \"bundle_info\";\r\nexport const __charts_peakall = \"charts_peakall\";\r\nexport const __charts_current = \"charts_current\";\r\nexport const __charts_playingNow = \"charts_playingNow\";\r\nexport const __charts_peaktoday = \"charts_peaktoday\";\r\nexport const __hltb_title = \"hltb_title\";\r\nexport const __hltb_mainE = \"hltb_mainE\";\r\nexport const __hltb_compl = \"hltb_compl\";\r\nexport const __hltb_main = \"hltb_main\";\r\nexport const __options_friendsAndGroups = \"options_friendsAndGroups\";\r\nexport const __options_friendsAppendNickname = \"options_friendsAppendNickname\";\r\nexport const __options_settingsMngmt_import = \"options_settingsMngmt_import\";\r\nexport const __options_settingsMngmt_importSuccess = \"options_settingsMngmt_importSuccess\";\r\nexport const __options_settingsMngmt_importFail = \"options_settingsMngmt_importFail\";\r\nexport const __options_settingsMngmt_export = \"options_settingsMngmt_export\";\r\nexport const __options_settingsMngmt_reset = \"options_settingsMngmt_reset\";\r\nexport const __options_showCustomThemes = \"options_showCustomThemes\";\r\nexport const __options_communityDefaultTab = \"options_communityDefaultTab\";\r\nexport const __options_videos = \"options_videos\";\r\nexport const __options_broadcasts = \"options_broadcasts\";\r\nexport const __options_artwork = \"options_artwork\";\r\nexport const __options_screenshots = \"options_screenshots\";\r\nexport const __options_showBacktotop = \"options_showBacktotop\";\r\nexport const __options_contextMenu = \"options_contextMenu\";\r\nexport const __options_contextSteamStore = \"options_contextSteamStore\";\r\nexport const __options_contextSteamLucky = \"options_contextSteamLucky\";\r\nexport const __options_contextSteamMarket = \"options_contextSteamMarket\";\r\nexport const __options_contextItad = \"options_contextItad\";\r\nexport const __options_contextBartervg = \"options_contextBartervg\";\r\nexport const __options_contextSteamdb = \"options_contextSteamdb\";\r\nexport const __options_contextSteamdbInstant = \"options_contextSteamdbInstant\";\r\nexport const __options_contextSteamKeys = \"options_contextSteamKeys\";\r\nexport const __options_wsgf = \"options_wsgf\";\r\nexport const __options_versionShow = \"options_versionShow\";\r\nexport const __options_steamcardexchange = \"options_steamcardexchange\";\r\nexport const __options_regionalPrice = \"options_regionalPrice\";\r\nexport const __options_excludef2p = \"options_excludef2p\";\r\nexport const __options_profileLinkImagesNone = \"options_profileLinkImagesNone\";\r\nexport const __options_profileLinks = \"options_profileLinks\";\r\nexport const __options_tag = \"options_tag\";\r\nexport const __options_icon = \"options_icon\";\r\nexport const __options_name = \"options_name\";\r\nexport const __options_showAlternativeLinuxIcon = \"options_showAlternativeLinuxIcon\";\r\nexport const __options_replacecommunityhublinks = \"options_replacecommunityhublinks\";\r\nexport const __options_hideannouncementcomments = \"options_hideannouncementcomments\";\r\nexport const __options_hidetmsymbols = \"options_hidetmsymbols\";\r\nexport const __options_metacritic = \"options_metacritic\";\r\nexport const __options_opencritic = \"options_opencritic\";\r\nexport const __options_hideactivelistings = \"options_hideactivelistings\";\r\nexport const __options_showlowestmarketprice = \"options_showlowestmarketprice\";\r\nexport const __options_clear = \"options_clear\";\r\nexport const __options_coupon = \"options_coupon\";\r\nexport const __options_showPackageInfo = \"options_showPackageInfo\";\r\nexport const __options_wlbuttoncommunityapp = \"options_wlbuttoncommunityapp\";\r\nexport const __options_removeguideslanguagefilter = \"options_removeguideslanguagefilter\";\r\nexport const __options_confirmdeletecomment = \"options_confirmdeletecomment\";\r\nexport const __options_disablelinkfilter = \"options_disablelinkfilter\";\r\nexport const __options_regionalPriceOn = \"options_regionalPriceOn\";\r\nexport const __options_horizontalscrolling = \"options_horizontalscrolling\";\r\nexport const __options_supportinfo = \"options_supportinfo\";\r\nexport const __options_drm = \"options_drm\";\r\nexport const __options_profileLinkImages = \"options_profileLinkImages\";\r\nexport const __options_show1clickgoo = \"options_show1clickgoo\";\r\nexport const __options_hltb = \"options_hltb\";\r\nexport const __options_hidespamcomments = \"options_hidespamcomments\";\r\nexport const __options_gift = \"options_gift\";\r\nexport const __options_regionalPriceMouse = \"options_regionalPriceMouse\";\r\nexport const __options_storesAll = \"options_storesAll\";\r\nexport const __options_viewInCurrency = \"options_viewInCurrency\";\r\nexport const __options_showEarlyAccess = \"options_showEarlyAccess\";\r\nexport const __options_profileLinkImagesGray = \"options_profileLinkImagesGray\";\r\nexport const __options_quickinv = \"options_quickinv\";\r\nexport const __options_quickinvDiff = \"options_quickinvDiff\";\r\nexport const __options_sendAgeInfo = \"options_sendAgeInfo\";\r\nexport const __options_removebroadcasts = \"options_removebroadcasts\";\r\nexport const __options_preventVideoPause = \"options_preventVideoPause\";\r\nexport const __options_tabtitleAppnameFirst = \"options_tabtitleAppnameFirst\";\r\nexport const __options_exfgls = \"options_exfgls\";\r\nexport const __options_youtube = \"options_youtube\";\r\nexport const __options_twitch = \"options_twitch\";\r\nexport const __options_pcgw = \"options_pcgw\";\r\nexport const __options_completionistme = \"options_completionistme\";\r\nexport const __options_protondb = \"options_protondb\";\r\nexport const __options_storeSteamcards = \"options_storeSteamcards\";\r\nexport const __options_spamcommentregex = \"options_spamcommentregex\";\r\nexport const __options_regionalHideworld = \"options_regionalHideworld\";\r\nexport const __options_showAstatslink = \"options_showAstatslink\";\r\nexport const __options_showYoutubegameplay = \"options_showYoutubegameplay\";\r\nexport const __options_showYoutubereviews = \"options_showYoutubereviews\";\r\nexport const __options_openinnewtab = \"options_openinnewtab\";\r\nexport const __options_showbartervg = \"options_showbartervg\";\r\nexport const __options_guest = \"options_guest\";\r\nexport const __options_collection = \"options_collection\";\r\nexport const __options_waitlist = \"options_waitlist\";\r\nexport const __options_showPlayersInfo = \"options_showPlayersInfo\";\r\nexport const __options_showallstats = \"options_showallstats\";\r\nexport const __options_lowestpriceOnwishlist = \"options_lowestpriceOnwishlist\";\r\nexport const __options_profileSteamid = \"options_profileSteamid\";\r\nexport const __options_profilePinnedBg = \"options_profilePinnedBg\";\r\nexport const __options_lowestprice = \"options_lowestprice\";\r\nexport const __options_owned = \"options_owned\";\r\nexport const __options_itadlinks = \"options_itadlinks\";\r\nexport const __options_steamdb = \"options_steamdb\";\r\nexport const __options_profileLinkImagesColor = \"options_profileLinkImagesColor\";\r\nexport const __options_showViewInLibrary = \"options_showViewInLibrary\";\r\nexport const __options_installSteamButton = \"options_installSteamButton\";\r\nexport const __options_replaceViewClient = \"options_replaceViewClient\";\r\nexport const __options_showEmptyWishlist = \"options_showEmptyWishlist\";\r\nexport const __options_showWishlistStats = \"options_showWishlistStats\";\r\nexport const __options_oneclickremovewl = \"options_oneclickremovewl\";\r\nexport const __options_userNotes_userNotes = \"options_userNotes_userNotes\";\r\nexport const __options_userNotes_app = \"options_userNotes_app\";\r\nexport const __options_userNotes_wishlist = \"options_userNotes_wishlist\";\r\nexport const __options_userNotes_loc = \"options_userNotes_loc\";\r\nexport const __options_userNotes_syncedStorage = \"options_userNotes_syncedStorage\";\r\nexport const __options_userNotes_local = \"options_userNotes_local\";\r\nexport const __options_userNotes_saveWithEnter = \"options_userNotes_saveWithEnter\";\r\nexport const __options_inventoryNavText = \"options_inventoryNavText\";\r\nexport const __options_marketTotal = \"options_marketTotal\";\r\nexport const __options_lowestpriceCoupon = \"options_lowestpriceCoupon\";\r\nexport const __options_general = \"options_general\";\r\nexport const __options_apppage = \"options_apppage\";\r\nexport const __options_market = \"options_market\";\r\nexport const __options_inventory = \"options_inventory\";\r\nexport const __options_profile = \"options_profile\";\r\nexport const __options_group = \"options_group\";\r\nexport const __options_friendActivity = \"options_friendActivity\";\r\nexport const __options_groupLinks = \"options_groupLinks\";\r\nexport const __options_showLanguagewarning = \"options_showLanguagewarning\";\r\nexport const __options_homepage = \"options_homepage\";\r\nexport const __options_homepageDefaultTab = \"options_homepageDefaultTab\";\r\nexport const __options_homepageDefaultTabRemember = \"options_homepageDefaultTabRemember\";\r\nexport const __options_homepageDefaultTabNewreleases = \"options_homepageDefaultTabNewreleases\";\r\nexport const __options_homepageDefaultTabTopsellers = \"options_homepageDefaultTabTopsellers\";\r\nexport const __options_homepageDefaultTabUpcoming = \"options_homepageDefaultTabUpcoming\";\r\nexport const __options_homepageDefaultTabSpecials = \"options_homepageDefaultTabSpecials\";\r\nexport const __options_homepageDefaultTabFree = \"options_homepageDefaultTabFree\";\r\nexport const __options_wishlist = \"options_wishlist\";\r\nexport const __options_followed = \"options_followed\";\r\nexport const __options_addAnotherRegion = \"options_addAnotherRegion\";\r\nexport const __options_skipGotSteam = \"options_skipGotSteam\";\r\nexport const __options_storeGeneralThirdparty = \"options_storeGeneralThirdparty\";\r\nexport const __options_purchaseDates = \"options_purchaseDates\";\r\nexport const __options_showBadgeProgress = \"options_showBadgeProgress\";\r\nexport const __options_showCoupon = \"options_showCoupon\";\r\nexport const __options_showWishlistLink = \"options_showWishlistLink\";\r\nexport const __options_showWishlistCount = \"options_showWishlistCount\";\r\nexport const __options_profileShowcaseTwitch = \"options_profileShowcaseTwitch\";\r\nexport const __options_profileShowcaseOwnTwitch = \"options_profileShowcaseOwnTwitch\";\r\nexport const __options_profileShowcaseTwitchProfileonly = \"options_profileShowcaseTwitchProfileonly\";\r\nexport const __options_lang_english = \"options_lang_english\";\r\nexport const __options_lang_brazilian = \"options_lang_brazilian\";\r\nexport const __options_lang_bulgarian = \"options_lang_bulgarian\";\r\nexport const __options_lang_czech = \"options_lang_czech\";\r\nexport const __options_lang_danish = \"options_lang_danish\";\r\nexport const __options_lang_dutch = \"options_lang_dutch\";\r\nexport const __options_lang_finnish = \"options_lang_finnish\";\r\nexport const __options_lang_french = \"options_lang_french\";\r\nexport const __options_lang_greek = \"options_lang_greek\";\r\nexport const __options_lang_german = \"options_lang_german\";\r\nexport const __options_lang_hungarian = \"options_lang_hungarian\";\r\nexport const __options_lang_indonesian = \"options_lang_indonesian\";\r\nexport const __options_lang_italian = \"options_lang_italian\";\r\nexport const __options_lang_japanese = \"options_lang_japanese\";\r\nexport const __options_lang_koreana = \"options_lang_koreana\";\r\nexport const __options_lang_norwegian = \"options_lang_norwegian\";\r\nexport const __options_lang_polish = \"options_lang_polish\";\r\nexport const __options_lang_portuguese = \"options_lang_portuguese\";\r\nexport const __options_lang_russian = \"options_lang_russian\";\r\nexport const __options_lang_romanian = \"options_lang_romanian\";\r\nexport const __options_lang_schinese = \"options_lang_schinese\";\r\nexport const __options_lang_spanish = \"options_lang_spanish\";\r\nexport const __options_lang_latam = \"options_lang_latam\";\r\nexport const __options_lang_swedish = \"options_lang_swedish\";\r\nexport const __options_lang_tchinese = \"options_lang_tchinese\";\r\nexport const __options_lang_thai = \"options_lang_thai\";\r\nexport const __options_lang_turkish = \"options_lang_turkish\";\r\nexport const __options_lang_ukrainian = \"options_lang_ukrainian\";\r\nexport const __options_lang_vietnamese = \"options_lang_vietnamese\";\r\nexport const __options_addCustomLink = \"options_addCustomLink\";\r\nexport const __options_autoDetect = \"options_autoDetect\";\r\nexport const __options_addToWaitlist = \"options_addToWaitlist\";\r\nexport const __options_collectionBannerNotOwned = \"options_collectionBannerNotOwned\";\r\nexport const __options_maintainers = \"options_maintainers\";\r\nexport const __options_withHelpOf = \"options_withHelpOf\";\r\nexport const __options_contributors = \"options_contributors\";\r\nexport const __options_aboutDesc = \"options_aboutDesc\";\r\nexport const __options_aboutDescLinks = \"options_aboutDescLinks\";\r\nexport const __options_footerFork = \"options_footerFork\";\r\nexport const __options_footerAuthor = \"options_footerAuthor\";\r\nexport const __options_headers_itadPriceInfo = \"options_headers_itadPriceInfo\";\r\nexport const __ready_loading = \"ready_loading\";\r\nexport const __ready_ready = \"ready_ready\";\r\nexport const __ready_failed = \"ready_failed\";\r\nexport const __ready_serverOutage = \"ready_serverOutage\";\r\nexport const __twitch_nowStreaming = \"twitch_nowStreaming\";\r\nexport const __twitch_viewers = \"twitch_viewers\";\r\nexport const __dlcSelect_wishlistedDlc = \"dlcSelect_wishlistedDlc\";\r\nexport const __dlcSelect_none = \"dlcSelect_none\";\r\nexport const __dlcSelect_unownedDlc = \"dlcSelect_unownedDlc\";\r\nexport const __tag_wishlist = \"tag_wishlist\";\r\nexport const __tag_followed = \"tag_followed\";\r\nexport const __tag_coupon = \"tag_coupon\";\r\nexport const __tag_invGift = \"tag_invGift\";\r\nexport const __tag_invGuestpass = \"tag_invGuestpass\";\r\nexport const __tag_owned = \"tag_owned\";\r\nexport const __tag_notinterested = \"tag_notinterested\";\r\nexport const __tag_ignoredOwned = \"tag_ignoredOwned\";\r\nexport const __tag_collection = \"tag_collection\";\r\nexport const __tag_waitlist = \"tag_waitlist\";\r\nexport const __wallet_customAmount = \"wallet_customAmount\";\r\nexport const __wallet_customAmountText = \"wallet_customAmountText\";\r\nexport const __wallet_customGiftcard = \"wallet_customGiftcard\";\r\nexport const __wsgf_incomplete = \"wsgf_incomplete\";\r\nexport const __wsgf_unsupported = \"wsgf_unsupported\";\r\nexport const __wsgf_gold = \"wsgf_gold\";\r\nexport const __wsgf_silver = \"wsgf_silver\";\r\nexport const __wsgf_limited = \"wsgf_limited\";\r\nexport const __wsgf_certifications = \"wsgf_certifications\";\r\nexport const __itad_enableSyncLibrary = \"itad_enableSyncLibrary\";\r\nexport const __itad_enableSyncWishlist = \"itad_enableSyncWishlist\";\r\nexport const __itad_import = \"itad_import\";\r\nexport const __itad_lastImport = \"itad_lastImport\";\r\nexport const __itad_from = \"itad_from\";\r\nexport const __itad_to = \"itad_to\";\r\nexport const __itad_syncNow = \"itad_syncNow\";\r\nexport const __itad_info_itadSteam = \"itad_info_itadSteam\";\r\nexport const __itad_info_steamItad = \"itad_info_steamItad\";\r\nexport const __itad_syncEvents = \"itad_syncEvents\";\r\nexport const __tradeoffer_numItem = \"tradeoffer_numItem\";\r\nexport const __tradeoffer_numItems = \"tradeoffer_numItems\";\r\nexport const __tradeoffer_back = \"tradeoffer_back\";\r\nexport const __update_dontShow = \"update_dontShow\";\r\nexport const __update_updated = \"update_updated\";\r\nexport const __update_updatedNoVersion = \"update_updatedNoVersion\";\r\nexport const __update_changes = \"update_changes\";\r\nexport const __register_success = \"register_success\";\r\nexport const __register_owned = \"register_owned\";\r\nexport const __register_notavail = \"register_notavail\";\r\nexport const __register_invalid = \"register_invalid\";\r\nexport const __register_already = \"register_already\";\r\nexport const __register_dlc = \"register_dlc\";\r\nexport const __register_wallet = \"register_wallet\";\r\nexport const __register_toomany = \"register_toomany\";\r\nexport const __register_default = \"register_default\";\r\nexport const __wl_label = \"wl_label\";\r\nexport const __wl_totalPrice = \"wl_totalPrice\";\r\nexport const __wl_inWishlist = \"wl_inWishlist\";\r\nexport const __wl_onSale = \"wl_onSale\";\r\nexport const __wl_noPrice = \"wl_noPrice\";\r\nexport const __wl_hidden = \"wl_hidden\";\r\nexport const __wl_hiddenTooltip = \"wl_hiddenTooltip\";\r\nexport const __wl_removeTitle = \"wl_removeTitle\";\r\nexport const __wl_removeConfirm = \"wl_removeConfirm\";\r\nexport const __wl_removeConfirmWarn = \"wl_removeConfirmWarn\";\r\nexport const __coll_totalTime = \"coll_totalTime\";\r\nexport const __coll_inCollection = \"coll_inCollection\";\r\nexport const __coll_played = \"coll_played\";\r\nexport const __coll_neverPlayed = \"coll_neverPlayed\";\r\nexport const __userNote_add = \"userNote_add\";\r\nexport const __userNote_update = \"userNote_update\";\r\nexport const __userNote_addForGame = \"userNote_addForGame\";\r\nexport const __userNote_notEnoughSpace = \"userNote_notEnoughSpace\";\r\nexport const __userNote_notEnoughSpaceDesc = \"userNote_notEnoughSpaceDesc\";\r\nexport const __userNote_closeOnStorage = \"userNote_closeOnStorage\";\r\nexport const __userNote_closeOnStorageDesc = \"userNote_closeOnStorageDesc\";\r\nexport const __userNote_storageWarningDesc = \"userNote_storageWarningDesc\";\r\nexport const __userNote_saveSyncedStorage = \"userNote_saveSyncedStorage\";\r\nexport const __userNote_saveLocal = \"userNote_saveLocal\";\r\nexport const __userNote_syncOption = \"userNote_syncOption\";\r\nexport const __userNote_syncInfo_1 = \"userNote_syncInfo_1\";\r\nexport const __userNote_syncInfo_2 = \"userNote_syncInfo_2\";\r\nexport const __userNote_syncInfo_3 = \"userNote_syncInfo_3\";\r\nexport const __userNote_syncButtonPush = \"userNote_syncButtonPush\";\r\nexport const __userNote_syncButtonPull = \"userNote_syncButtonPull\";\r\nexport const __userNote_syncPulled = \"userNote_syncPulled\";\r\nexport const __userNote_syncPushed = \"userNote_syncPushed\";\r\nexport const __userNote_syncFailed = \"userNote_syncFailed\";\r\nexport const __userNote_syncError = \"userNote_syncError\";\r\nexport const __userNote_syncErrorEmpty = \"userNote_syncErrorEmpty\";\r\nexport const __userNote_syncErrorUnknown = \"userNote_syncErrorUnknown\";\r\nexport const __userNote_syncErrorLength = \"userNote_syncErrorLength\";\r\nexport const __queue_new = \"queue_new\";\r\nexport const __queue_newTooltip = \"queue_newTooltip\";\r\nexport const __workshop_workshop = \"workshop_workshop\";\r\nexport const __workshop_subscriptions = \"workshop_subscriptions\";\r\nexport const __workshop_subscribeAll = \"workshop_subscribeAll\";\r\nexport const __workshop_subscribeConfirm = \"workshop_subscribeConfirm\";\r\nexport const __workshop_subscribeLoading = \"workshop_subscribeLoading\";\r\nexport const __workshop_unsubscribeAll = \"workshop_unsubscribeAll\";\r\nexport const __workshop_unsubscribeConfirm = \"workshop_unsubscribeConfirm\";\r\nexport const __workshop_unsubscribeLoading = \"workshop_unsubscribeLoading\";\r\nexport const __workshop_finished = \"workshop_finished\";\r\nexport const __workshop_failed = \"workshop_failed\";\r\nexport const __workshop_collectionSortBy = \"workshop_collectionSortBy\";\r\nexport const __workshop_collectionSortSubscription = \"workshop_collectionSortSubscription\";\r\nexport const __workshop_collectionSortRating = \"workshop_collectionSortRating\";\r\nexport const __workshop_collectionSortTitle = \"workshop_collectionSortTitle\";\r\nexport const __workshop_collectionSortAuthor = \"workshop_collectionSortAuthor\";\r\nexport const __originalAuthors = \"originalAuthors\";\r\nexport const __acknowledgements = \"acknowledgements\";\r\nexport const __countries_ad = \"countries_ad\";\r\nexport const __countries_ae = \"countries_ae\";\r\nexport const __countries_af = \"countries_af\";\r\nexport const __countries_ag = \"countries_ag\";\r\nexport const __countries_ai = \"countries_ai\";\r\nexport const __countries_al = \"countries_al\";\r\nexport const __countries_am = \"countries_am\";\r\nexport const __countries_an = \"countries_an\";\r\nexport const __countries_ao = \"countries_ao\";\r\nexport const __countries_ar = \"countries_ar\";\r\nexport const __countries_as = \"countries_as\";\r\nexport const __countries_at = \"countries_at\";\r\nexport const __countries_au = \"countries_au\";\r\nexport const __countries_aw = \"countries_aw\";\r\nexport const __countries_az = \"countries_az\";\r\nexport const __countries_ba = \"countries_ba\";\r\nexport const __countries_bb = \"countries_bb\";\r\nexport const __countries_bd = \"countries_bd\";\r\nexport const __countries_be = \"countries_be\";\r\nexport const __countries_bf = \"countries_bf\";\r\nexport const __countries_bg = \"countries_bg\";\r\nexport const __countries_bh = \"countries_bh\";\r\nexport const __countries_bi = \"countries_bi\";\r\nexport const __countries_bj = \"countries_bj\";\r\nexport const __countries_bm = \"countries_bm\";\r\nexport const __countries_bn = \"countries_bn\";\r\nexport const __countries_bo = \"countries_bo\";\r\nexport const __countries_br = \"countries_br\";\r\nexport const __countries_bs = \"countries_bs\";\r\nexport const __countries_bt = \"countries_bt\";\r\nexport const __countries_bv = \"countries_bv\";\r\nexport const __countries_bw = \"countries_bw\";\r\nexport const __countries_by = \"countries_by\";\r\nexport const __countries_bz = \"countries_bz\";\r\nexport const __countries_ca = \"countries_ca\";\r\nexport const __countries_cd = \"countries_cd\";\r\nexport const __countries_cf = \"countries_cf\";\r\nexport const __countries_cg = \"countries_cg\";\r\nexport const __countries_ch = \"countries_ch\";\r\nexport const __countries_ci = \"countries_ci\";\r\nexport const __countries_ck = \"countries_ck\";\r\nexport const __countries_cl = \"countries_cl\";\r\nexport const __countries_cm = \"countries_cm\";\r\nexport const __countries_cn = \"countries_cn\";\r\nexport const __countries_co = \"countries_co\";\r\nexport const __countries_cr = \"countries_cr\";\r\nexport const __countries_cu = \"countries_cu\";\r\nexport const __countries_cv = \"countries_cv\";\r\nexport const __countries_cy = \"countries_cy\";\r\nexport const __countries_cz = \"countries_cz\";\r\nexport const __countries_de = \"countries_de\";\r\nexport const __countries_dj = \"countries_dj\";\r\nexport const __countries_dk = \"countries_dk\";\r\nexport const __countries_dm = \"countries_dm\";\r\nexport const __countries_do = \"countries_do\";\r\nexport const __countries_dz = \"countries_dz\";\r\nexport const __countries_ec = \"countries_ec\";\r\nexport const __countries_ee = \"countries_ee\";\r\nexport const __countries_eg = \"countries_eg\";\r\nexport const __countries_eh = \"countries_eh\";\r\nexport const __countries_er = \"countries_er\";\r\nexport const __countries_es = \"countries_es\";\r\nexport const __countries_et = \"countries_et\";\r\nexport const __countries_fi = \"countries_fi\";\r\nexport const __countries_fj = \"countries_fj\";\r\nexport const __countries_fk = \"countries_fk\";\r\nexport const __countries_fm = \"countries_fm\";\r\nexport const __countries_fo = \"countries_fo\";\r\nexport const __countries_fr = \"countries_fr\";\r\nexport const __countries_ga = \"countries_ga\";\r\nexport const __countries_gb = \"countries_gb\";\r\nexport const __countries_gd = \"countries_gd\";\r\nexport const __countries_ge = \"countries_ge\";\r\nexport const __countries_gf = \"countries_gf\";\r\nexport const __countries_gg = \"countries_gg\";\r\nexport const __countries_gh = \"countries_gh\";\r\nexport const __countries_gi = \"countries_gi\";\r\nexport const __countries_gl = \"countries_gl\";\r\nexport const __countries_gm = \"countries_gm\";\r\nexport const __countries_gn = \"countries_gn\";\r\nexport const __countries_gp = \"countries_gp\";\r\nexport const __countries_gq = \"countries_gq\";\r\nexport const __countries_gr = \"countries_gr\";\r\nexport const __countries_gs = \"countries_gs\";\r\nexport const __countries_gt = \"countries_gt\";\r\nexport const __countries_gu = \"countries_gu\";\r\nexport const __countries_gw = \"countries_gw\";\r\nexport const __countries_gy = \"countries_gy\";\r\nexport const __countries_hk = \"countries_hk\";\r\nexport const __countries_hm = \"countries_hm\";\r\nexport const __countries_hn = \"countries_hn\";\r\nexport const __countries_hr = \"countries_hr\";\r\nexport const __countries_ht = \"countries_ht\";\r\nexport const __countries_hu = \"countries_hu\";\r\nexport const __countries_id = \"countries_id\";\r\nexport const __countries_ie = \"countries_ie\";\r\nexport const __countries_il = \"countries_il\";\r\nexport const __countries_im = \"countries_im\";\r\nexport const __countries_in = \"countries_in\";\r\nexport const __countries_io = \"countries_io\";\r\nexport const __countries_iq = \"countries_iq\";\r\nexport const __countries_ir = \"countries_ir\";\r\nexport const __countries_is = \"countries_is\";\r\nexport const __countries_it = \"countries_it\";\r\nexport const __countries_je = \"countries_je\";\r\nexport const __countries_jm = \"countries_jm\";\r\nexport const __countries_jo = \"countries_jo\";\r\nexport const __countries_jp = \"countries_jp\";\r\nexport const __countries_ke = \"countries_ke\";\r\nexport const __countries_kg = \"countries_kg\";\r\nexport const __countries_kh = \"countries_kh\";\r\nexport const __countries_ki = \"countries_ki\";\r\nexport const __countries_km = \"countries_km\";\r\nexport const __countries_kn = \"countries_kn\";\r\nexport const __countries_kp = \"countries_kp\";\r\nexport const __countries_kr = \"countries_kr\";\r\nexport const __countries_kw = \"countries_kw\";\r\nexport const __countries_ky = \"countries_ky\";\r\nexport const __countries_kz = \"countries_kz\";\r\nexport const __countries_la = \"countries_la\";\r\nexport const __countries_lb = \"countries_lb\";\r\nexport const __countries_lc = \"countries_lc\";\r\nexport const __countries_li = \"countries_li\";\r\nexport const __countries_lk = \"countries_lk\";\r\nexport const __countries_lr = \"countries_lr\";\r\nexport const __countries_ls = \"countries_ls\";\r\nexport const __countries_lt = \"countries_lt\";\r\nexport const __countries_lu = \"countries_lu\";\r\nexport const __countries_lv = \"countries_lv\";\r\nexport const __countries_ly = \"countries_ly\";\r\nexport const __countries_ma = \"countries_ma\";\r\nexport const __countries_mc = \"countries_mc\";\r\nexport const __countries_md = \"countries_md\";\r\nexport const __countries_me = \"countries_me\";\r\nexport const __countries_mg = \"countries_mg\";\r\nexport const __countries_mh = \"countries_mh\";\r\nexport const __countries_mk = \"countries_mk\";\r\nexport const __countries_ml = \"countries_ml\";\r\nexport const __countries_mm = \"countries_mm\";\r\nexport const __countries_mn = \"countries_mn\";\r\nexport const __countries_mo = \"countries_mo\";\r\nexport const __countries_mp = \"countries_mp\";\r\nexport const __countries_mq = \"countries_mq\";\r\nexport const __countries_mr = \"countries_mr\";\r\nexport const __countries_ms = \"countries_ms\";\r\nexport const __countries_mt = \"countries_mt\";\r\nexport const __countries_mu = \"countries_mu\";\r\nexport const __countries_mv = \"countries_mv\";\r\nexport const __countries_mw = \"countries_mw\";\r\nexport const __countries_mx = \"countries_mx\";\r\nexport const __countries_my = \"countries_my\";\r\nexport const __countries_mz = \"countries_mz\";\r\nexport const __countries_na = \"countries_na\";\r\nexport const __countries_nc = \"countries_nc\";\r\nexport const __countries_ne = \"countries_ne\";\r\nexport const __countries_nf = \"countries_nf\";\r\nexport const __countries_ng = \"countries_ng\";\r\nexport const __countries_ni = \"countries_ni\";\r\nexport const __countries_nl = \"countries_nl\";\r\nexport const __countries_no = \"countries_no\";\r\nexport const __countries_np = \"countries_np\";\r\nexport const __countries_nr = \"countries_nr\";\r\nexport const __countries_nu = \"countries_nu\";\r\nexport const __countries_nz = \"countries_nz\";\r\nexport const __countries_om = \"countries_om\";\r\nexport const __countries_pa = \"countries_pa\";\r\nexport const __countries_pe = \"countries_pe\";\r\nexport const __countries_pf = \"countries_pf\";\r\nexport const __countries_pg = \"countries_pg\";\r\nexport const __countries_ph = \"countries_ph\";\r\nexport const __countries_pk = \"countries_pk\";\r\nexport const __countries_pl = \"countries_pl\";\r\nexport const __countries_pm = \"countries_pm\";\r\nexport const __countries_pn = \"countries_pn\";\r\nexport const __countries_pr = \"countries_pr\";\r\nexport const __countries_ps = \"countries_ps\";\r\nexport const __countries_pt = \"countries_pt\";\r\nexport const __countries_pw = \"countries_pw\";\r\nexport const __countries_py = \"countries_py\";\r\nexport const __countries_qa = \"countries_qa\";\r\nexport const __countries_re = \"countries_re\";\r\nexport const __countries_ro = \"countries_ro\";\r\nexport const __countries_rs = \"countries_rs\";\r\nexport const __countries_ru = \"countries_ru\";\r\nexport const __countries_rw = \"countries_rw\";\r\nexport const __countries_sa = \"countries_sa\";\r\nexport const __countries_sb = \"countries_sb\";\r\nexport const __countries_sc = \"countries_sc\";\r\nexport const __countries_sd = \"countries_sd\";\r\nexport const __countries_se = \"countries_se\";\r\nexport const __countries_sg = \"countries_sg\";\r\nexport const __countries_sh = \"countries_sh\";\r\nexport const __countries_si = \"countries_si\";\r\nexport const __countries_sk = \"countries_sk\";\r\nexport const __countries_sl = \"countries_sl\";\r\nexport const __countries_sm = \"countries_sm\";\r\nexport const __countries_sn = \"countries_sn\";\r\nexport const __countries_so = \"countries_so\";\r\nexport const __countries_sr = \"countries_sr\";\r\nexport const __countries_st = \"countries_st\";\r\nexport const __countries_sv = \"countries_sv\";\r\nexport const __countries_sy = \"countries_sy\";\r\nexport const __countries_sz = \"countries_sz\";\r\nexport const __countries_tc = \"countries_tc\";\r\nexport const __countries_td = \"countries_td\";\r\nexport const __countries_tf = \"countries_tf\";\r\nexport const __countries_tg = \"countries_tg\";\r\nexport const __countries_th = \"countries_th\";\r\nexport const __countries_tj = \"countries_tj\";\r\nexport const __countries_tk = \"countries_tk\";\r\nexport const __countries_tl = \"countries_tl\";\r\nexport const __countries_tm = \"countries_tm\";\r\nexport const __countries_tn = \"countries_tn\";\r\nexport const __countries_to = \"countries_to\";\r\nexport const __countries_tr = \"countries_tr\";\r\nexport const __countries_tt = \"countries_tt\";\r\nexport const __countries_tv = \"countries_tv\";\r\nexport const __countries_tw = \"countries_tw\";\r\nexport const __countries_tz = \"countries_tz\";\r\nexport const __countries_ua = \"countries_ua\";\r\nexport const __countries_ug = \"countries_ug\";\r\nexport const __countries_um = \"countries_um\";\r\nexport const __countries_us = \"countries_us\";\r\nexport const __countries_uy = \"countries_uy\";\r\nexport const __countries_uz = \"countries_uz\";\r\nexport const __countries_va = \"countries_va\";\r\nexport const __countries_vc = \"countries_vc\";\r\nexport const __countries_ve = \"countries_ve\";\r\nexport const __countries_vg = \"countries_vg\";\r\nexport const __countries_vi = \"countries_vi\";\r\nexport const __countries_vn = \"countries_vn\";\r\nexport const __countries_vu = \"countries_vu\";\r\nexport const __countries_wf = \"countries_wf\";\r\nexport const __countries_ws = \"countries_ws\";\r\nexport const __countries_ye = \"countries_ye\";\r\nexport const __countries_yt = \"countries_yt\";\r\nexport const __countries_za = \"countries_za\";\r\nexport const __countries_zm = \"countries_zm\";\r\nexport const __countries_zw = \"countries_zw\";\r\n", "import browser from \"webextension-polyfill\";\r\n\r\nexport default {\r\n    \"version\": browser.runtime.getManifest().version,\r\n    \"db_version\": 6,\r\n} as const;\r\n", "import browser, {type Storage as ns} from \"webextension-polyfill\";\r\nimport Storage, {type StorageSchema} from \"./Storage\";\r\n\r\n// FIXME exports are confusing, figure out better export scheme\r\n\r\n/**\r\n * NOTE: Settings are stored in synced storage, but are omitted from default schema,\r\n * because they should not be accessed directly from storage\r\n */\r\ninterface SyncedStorageSchema extends StorageSchema {\r\n    user_notes: Record<string, string>,\r\n    fav_emoticons: string[],\r\n    sortfriendsby: string,\r\n    sortgroupsby: string,\r\n    sortmylistingsby: string,\r\n    sortreviewsby: string,\r\n    homepage_tab_last: string;\r\n}\r\n\r\n/*\r\n * browser.storage.sync limits\r\n * QUOTA_BYTES = 102400 // 100KB\r\n * QUOTA_BYTES_PER_ITEM = 8192 // 8KB\r\n * MAX_ITEMS = 512\r\n * MAX_WRITE_OPERATIONS_PER_HOUR = 1800\r\n * MAX_WRITE_OPERATIONS_PER_MINUTE = 120\r\n */\r\nexport class SyncedStorage<Schema extends StorageSchema> extends Storage<ns.SyncStorageAreaSync, Schema> {\r\n\r\n    constructor() {\r\n        super(browser.storage.sync);\r\n    }\r\n\r\n    get QUOTA_BYTES_PER_ITEM(): number {\r\n        // see https://github.com/DefinitelyTyped/DefinitelyTyped/discussions/66696\r\n        return browser.storage.sync.QUOTA_BYTES_PER_ITEM ?? 8192;\r\n    }\r\n}\r\n\r\nexport default new SyncedStorage<SyncedStorageSchema>();\r\n", "import {type Storage as ns} from \"webextension-polyfill\";\r\n\r\n/*\r\n * Type declarations stolen from idb, because I was too dumb to figure them out on my own\r\n * */\r\ndeclare type KeyToKeyNoIndex<T> = {\r\n    [K in keyof T]: string extends K ? never : number extends K ? never : K;\r\n};\r\nexport declare type ValuesOf<T> = T extends {\r\n    [K in keyof T]: infer U;\r\n} ? U : never;\r\ndeclare type KnownKeys<T> = ValuesOf<KeyToKeyNoIndex<T>>;\r\n\r\nexport declare type StorageSchema = Record<string, any>;\r\nexport declare type SchemaKeys<Schema extends StorageSchema | unknown> = Schema extends StorageSchema ? (KnownKeys<Schema> & string) : string;\r\nexport declare type SchemaValue<Schema extends StorageSchema | unknown, Key extends SchemaKeys<Schema>> = Schema extends StorageSchema ? Schema[Key] : any;\r\n\r\nexport interface StorageInterface<Schema extends StorageSchema> {\r\n    get<K extends SchemaKeys<Schema>>(key: K): Promise<SchemaValue<Schema, K>|undefined>;\r\n    getObject<T extends Partial<Schema>>(object: T): Promise<T>;\r\n\r\n    set<K extends SchemaKeys<Schema>>(key: K, value: SchemaValue<Schema, K>): Promise<void>;\r\n    setObject(object: Partial<Schema>): Promise<void>;\r\n\r\n    remove<K extends SchemaKeys<Schema>>(...keys: K[]): Promise<void>;\r\n}\r\n\r\nexport default class Storage<\r\n    Area extends ns.SyncStorageAreaSync|ns.LocalStorageArea,\r\n    Schema extends StorageSchema\r\n> implements StorageInterface<Schema> {\r\n\r\n    private storageArea: Area;\r\n\r\n    constructor(storageArea: Area) {\r\n        this.storageArea = storageArea;\r\n    }\r\n\r\n    get onChanged() {\r\n        return this.storageArea.onChanged;\r\n    }\r\n\r\n    async get<K extends SchemaKeys<Schema>>(key: K): Promise<SchemaValue<Schema, K> | undefined> {\r\n        let response = await this.storageArea.get(key);\r\n        return response[key] ?? undefined;\r\n    }\r\n\r\n    getObject<T extends Partial<Schema>>(object: T): Promise<T> {\r\n        return this.storageArea.get(object) as Promise<T>;\r\n    }\r\n\r\n    set<K extends SchemaKeys<Schema>>(key: K, value: SchemaValue<Schema, K>): Promise<void> {\r\n        return this.storageArea.set({[key]: value});\r\n    }\r\n\r\n    setObject(object: Partial<Schema>): Promise<void> {\r\n        return this.storageArea.set(object);\r\n    }\r\n\r\n    remove<K extends SchemaKeys<Schema>>(...keys: K[]): Promise<void> {\r\n        return this.storageArea.remove(keys);\r\n    }\r\n}\r\n", "import Info from \"@Core/Info\";\r\nimport type {SettingsSchema} from \"./_types\";\r\nimport type {SchemaKeys, SchemaValue, StorageInterface} from \"@Core/Storage/Storage\";\r\nimport {SyncedStorage} from \"@Core/Storage/SyncedStorage\";\r\n\r\nexport const DefaultSettings: Readonly<SettingsSchema> = {\r\n    language: \"english\",\r\n\r\n    version: Info.version,\r\n    version_show: true,\r\n\r\n    highlight_owned_color: \"#00ce67\",\r\n    highlight_wishlist_color: \"#0491bf\",\r\n    highlight_followed_color: \"#d64550\",\r\n    highlight_coupon_color: \"#a26426\",\r\n    highlight_inv_gift_color: \"#800040\",\r\n    highlight_inv_guestpass_color: \"#513c73\",\r\n    highlight_notinterested_color: \"#4f4f4f\",\r\n    highlight_ignored_owned_color: \"#4f4f4f\",\r\n    highlight_collection_color: \"#856d0e\",\r\n    highlight_waitlist_color: \"#4c7521\",\r\n\r\n    tag_owned_color: \"#00b75b\",\r\n    tag_wishlist_color: \"#0383b4\",\r\n    tag_followed_color: \"#d64550\",\r\n    tag_coupon_color: \"#c27120\",\r\n    tag_inv_gift_color: \"#b10059\",\r\n    tag_inv_guestpass_color: \"#65449a\",\r\n    tag_notinterested_color: \"#4f4f4f\",\r\n    tag_ignored_owned_color: \"#4f4f4f\",\r\n    tag_collection_color: \"#856d0e\",\r\n    tag_waitlist_color: \"#4c7521\",\r\n\r\n    highlight_owned: true,\r\n    highlight_wishlist: true,\r\n    highlight_followed: true,\r\n    highlight_coupon: false,\r\n    highlight_inv_gift: false,\r\n    highlight_inv_guestpass: false,\r\n    highlight_notinterested: false,\r\n    highlight_ignored_owned: false,\r\n    highlight_excludef2p: false,\r\n    highlight_collection: true,\r\n    highlight_waitlist: true,\r\n\r\n    tag_owned: false,\r\n    tag_wishlist: false,\r\n    tag_followed: false,\r\n    tag_coupon: false,\r\n    tag_inv_gift: false,\r\n    tag_inv_guestpass: false,\r\n    tag_notinterested: true,\r\n    tag_ignored_owned: true,\r\n    tag_collection: false,\r\n    tag_waitlist: false,\r\n    tag_short: false,\r\n\r\n    hidetmsymbols: false,\r\n\r\n    showlowestprice: true,\r\n    showlowestprice_onwishlist: true,\r\n    showlowestpricecoupon: true,\r\n    showallstores: true,\r\n    excluded_stores: [],\r\n    override_price: \"auto\",\r\n    showregionalprice: \"mouse\",\r\n    regional_countries: [\"us\", \"gb\", \"fr\", \"br\", \"au\", \"jp\"],\r\n\r\n    show_es_homepagetabs: true,\r\n    showmarkettotal: false,\r\n    showmcus: true,\r\n    showoc: true,\r\n    showhltb: true,\r\n    showyoutube: true,\r\n    showtwitch: true,\r\n    showpcgw: true,\r\n    showcompletionistme: false,\r\n    showprotondb: false,\r\n    showviewinlibrary: false,\r\n    showsteamcardexchange: false,\r\n    showitadlinks: true,\r\n    showsteamdb: true,\r\n    showbartervg: false,\r\n    showyoutubegameplay: true,\r\n    showyoutubereviews: true,\r\n    showwsgf: true,\r\n    exfgls: true,\r\n    app_custom_link: [\r\n        {\r\n            enabled: true,\r\n            name: \"Google\",\r\n            url: \"https://www.google.com/search?q=[ID]+[NAME]\",\r\n            icon: \"https://www.google.com/images/branding/product/ico/googleg_lodp.ico\"\r\n        },\r\n    ],\r\n\r\n    customize_apppage: {},\r\n    customize_frontpage: {},\r\n\r\n    show_package_info: false,\r\n    show_players_info: true,\r\n    show_early_access: true,\r\n    show_alternative_linux_icon: false,\r\n    show_itad_button: false,\r\n    skip_got_steam: false,\r\n\r\n    installsteam: \"show\",\r\n    openinnewtab: false,\r\n    keepssachecked: false,\r\n    showemptywishlist: true,\r\n    user_notes_app: true,\r\n    user_notes_wishlist: true,\r\n    user_notes_simple: true,\r\n    showwishliststats: true,\r\n    oneclickremovewl: false,\r\n    user_notes_adapter: \"synced_storage\",\r\n    showlanguagewarning: true,\r\n    showlanguagewarninglanguage: \"english\",\r\n    homepage_tab_selection: \"remember\",\r\n    send_age_info: true,\r\n    removebroadcasts: false,\r\n    prevent_video_pause: false,\r\n    tabtitle_appname_first: false,\r\n    horizontalscrolling: true,\r\n    showsupportinfo: true,\r\n    showdrm: true,\r\n    regional_hideworld: false,\r\n    showinvnav: true,\r\n    quickinv: true,\r\n    quickinv_diff: -0.01,\r\n    community_default_tab: \"\",\r\n    showallstats: true,\r\n    replacecommunityhublinks: false,\r\n    hideannouncementcomments: false,\r\n    showachinstore: true,\r\n    hideactivelistings: false,\r\n    showlowestmarketprice: true,\r\n    hidespamcomments: false,\r\n    spamcommentregex: \"[\\\\u2500-\\\\u25FF]\",\r\n    wlbuttoncommunityapp: true,\r\n    removeguideslanguagefilter: false,\r\n    confirmdeletecomment: true,\r\n    disablelinkfilter: false,\r\n    show1clickgoo: true,\r\n    show_profile_link_images: \"gray\",\r\n    show_custom_themes: true,\r\n    profile_pinned_bg: false,\r\n    friends_append_nickname: false,\r\n    profile_steamrepcn: true,\r\n    profile_steamgifts: true,\r\n    profile_steamtrades: true,\r\n    profile_bartervg: true,\r\n    profile_steamdbcalc: true,\r\n    profile_backpacktf: true,\r\n    profile_steamid: true,\r\n    profile_custom_link: [\r\n        {\r\n            enabled: true,\r\n            name: \"Google\",\r\n            url: \"https://www.google.com/search?q=[ID]\",\r\n            icon: \"https://www.google.com/images/branding/product/ico/googleg_lodp.ico\"\r\n        },\r\n    ],\r\n    group_steamgifts: true,\r\n    steamcardexchange: true,\r\n    purchase_dates: true,\r\n    show_badge_progress: true,\r\n    show_coupon: true,\r\n    show_wishlist_link: true,\r\n    show_wishlist_count: true,\r\n    show_progressbar: true,\r\n    show_backtotop: false,\r\n\r\n    profile_showcase_twitch: true,\r\n    profile_showcase_own_twitch: false,\r\n    profile_showcase_twitch_profileonly: false,\r\n\r\n    itad_sync_library: true,\r\n    itad_sync_wishlist: true,\r\n    add_to_waitlist: false,\r\n    collection_banner_notowned: false,\r\n    itad_sync_notes: false,\r\n\r\n    context_steam_store: false,\r\n    context_steam_lucky: false,\r\n    context_steam_market: false,\r\n    context_itad: false,\r\n    context_bartervg: false,\r\n    context_steamdb: false,\r\n    context_steamdb_instant: false,\r\n    context_steam_keys: false,\r\n};\r\n\r\n\r\ntype TListener = () => void;\r\n\r\nclass Event {\r\n    private listeners: Set<TListener> = new Set();\r\n\r\n    addListener(listener: TListener): void {\r\n        this.listeners.add(listener);\r\n    }\r\n\r\n    removeListener(listener: TListener): void {\r\n        this.listeners.delete(listener);\r\n    }\r\n\r\n    invoke(): void {\r\n        for (const listener of this.listeners) {\r\n            listener();\r\n        }\r\n    }\r\n}\r\n\r\nexport class SettingsStore {\r\n\r\n    private static promise: Promise<void>;\r\n\r\n    private static data: SettingsSchema;\r\n    private static storage: StorageInterface<SettingsSchema> = new SyncedStorage<SettingsSchema>();\r\n\r\n    public static readonly onSaveStart: Event = new Event();\r\n    public static readonly onSaveEnd: Event = new Event();\r\n\r\n    public static async load(): Promise<void> {\r\n        this.data = await this.storage.getObject(DefaultSettings);\r\n    }\r\n\r\n    static init(): Promise<void> {\r\n        if (!this.promise) {\r\n            this.promise = this.load();\r\n        }\r\n        return this.promise;\r\n    }\r\n\r\n    static getDefault<K extends keyof SettingsSchema>(key: K): SettingsSchema[K] {\r\n        return DefaultSettings[key];\r\n    }\r\n\r\n    static get<K extends keyof SettingsSchema>(key: K): SettingsSchema[K] {\r\n        if (!this.data) {\r\n            throw new Error(\"Settings have not been loaded\");\r\n        }\r\n\r\n        return this.data[key];\r\n    }\r\n\r\n    static async set<K extends SchemaKeys<SettingsSchema>>(key: K, value: SchemaValue<SettingsSchema, K>): Promise<void> {\r\n        this.onSaveStart.invoke();\r\n\r\n        this.data[key] = value;\r\n        await this.storage.set(key, value);\r\n\r\n        this.onSaveEnd.invoke();\r\n    }\r\n\r\n    static remove<K extends SchemaKeys<SettingsSchema>>(key: K): void {\r\n        this.storage.remove(key);\r\n        this.data[key] = structuredClone(DefaultSettings[key]);\r\n    }\r\n\r\n    static clear(): void {\r\n        this.storage.remove(...(Object.keys(this.data) as SchemaKeys<SettingsSchema>[]));\r\n        this.data = structuredClone(DefaultSettings);\r\n    }\r\n\r\n    static async import(data: Partial<SettingsSchema>): Promise<void> {\r\n        // TODO check data for valid keys and values\r\n        await this.storage.setObject(data);\r\n        await this.load();\r\n    }\r\n\r\n    static asObject(): SettingsSchema {\r\n        return structuredClone(this.data);\r\n    }\r\n}\r\n\r\nexport default (new Proxy(SettingsStore, {\r\n    get<K extends SchemaKeys<SettingsSchema>>(target: typeof SettingsStore, prop: K): SchemaValue<SettingsSchema, K> {\r\n        return target.get(prop);\r\n    },\r\n\r\n    set<K extends SchemaKeys<SettingsSchema>>(target: typeof SettingsStore, prop: K, value: SchemaValue<SettingsSchema, K>): boolean {\r\n        target.set(prop, value);\r\n        return true;\r\n    }\r\n})) as unknown as SettingsSchema;\r\n\r\n\r\n/*\r\n FIXME not settings, more like cached values\r\n\"user_notes\": {},\r\n\"homepage_tab_last\": null,\r\n\"sortfriendsby\": \"default_ASC\",\r\n\"sortreviewsby\": \"default_ASC\",\r\n\"sortgroupsby\": \"default_ASC\",\r\n\"sortmylistingsby\": \"default_ASC\",\r\n\"fav_emoticons\": [],\r\n\r\n\r\nconst PERSISTENT: (keyof typeof DEFAULTS)[] = [\r\n    \"user_notes\",\r\n    \"user_notes_adapter\",\r\n];\r\n*/\r\n", "import browser from \"webextension-polyfill\";\r\n\r\nexport default class ExtensionResources {\r\n\r\n    static getURL(pathname: string) {\r\n        return browser.runtime.getURL(pathname);\r\n    }\r\n\r\n    static get(pathname: string): Promise<Response> {\r\n        return fetch(ExtensionResources.getURL(pathname));\r\n    }\r\n\r\n    static async getJSON<T>(pathname: string): Promise<T> {\r\n        let response = await ExtensionResources.get(pathname);\r\n        return await response.json();\r\n    }\r\n\r\n    static async getText(pathname: string): Promise<string> {\r\n        let response = await ExtensionResources.get(pathname);\r\n        return await response.text();\r\n    }\r\n}\r\n", "\r\nexport default class Language {\r\n\r\n    public static readonly map: Record<string, string> ={\r\n        \"english\": \"en\",\r\n        \"bulgarian\": \"bg\",\r\n        \"czech\": \"cs\",\r\n        \"danish\": \"da\",\r\n        \"dutch\": \"nl\",\r\n        \"finnish\": \"fi\",\r\n        \"french\": \"fr\",\r\n        \"greek\": \"el\",\r\n        \"german\": \"de\",\r\n        \"hungarian\": \"hu\",\r\n        \"italian\": \"it\",\r\n        \"japanese\": \"ja\",\r\n        \"koreana\": \"ko\",\r\n        \"norwegian\": \"no\",\r\n        \"polish\": \"pl\",\r\n        \"portuguese\": \"pt-PT\",\r\n        \"brazilian\": \"pt-BR\",\r\n        \"russian\": \"ru\",\r\n        \"romanian\": \"ro\",\r\n        \"schinese\": \"zh-CN\",\r\n        \"spanish\": \"es-ES\",\r\n        \"latam\": \"es-419\",\r\n        \"swedish\": \"sv-SE\",\r\n        \"tchinese\": \"zh-TW\",\r\n        \"thai\": \"th\",\r\n        \"turkish\": \"tr\",\r\n        \"ukrainian\": \"ua\",\r\n        \"vietnamese\": \"vi\",\r\n    };\r\n\r\n    private readonly _name: string;\r\n    private readonly _code: string|null;\r\n\r\n    constructor(language: string) {\r\n        this._name = language;\r\n        this._code = Language.map[language] ?? null;\r\n        // TODO should we throw when there is unsupported language?\r\n    }\r\n\r\n    get name(): string {\r\n        return this._name;\r\n    }\r\n\r\n    get code(): string|null {\r\n        return this._code;\r\n    }\r\n\r\n    isOneOf(...languages: string[]) {\r\n        return languages.includes(this._name);\r\n    }\r\n}\r\n\r\n", "import browser from \"webextension-polyfill\";\r\nimport ErrorParser from \"@Core/Errors/ErrorParser\";\r\n\r\nexport default class Background {\r\n\r\n    static async send<Response>(action: string, params: Record<string, any>={}): Promise<Response> {\r\n        document.dispatchEvent(new CustomEvent(\"asRequestStart\"));\r\n        try {\r\n            const result = await browser.runtime.sendMessage({action, params});\r\n            document.dispatchEvent(new CustomEvent(\"asRequestDone\"));\r\n            return result;\r\n        } catch(e: any) {\r\n            const error = ErrorParser.parse(e.message ?? \"\");\r\n            document.dispatchEvent(new CustomEvent(\"asRequestError\", {detail: error}));\r\n            throw e;\r\n        }\r\n    }\r\n}\r\n", "\r\n/**\r\n * Convenience class for passing errors between contexts.\r\n * Errors thrown in the context of a message callback on the background page are\r\n * {@link https://github.com/mozilla/webextension-polyfill/blob/87bdfa844da054d189ac28423cf01b64ebfe1e5b/src/browser-polyfill.js#L418\r\n *  cut down to only send the message of the error},\r\n * losing information about the type.\r\n */\r\nexport default class ErrorParser {\r\n\r\n    /**\r\n     * Takes an Error string and parses it by splitting it into name and message\r\n     * @param {String} errStr a string created by Error.prototype.toString\r\n     * @returns {{name: String, msg: String}} an object containing information about the error name and its message\r\n     */\r\n    static parse(errStr: string): {name: string|null, message: string|null} {\r\n        const info = errStr.match(/(.*):\\s(.+)/);\r\n        return info\r\n            ? {name: info[1] ?? \"\", message: info[2] ?? \"\"}\r\n            : {name: null, message: null}\r\n    }\r\n}\r\n", "import Background from \"@Core/Background\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport type {TAppDetail, TDynamicStoreStatusResponse} from \"@Background/Modules/Store/_types\";\r\n\r\nexport default class SteamStoreApiFacade {\r\n\r\n    static wishlistAdd(appid: number): Promise<void> {\r\n        return Background.send(EAction.Wishlist_Add, {appid});\r\n    }\r\n\r\n    static wishlistRemove(appid: number): Promise<void> {\r\n        return Background.send(EAction.Wishlist_Remove, {appid});\r\n    }\r\n\r\n    static fetchAppDetails(appid: number, filter: string|undefined=undefined): Promise<TAppDetail|null> {\r\n        return Background.send(EAction.AppDetails, {appid, filter});\r\n    }\r\n\r\n    static getPurchaseDate(appName: string, lang: string): Promise<string|null> {\r\n        return Background.send(EAction.Purchases, {appName, lang});\r\n    }\r\n\r\n    static getCurrency(): Promise<string> {\r\n        return Background.send(EAction.Currency);\r\n    }\r\n\r\n    static clearPurchases(): Promise<void> {\r\n        return Background.send(EAction.Purchases_Clear);\r\n    }\r\n\r\n    static clearDynamicStore(): Promise<void> {\r\n        return Background.send(EAction.DynamicStore_Clear);\r\n    }\r\n\r\n    static getDynamicStoreStatus(ids: string[]): Promise<TDynamicStoreStatusResponse> {\r\n        return Background.send(EAction.DynamicStore_Status, {ids});\r\n    }\r\n\r\n    static getDynamicStoreRandomApp(): Promise<number|null> {\r\n        return Background.send(EAction.DynamicStore_RandomApp);\r\n    }\r\n}\r\n", "import Settings from \"@Options/Data/Settings\";\r\nimport ExtensionResources from \"@Core/ExtensionResources\";\r\nimport Language from \"@Core/Localization/Language\";\r\nimport SteamStoreApiFacade from \"@Content/Modules/Facades/SteamStoreApiFacade\";\r\n\r\nexport interface TLocale {\r\n    stats: {\r\n        strings: number,\r\n        translated: number,\r\n    },\r\n    strings: Record<string, string>\r\n}\r\n\r\nexport default class Localization {\r\n\r\n    public static locale: TLocale;\r\n\r\n    static load(code: string): Promise<TLocale> {\r\n        return ExtensionResources.getJSON(`/localization/compiled/${code}.json`);\r\n    }\r\n\r\n    static async init(current: Language|null): Promise<void> {\r\n        const stored: string = Settings.language;\r\n        if (current === null) {\r\n            current = new Language(stored);\r\n        } else if (current.name !== stored) {\r\n            Settings.language = current.name;\r\n            SteamStoreApiFacade.clearPurchases(); // TODO this is a nasty side effect, get rid of it\r\n        }\r\n\r\n        const lang = current.code ?? \"en\";\r\n\r\n        try {\r\n            this.locale = await this.load(lang);\r\n        } catch(e) {\r\n            console.error(`Failed to load ${lang}`);\r\n            this.locale = await this.load(\"en\");\r\n        }\r\n    }\r\n}\r\n\r\nexport function L(key: string, replacements: Record<string, string|number>|null = null): string {\r\n    let text = Localization.locale.strings[key] ?? \"<<missing text>>\";\r\n    if (replacements !== null) {\r\n        for (let [key, value] of Object.entries(replacements)) {\r\n            text = text.replaceAll(`__${key}__`, String(value));\r\n        }\r\n    }\r\n    return text;\r\n}\r\n", "import {\r\n    __options_contextBartervg,\r\n    __options_contextItad,\r\n    __options_contextSteamdb,\r\n    __options_contextSteamdbInstant,\r\n    __options_contextSteamKeys, __options_contextSteamLucky,\r\n    __options_contextSteamMarket,\r\n    __options_contextSteamStore,\r\n} from \"@Strings/_strings\";\r\nimport Localization, {L} from \"@Core/Localization/Localization\";\r\nimport Settings, {SettingsStore} from \"@Options/Data/Settings\";\r\nimport browser, {type Menus} from \"webextension-polyfill\";\r\nimport type {SettingsSchema} from \"@Options/Data/_types\";\r\n\r\nexport type ContextMenuKeys = keyof SettingsSchema & (\r\n      \"context_steam_store\"\r\n    | \"context_steam_lucky\"\r\n    | \"context_steam_market\"\r\n    | \"context_itad\"\r\n    | \"context_bartervg\"\r\n    | \"context_steamdb\"\r\n    | \"context_steamdb_instant\"\r\n    | \"context_steam_keys\"\r\n);\r\n\r\nexport default class ContextMenu {\r\n\r\n    private static readonly queryLinks: Record<ContextMenuKeys, [string, string, () => boolean]> = {\r\n        \"context_steam_store\": [\r\n            __options_contextSteamStore, \"https://store.steampowered.com/search/?term=__query__\",\r\n            () => Settings.context_steam_store,\r\n        ],\r\n        \"context_steam_lucky\": [\r\n            __options_contextSteamLucky, \"https://store.steampowered.com/search/?term=__query__&ifeellucky\",\r\n            () => Settings.context_steam_lucky,\r\n        ],\r\n        \"context_steam_market\": [\r\n            __options_contextSteamMarket, \"https://steamcommunity.com/market/search?q=__query__\",\r\n            () => Settings.context_steam_market\r\n        ],\r\n        \"context_itad\": [\r\n            __options_contextItad, \"https://isthereanydeal.com/search/?q=__query__\",\r\n            () => Settings.context_itad\r\n        ],\r\n        \"context_bartervg\": [\r\n            __options_contextBartervg, \"https://barter.vg/search?q=__query__\",\r\n            () => Settings.context_bartervg\r\n        ],\r\n        \"context_steamdb\": [\r\n            __options_contextSteamdb, \"https://steamdb.info/search/?q=__query__\",\r\n            () => Settings.context_steamdb\r\n        ],\r\n        \"context_steamdb_instant\": [\r\n            __options_contextSteamdbInstant, \"https://steamdb.info/instantsearch/?query=__query__\",\r\n            () => Settings.context_steamdb_instant\r\n        ],\r\n        \"context_steam_keys\": [\r\n            __options_contextSteamKeys, \"https://store.steampowered.com/account/registerkey?key=__query__\",\r\n            () => Settings.context_steam_keys\r\n        ]\r\n    };\r\n\r\n    static register(): void {\r\n        browser.runtime.onStartup.addListener(ContextMenu.build);\r\n        browser.runtime.onInstalled.addListener(ContextMenu.build);\r\n\r\n        if (!browser.contextMenus.onClicked.hasListener(ContextMenu.onClick)) {\r\n            browser.contextMenus.onClicked.addListener(ContextMenu.onClick);\r\n        }\r\n    }\r\n\r\n    private static onClick(info: Menus.OnClickData): void {\r\n\r\n        const menuItem = ContextMenu.queryLinks[info.menuItemId as ContextMenuKeys];\r\n        if (!menuItem) {\r\n            return;\r\n        }\r\n\r\n        const url: string = menuItem[1];\r\n        let query = info.selectionText!.trim();\r\n\r\n        if (info.menuItemId === \"context_steam_keys\") {\r\n            const steamKeys = query.match(/[A-Z0-9]{5}(-[A-Z0-9]{5}){2}/g);\r\n\r\n            // Set the query to matched keys if any, otherwise display the selected text anyway\r\n            if (Array.isArray(steamKeys)) {\r\n                query = steamKeys.join(\",\");\r\n            }\r\n        }\r\n\r\n        browser.tabs.create({\r\n            url: url.replace(\"__query__\", encodeURIComponent(query))\r\n        });\r\n    }\r\n\r\n    static async build(): Promise<void> {\r\n        await SettingsStore.init();\r\n        await Localization.init(null);\r\n\r\n        for (const [id, menuItem] of Object.entries(ContextMenu.queryLinks)) {\r\n            const [locale, query_, enabled] = menuItem;\r\n\r\n            browser.contextMenus.create({\r\n                id,\r\n                title: L(locale, {\"query\": \"%s\"}),\r\n                contexts: [\"selection\"],\r\n                visible: enabled()\r\n            },\r\n\r\n            () => browser.runtime.lastError);\r\n        }\r\n    }\r\n\r\n    public static update(id: ContextMenuKeys): void {\r\n        const menuItem = this.queryLinks[id];\r\n        if (!menuItem) {\r\n            return;\r\n        }\r\n        const [locale, query_, enabled] = menuItem;\r\n\r\n        browser.contextMenus.update(id, {\r\n            title: L(locale, {\"query\": \"%s\"}),\r\n            contexts: [\"selection\"],\r\n            visible: enabled()\r\n        });\r\n    }\r\n}\r\n", "const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n", "import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n", "import type {IDBPDatabase, IDBPTransaction, StoreNames} from \"idb\";\r\nimport type ADB6 from \"@Background/Db/Schemas/ADB6\";\r\nimport type {ADB5} from \"@Background/Db/Schemas/ADB5\";\r\n\r\ntype Schema = ADB6;\r\n\r\nasync function upgrade(\r\n    db: IDBPDatabase<Schema>,\r\n    oldVersion: number,\r\n    newVersion: number,\r\n    tx: IDBPTransaction<Schema, StoreNames<Schema>[], \"versionchange\">\r\n): Promise<void> {\r\n\r\n    if (oldVersion == 0) {\r\n        db.createObjectStore(\"items\");\r\n        db.createObjectStore(\"earlyAccessAppids\");\r\n        db.createObjectStore(\"collection\");\r\n        db.createObjectStore(\"waitlist\");\r\n        db.createObjectStore(\"itadImport\");\r\n        db.createObjectStore(\"purchases\");\r\n        db.createObjectStore(\"notes\");\r\n    }\r\n\r\n    if (oldVersion < 5) {\r\n        if (oldVersion >= 1) {\r\n            db.deleteObjectStore(\"storePageData\");\r\n            db.deleteObjectStore(\"profiles\");\r\n            db.deleteObjectStore(\"rates\");\r\n            db.deleteObjectStore(\"coupons\");\r\n            db.deleteObjectStore(\"giftsAndPasses\");\r\n            db.deleteObjectStore(\"dynamicStore\");\r\n            db.deleteObjectStore(\"packages\");\r\n        }\r\n\r\n        if (oldVersion >= 2) {\r\n            db.deleteObjectStore(\"workshopFileSizes\");\r\n            db.deleteObjectStore(\"reviews\");\r\n        }\r\n\r\n        if (oldVersion >= 3) {\r\n            db.deleteObjectStore(\"expiries\");\r\n        }\r\n\r\n        if (oldVersion >= 4) {\r\n            db.deleteObjectStore(\"storeList\");\r\n        }\r\n\r\n        db.createObjectStore(\"storePageData\")\r\n            .createIndex(\"idx_expiry\", \"expiry\");\r\n\r\n        db.createObjectStore(\"profiles\")\r\n            .createIndex(\"idx_expiry\", \"expiry\");\r\n\r\n        db.createObjectStore(\"rates\")\r\n            .createIndex(\"idx_expiry\", \"expiry\");\r\n\r\n        db.createObjectStore(\"coupons\")\r\n            .createIndex(\"idx_appid\", \"appids\", {unique: false, multiEntry: true});\r\n\r\n        db.createObjectStore(\"giftsAndPasses\")\r\n            .createIndex(\"idx_appid\", \"\", {unique: false, multiEntry: true});\r\n\r\n        db.createObjectStore(\"dynamicStore\")\r\n            .createIndex(\"idx_appid\", \"\", {unique: false, multiEntry: true});\r\n\r\n        db.createObjectStore(\"packages\")\r\n            .createIndex(\"idx_expiry\", \"expiry\");\r\n\r\n        db.createObjectStore(\"workshopFileSizes\")\r\n            .createIndex(\"idx_expiry\", \"expiry\");\r\n\r\n        db.createObjectStore(\"reviews\")\r\n            .createIndex(\"idx_expiry\", \"expiry\");\r\n\r\n        db.createObjectStore(\"expiries\")\r\n            .createIndex(\"idx_expiry\", \"\");\r\n\r\n        db.createObjectStore(\"storeList\");\r\n    }\r\n\r\n    if (oldVersion < 6) {\r\n        const collectionKeys = await (tx as unknown as IDBPTransaction<ADB5>)\r\n            .objectStore(\"collection\")\r\n            .getAllKeys();\r\n\r\n        const collection = tx.objectStore(\"collection\");\r\n        for (const key of collectionKeys) {\r\n            collection.put([], key);\r\n        }\r\n    }\r\n\r\n    console.log(`DB migrated, ${oldVersion} -> ${newVersion}`);\r\n}\r\n\r\nexport default {upgrade};\r\n", "import browser, {type Storage as ns} from \"webextension-polyfill\";\r\nimport Storage, {type StorageSchema} from \"./Storage\";\r\nimport type {TLogin} from \"@Background/Modules/Community/_types\";\r\n\r\n// FIXME exports are confusing, figure out better export scheme\r\n\r\ninterface CacheEntry<V = unknown> {\r\n    data: V,\r\n    expiry: number\r\n}\r\n\r\nexport interface LocalStorageSchema extends StorageSchema {\r\n    login: TLogin,\r\n    storeCountry: string,\r\n    currency: CacheEntry<string>,\r\n    access_token: {\r\n        token: string,\r\n        expiry: number\r\n    },\r\n    lastItadImport: {\r\n        from: null|number,\r\n        to: null|number\r\n    },\r\n    syncEvents: Array<{\r\n        section: string,\r\n        type: \"push\"|\"pull\",\r\n        timestamp: number,\r\n        count: number\r\n    }>,\r\n    db_cleanup: number,\r\n    show_review_section: boolean,\r\n    hide_login_warn_store: boolean,\r\n    hide_login_warn_community: boolean,\r\n    guide_tags: string[],\r\n    market_stats2: {\r\n        eventId: string,\r\n        events: number,\r\n        buyTotal: number,\r\n        sellTotal: number,\r\n    },\r\n    popular_refresh: boolean,\r\n    expand_slider: boolean,\r\n    workshop_state: string,\r\n    playback_hd: boolean,\r\n    steampeek: boolean,\r\n    support_info: {\r\n        data: any, // TODO fix type\r\n        expiry: number\r\n    },\r\n    review_filters: {\r\n        context?: string,\r\n        language?: string,\r\n        minPlaytime?: string,\r\n        maxPlaytime?: string\r\n    },\r\n    cachedUser?: string\r\n}\r\n\r\nclass LocalStorage<Schema extends StorageSchema> extends Storage<ns.LocalStorageArea, Schema>{\r\n\r\n    public constructor() {\r\n        super(browser.storage.local);\r\n    }\r\n}\r\n\r\nexport default new LocalStorage<LocalStorageSchema>();\r\n\r\n/* FIXME\r\nconst DEFAULTS = {\r\n    \"access_token\": null,\r\n    \"lastItadImport\": {\"from\": null, \"to\": null},\r\n    \"login\": {\"steamId\": null, \"profilePath\": null},\r\n    \"storeCountry\": null,\r\n    \"expand_slider\": false,\r\n    \"market_stats\": {\"startListing\": null, \"purchaseTotal\": 0, \"saleTotal\": 0},\r\n    \"popular_refresh\": false,\r\n    \"workshop_state\": \"\",\r\n    \"playback_hd\": false,\r\n    \"show_review_section\": true,\r\n    \"steampeek\": false,\r\n    \"support_info\": null,\r\n    \"hide_login_warn_store\": false,\r\n    \"hide_login_warn_community\": false,\r\n    \"review_filters\": {},\r\n    \"local_storage_migration\": {\"store\": false, \"community\": false, \"extension\": false},\r\n};\r\n\r\nconst PERSISTENT: (keyof typeof DEFAULTS)[] = [];\r\n*/\r\n", "\r\nclass Timer {\r\n\r\n    private promise: Promise<void>;\r\n\r\n    constructor(duration: number) {\r\n        this.promise = new Promise(resolve => setTimeout(resolve, duration));\r\n    }\r\n\r\n    then(onDone: (value: void) => void|Promise<void>) {\r\n        return this.promise.then(onDone);\r\n    }\r\n}\r\n\r\nexport interface IResettableTimer {\r\n    readonly running: boolean,\r\n    reset: () => void,\r\n    stop: () => void,\r\n}\r\n\r\nclass ResettableTimer implements IResettableTimer {\r\n\r\n    private id: number|undefined;\r\n    private _running: boolean = false;\r\n\r\n    private readonly onDone: () => void|Promise<void>;\r\n    private readonly duration: number;\r\n\r\n    constructor(onDone: () => void|Promise<void>, duration: number) {\r\n        this.onDone = onDone;\r\n        this.duration = duration;\r\n\r\n        this.reset();\r\n    }\r\n\r\n    get running(): boolean {\r\n        return this._running;\r\n    }\r\n\r\n    reset(): void {\r\n        if (typeof this.id !== \"undefined\") {\r\n            clearTimeout(this.id);\r\n        }\r\n\r\n        this.id = window.setTimeout(async() => {\r\n            await this.onDone();\r\n            this._running = false;\r\n        }, this.duration);\r\n\r\n        this._running = true;\r\n    }\r\n\r\n    stop(): void {\r\n        if (typeof this.id !== \"undefined\") {\r\n            clearTimeout(this.id);\r\n            this.id = undefined;\r\n        }\r\n\r\n        this._running = false;\r\n    }\r\n}\r\n\r\n\r\nexport default class TimeUtils {\r\n\r\n    static timer(duration: number): Timer {\r\n        return new Timer(duration);\r\n    }\r\n\r\n    static resettableTimer(onDone: () => void|Promise<void>, duration: number): IResettableTimer {\r\n        return new ResettableTimer(onDone, duration);\r\n    }\r\n\r\n    static now(): number {\r\n        return Math.trunc(Date.now() / 1000);\r\n    }\r\n\r\n    static isInPast(timestamp: number): boolean {\r\n        return timestamp <= this.now();\r\n    }\r\n\r\n    static isInFuture(timestamp: number): boolean {\r\n        return timestamp > this.now();\r\n    }\r\n}\r\n", "import Info from \"@Core/Info\";\r\nimport {\r\n    type IDBPDatabase,\r\n    type IndexKey,\r\n    type IndexNames,\r\n    openDB,\r\n    type StoreKey,\r\n    type StoreNames,\r\n    type StoreValue\r\n} from \"idb\";\r\nimport Migration from \"@Background/Db/Migration\";\r\nimport LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport TimeUtils from \"@Core/Utils/TimeUtils\";\r\nimport type ADB6 from \"@Background/Db/Schemas/ADB6\";\r\n\r\ntype Schema = ADB6;\r\n\r\nexport default class IndexedDB {\r\n\r\n    private static promise: Promise<void>;\r\n\r\n    public static db: IDBPDatabase<Schema>;\r\n\r\n    static init(): Promise<void> {\r\n        if (!this.promise) {\r\n            this.promise = (async () => {\r\n                this.db = await openDB<Schema>(\"Augmented Steam\", Info.db_version, {\r\n                    upgrade: Migration.upgrade,\r\n                    blocked() {\r\n                        console.error(\"Failed to upgrade database, there is already an open connection\");\r\n                    }\r\n                });\r\n\r\n                let dbCleanup = await LocalStorage.get(\"db_cleanup\");\r\n                if (!dbCleanup || TimeUtils.isInPast(dbCleanup + 86400)) {\r\n                    console.log(\"Db cleanup\");\r\n                    await IndexedDB.cleanup();\r\n                    await LocalStorage.set(\"db_cleanup\", TimeUtils.now());\r\n                }\r\n            })();\r\n        }\r\n\r\n        return this.promise;\r\n    }\r\n\r\n    private static async cleanup() {\r\n        const promises = [];\r\n\r\n        const tx = this.db.transaction(this.db.objectStoreNames, \"readwrite\");\r\n        let cursor = await tx.objectStore(\"expiries\")\r\n            .index(\"idx_expiry\")\r\n            .openCursor(IDBKeyRange.upperBound(TimeUtils.now()));\r\n\r\n        while (cursor) {\r\n            let storeName = cursor.key as unknown as StoreNames<Schema>;\r\n\r\n            if (this.db.objectStoreNames.contains(storeName)) {\r\n                promises.push(tx.objectStore(storeName).clear());\r\n            }\r\n            promises.push(cursor.delete());\r\n            cursor = await cursor.continue();\r\n        }\r\n        await Promise.all(promises);\r\n\r\n        await Promise.all([\r\n            this.deleteExpiredEntries(\"packages\", \"idx_expiry\"),\r\n            this.deleteExpiredEntries(\"storePageData\", \"idx_expiry\"),\r\n            this.deleteExpiredEntries(\"profiles\", \"idx_expiry\"),\r\n            this.deleteExpiredEntries(\"rates\", \"idx_expiry\"),\r\n            this.deleteExpiredEntries(\"workshopFileSizes\", \"idx_expiry\"),\r\n            this.deleteExpiredEntries(\"reviews\", \"idx_expiry\"),\r\n        ]);\r\n    }\r\n\r\n    private static async deleteExpiredEntries<\r\n        StoreName extends StoreNames<Schema>,\r\n        IndexName extends IndexNames<Schema, StoreName>\r\n    >(storeName: StoreName, indexName: IndexName) {\r\n        const tx = this.db.transaction(storeName, \"readwrite\");\r\n        const index = tx.store.index(indexName);\r\n        let cursor = await index.openCursor(IDBKeyRange.upperBound(TimeUtils.now()));\r\n\r\n        if (cursor) {\r\n            while (cursor) {\r\n                await cursor.delete();\r\n                cursor = await cursor.continue();\r\n            }\r\n        }\r\n    }\r\n\r\n    static async isStoreExpired<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName\r\n    ): Promise<boolean> {\r\n        let expiry = await this.db.get(\"expiries\", storeName);\r\n        return !expiry || TimeUtils.isInPast(expiry);\r\n    }\r\n\r\n    static async setStoreExpiry(storeName: StoreNames<Schema>, ttlSeconds: number) {\r\n        return this.db.put(\"expiries\", TimeUtils.now() + ttlSeconds, storeName);\r\n    }\r\n\r\n    static async put<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName,\r\n        value: StoreValue<Schema, StoreName>,\r\n        key?: StoreKey<Schema, StoreName>\r\n    ): Promise<void> {\r\n        await this.db.put(storeName, value, key);\r\n    }\r\n\r\n    static async putMany<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName,\r\n        data: Array<[\r\n            StoreKey<Schema, StoreName>,\r\n            StoreValue<Schema, StoreName>\r\n        ]>\r\n    ): Promise<void> {\r\n        const tx = this.db.transaction(storeName, \"readwrite\");\r\n        const store = tx.store;\r\n\r\n        await Promise.all(\r\n            data.map(([key, value]) => store.put(value, key))\r\n        );\r\n\r\n        await tx.done;\r\n    }\r\n\r\n    static async replaceAll<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName,\r\n        data: Array<[\r\n            StoreKey<Schema, StoreName>,\r\n            StoreValue<Schema, StoreName>\r\n        ]>\r\n    ): Promise<void> {\r\n        const tx = this.db.transaction(storeName, \"readwrite\");\r\n        const store = tx.store;\r\n\r\n        await store.clear();\r\n\r\n        if (data.length > 0) {\r\n            await Promise.all(\r\n                data.map(([key, value]) => store.put(value, key))\r\n            );\r\n        }\r\n\r\n        await tx.done;\r\n    }\r\n\r\n    static async get<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName,\r\n        key: StoreKey<Schema, StoreName>\r\n    ): Promise<StoreValue<Schema, StoreName>|undefined> {\r\n        return await this.db.get(storeName, key);\r\n    }\r\n\r\n    static async getObject<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName,\r\n        keys: Array<StoreKey<Schema, StoreName>>\r\n    ): Promise<Record<\r\n        StoreKey<Schema, StoreName>,\r\n        StoreValue<Schema, StoreName>|undefined\r\n    >> {\r\n        let cursor = await this.db.transaction(storeName).store.openCursor();\r\n\r\n        let result = Object.fromEntries(keys.map(k => [k, undefined]));\r\n\r\n        while (cursor) {\r\n            // @ts-ignore\r\n            result[cursor.key] = cursor.value;\r\n            cursor = await cursor.continue();\r\n        }\r\n\r\n        // @ts-ignore\r\n        return result;\r\n    }\r\n\r\n    static async getFromIndex<\r\n        StoreName extends StoreNames<Schema>,\r\n        IndexName extends IndexNames<Schema, StoreName>\r\n    >(\r\n        storeName: StoreName,\r\n        indexName: IndexName,\r\n        key: IndexKey<Schema, StoreName, IndexName>,\r\n    ): Promise<StoreValue<Schema, StoreName>|undefined> {\r\n\r\n        const tx = this.db.transaction(storeName);\r\n        const idx = tx.store.index(indexName);\r\n        return await idx.get(key);\r\n    }\r\n\r\n    static async delete<StoreName extends StoreNames<Schema>>(\r\n        storeName: StoreName,\r\n        ...key: StoreKey<Schema, StoreName>[]\r\n    ): Promise<void> {\r\n        for (let key_ of key) {\r\n            await this.db.delete(storeName, key_);\r\n        }\r\n    }\r\n\r\n    static async clear<StoreName extends StoreNames<Schema>>(\r\n        ...storeName: StoreName[]\r\n    ): Promise<void> {\r\n        const tx = this.db.transaction([...storeName, \"expiries\"], \"readwrite\");\r\n        for (let store of storeName) {\r\n            tx.objectStore(\"expiries\").delete(store);\r\n            tx.objectStore(store).clear();\r\n        }\r\n    }\r\n\r\n    static async contains<\r\n        StoreName extends StoreNames<Schema>,\r\n        Key extends string|number\r\n    >(\r\n        storeName: StoreName,\r\n        keys: Key[]\r\n    ): Promise<Record<Key, boolean>> {\r\n        const tx = this.db.transaction(storeName);\r\n        const store = tx.store;\r\n\r\n        return Object.fromEntries(await Promise.all(\r\n            keys.map(async key => [key, undefined !== (await store.getKey(key as unknown as StoreKey<Schema, StoreName>))]\r\n        )));\r\n    }\r\n}\r\n", "\r\nclass LoginError extends Error {\r\n    constructor(type: string) {\r\n        super(type);\r\n        this.name = \"LoginError\";\r\n    }\r\n}\r\n\r\nclass ServerOutageError extends Error {\r\n    constructor(msg: string) {\r\n        super(msg);\r\n        this.name = \"ServerOutageError\";\r\n    }\r\n}\r\n\r\nclass OAuthUnauthorized extends Error {\r\n    constructor(msg?: string) {\r\n        super(msg);\r\n        this.name = \"OAuth Unauthorized\";\r\n    }\r\n}\r\n\r\nclass HTTPError extends Error {\r\n    public code: number;\r\n\r\n    constructor(code: number, message: string) {\r\n        super(message);\r\n        this.code = code;\r\n    }\r\n}\r\n\r\nclass FeatureDependencyError extends Error {\r\n    public featureName: string;\r\n\r\n    constructor(msg: string, featureName: string) {\r\n        super(msg);\r\n        this.featureName = featureName;\r\n    }\r\n}\r\n\r\nexport default {\r\n    LoginError,\r\n    ServerOutageError,\r\n    HTTPError,\r\n    FeatureDependencyError,\r\n    OAuthUnauthorized\r\n};\r\n", "import Errors from \"@Core/Errors/Errors\";\r\n\r\nexport default abstract class Api {\r\n\r\n    private readonly origin: string;\r\n\r\n    protected constructor(origin: string) {\r\n        this.origin = origin;\r\n    }\r\n\r\n    protected getUrl(path: string, query: Record<string, string|number|undefined> = {}): URL {\r\n        let url = new URL(path, this.origin);\r\n        for (let [key, value] of Object.entries(query)) {\r\n            if (value === undefined) {\r\n                continue\r\n            }\r\n            url.searchParams.set(key, String(value));\r\n        }\r\n        return url\r\n    }\r\n\r\n    protected async fetchJson<T>(\r\n        url: string|URL,\r\n        init: RequestInit = {}\r\n    ): Promise<T> {\r\n        let response = await fetch(url, init);\r\n\r\n        if (!response.ok) {\r\n            throw new Errors.HTTPError(response.status, response.statusText);\r\n        }\r\n\r\n        return await response.json();\r\n    }\r\n\r\n    protected async fetchText(\r\n        url: string|URL,\r\n        init: RequestInit = {}\r\n    ): Promise<string> {\r\n        let response = await fetch(url, init);\r\n\r\n        if (!response.ok) {\r\n            throw new Errors.HTTPError(response.status, response.statusText);\r\n        }\r\n\r\n        return await response.text();\r\n    }\r\n}\r\n\r\n", "\r\nexport default class HTMLParser {\r\n\r\n    private static getVariable(source: string|Element|Document, regex: RegExp): string|null {\r\n        if (typeof source === \"string\") {\r\n            const m = source.match(regex);\r\n            return m && m[1] ? m[1] : null;\r\n        }\r\n\r\n        for (const node of source.querySelectorAll<HTMLScriptElement>(\"script\")) {\r\n            if (node.textContent) {\r\n                const m = node.textContent.match(regex)\r\n                if (m) {\r\n                    return m && m[1] ? m[1] : null;\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static getStringVariable(nameOrRegex: string|RegExp, source: string|Element|Document = document): string|null {\r\n        const regex = typeof nameOrRegex === \"string\"\r\n            ? new RegExp(`${nameOrRegex}\\\\s*=\\\\s*['\"](.+?)['\"];`)\r\n            : nameOrRegex;\r\n        return this.getVariable(source, regex);\r\n    }\r\n\r\n    static getIntVariable(nameOrRegex: string|RegExp, source: string|Element|Document = document): number|null {\r\n        const regex = typeof nameOrRegex === \"string\"\r\n            ? new RegExp(`${nameOrRegex}\\\\s*=\\\\s*(.+?);`)\r\n            : nameOrRegex;\r\n        const v = this.getVariable(source, regex);\r\n        return v ? Number(v) : null;\r\n    }\r\n\r\n    static getArrayVariable<T>(nameOrRegex: string|RegExp, source: string|Element|Document = document): T[]|null {\r\n        const regex = typeof nameOrRegex === \"string\"\r\n            ? new RegExp(`${nameOrRegex}\\\\s*=\\\\s*(\\\\[.+?]);`)\r\n            : nameOrRegex;\r\n        const v = this.getVariable(source, regex);\r\n        return v ? JSON.parse(v) : null;\r\n    }\r\n\r\n    static getObjectVariable<T extends Record<string, any>>(nameOrRegex: string|RegExp, source: string|Element|Document = document): T|null {\r\n        const regex = typeof nameOrRegex === \"string\"\r\n            ? new RegExp(`${nameOrRegex}\\\\s*=\\\\s*(\\\\{.+?});`)\r\n            : nameOrRegex;\r\n        const v = this.getVariable(source, regex);\r\n        return v ? JSON.parse(v) : null;\r\n    }\r\n}\r\n", "import browser from \"webextension-polyfill\";\r\nimport type DomParserInterface from \"@Background/Modules/Dom/DomParserInterface\";\r\nimport type {TReview} from \"@Background/Modules/Community/_types\";\r\n\r\nconst OffscreenDocument = \"html/offscreen_domparser.html\";\r\n\r\nexport default class OffscreenDomParser implements DomParserInterface {\r\n\r\n    private async ensureDocument(): Promise<void> {\r\n        // @ts-expect-error\r\n        const matchedClients = await clients.matchAll();\r\n        for (const client of matchedClients) {\r\n            if (client.url.endsWith(OffscreenDocument)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // @ts-expect-error\r\n        return chrome.offscreen.createDocument({\r\n            url: browser.runtime.getURL(OffscreenDocument),\r\n            reasons: [\"DOM_PARSER\"],\r\n            justification: \"Parsing data from DOM\",\r\n        });\r\n    }\r\n\r\n    private closeDocument(): void {\r\n        // @ts-expect-error\r\n        chrome.offscreen.closeDocument()\r\n    }\r\n\r\n    private async send<T>(op: string, html: string): Promise<T> {\r\n        await this.ensureDocument();\r\n        const response = await browser.runtime.sendMessage({\r\n            domparser: {op, html}\r\n        });\r\n        this.closeDocument();\r\n        return response;\r\n    }\r\n\r\n    parseCurrencyFromWallet(html: string): Promise<string | null> {\r\n        return this.send(\"currencyFromWallet\", html);\r\n    }\r\n\r\n    parseCurrencyFromApp(html: string): Promise<string | null> {\r\n        return this.send(\"currencyFromApp\", html);\r\n    }\r\n\r\n    parseWorkshopFileSize(html: string): number | Promise<number> {\r\n        return this.send(\"workshopFileSize\", html);\r\n    }\r\n\r\n    parseReviews(html: string): TReview[] | Promise<TReview[]> {\r\n        return this.send(\"reviews\", html);\r\n    }\r\n\r\n    parsePurchaseDates(html: string): Promise<Array<[string, string]>> {\r\n        return this.send(\"purchaseDates\", html);\r\n    }\r\n}\r\n\r\n", "import type DomParserInterface from \"@Background/Modules/Dom/DomParserInterface\";\r\nimport OffscreenDomParser from \"@Background/Modules/Dom/OffscreenDomParser\";\r\nimport NativeDomParser from \"@Background/Modules/Dom/NativeDomParser\";\r\n\r\nexport default class DomParserFactory {\r\n\r\n    private static parser: DomParserInterface|null = null;\r\n\r\n    public static getParser(): DomParserInterface {\r\n        if (!this.parser) {\r\n            // @ts-expect-error\r\n            this.parser = __CHROME || __EDGE\r\n                ? new OffscreenDomParser()\r\n                : new NativeDomParser();\r\n        }\r\n        return this.parser!;\r\n    }\r\n}\r\n", "import {EAction} from \"@Background/EAction\";\r\nimport Api from \"../Api\";\r\nimport IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport type {TFetchBadgeInfoResponse, TFetchReviewsResponse, TLogin, TReview} from \"./_types\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport Errors from \"@Core/Errors/Errors\";\r\nimport HTMLParser from \"@Core/Html/HtmlParser\";\r\nimport LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport TimeUtils from \"@Core/Utils/TimeUtils\";\r\nimport {Unrecognized} from \"@Background/background\";\r\nimport DomParserFactory from \"@Background/Modules/Dom/DomParserFactory\";\r\n\r\nexport default class SteamCommunityApi extends Api implements MessageHandlerInterface {\r\n\r\n    constructor() {\r\n        super(\"https://steamcommunity.com/\")\r\n    }\r\n\r\n    private async fetchPage(url: URL) {\r\n        const response = await fetch(url, {credentials: \"include\"});\r\n\r\n        if (!response.ok) {\r\n            throw new Errors.HTTPError(response.status, response.statusText);\r\n        }\r\n\r\n        if (new URL(response.url).pathname === \"/login/home/\") {\r\n            throw new Errors.LoginError(\"community\");\r\n        }\r\n\r\n        return await response.text();\r\n    }\r\n\r\n    private fetchBadgeInfo(steamid: string, appid: number): Promise<TFetchBadgeInfoResponse> {\r\n        const url = this.getUrl(`/profiles/${steamid}/ajaxgetbadgeinfo/${appid}`);\r\n        return this.fetchJson(url, {credentials: \"include\"});\r\n    }\r\n\r\n    /**\r\n     * @return Promise<number>  result size in kB\r\n     */\r\n    private async fetchWorkshopFileSize(id: number): Promise<number> {\r\n        const url = this.getUrl(\"/sharedfiles/filedetails/\", {id});\r\n        const html = await this.fetchText(url, {credentials: \"include\"});\r\n\r\n        const parser = DomParserFactory.getParser();\r\n        const size = await parser.parseWorkshopFileSize(html);\r\n\r\n        if (size === -1) {\r\n            throw new Error(`Couldn't find details block for item id \"${id}\"`);\r\n        }\r\n\r\n        if (size === -2) {\r\n            throw new Error(`Invalid file size for item id \"${id}\"`);\r\n        }\r\n\r\n        return size;\r\n    }\r\n\r\n    private async getWorkshopFileSize(id: number, preventFetch: boolean): Promise<number|null> {\r\n        let entry = await IndexedDB.get(\"workshopFileSizes\", id)\r\n\r\n        if (!entry || TimeUtils.isInPast(entry.expiry)) {\r\n            if (preventFetch) {\r\n                await IndexedDB.delete(\"workshopFileSizes\", id);\r\n                return null;\r\n            } else {\r\n                entry = {\r\n                    size: await this.fetchWorkshopFileSize(id),\r\n                    expiry: TimeUtils.now() + 5 * 86400\r\n                };\r\n                await IndexedDB.put(\"workshopFileSizes\", entry, id);\r\n            }\r\n        }\r\n\r\n        return entry.size;\r\n    }\r\n\r\n    private async fetchReviews(steamId: string, pages: number): Promise<TFetchReviewsResponse> {\r\n        const parser = DomParserFactory.getParser();\r\n        const reviews: TReview[] = [];\r\n        let defaultOrder = 0;\r\n\r\n        for (let p = 1; p <= pages; p++) {\r\n            const url = this.getUrl(`${steamId}/recommended`, {p});\r\n            const html = await this.fetchPage(url);\r\n\r\n            const parsedReviews = await parser.parseReviews(html);\r\n            for (let review of parsedReviews) {\r\n                review.default = defaultOrder++;\r\n                reviews.push(review);\r\n            }\r\n        }\r\n\r\n        return reviews;\r\n    }\r\n\r\n    private async getReviews(steamId: string, pages: number): Promise<TFetchReviewsResponse> {\r\n        let entry = await IndexedDB.get(\"reviews\", steamId)\r\n\r\n        if (!entry || TimeUtils.isInPast(entry.expiry)) {\r\n            entry = {\r\n                data: await this.fetchReviews(steamId, pages),\r\n                expiry: TimeUtils.now() + 60*60\r\n            };\r\n            await IndexedDB.put(\"reviews\", entry, steamId);\r\n        }\r\n\r\n        return entry.data;\r\n    }\r\n\r\n    /*\r\n     * Invoked when the content script thinks the user is logged in\r\n     * If we don't know the user's steamId, fetch their community profile\r\n     */\r\n    private async login(profilePath: string): Promise<TLogin> {\r\n\r\n        if (!profilePath) {\r\n            await this.logout();\r\n            throw new Error(\"Login endpoint needs a valid profile path\");\r\n        }\r\n        if (!profilePath.startsWith(\"/id/\") && !profilePath.startsWith(\"/profiles/\")) {\r\n            await this.logout();\r\n            throw new Error(`Could not interpret ${profilePath} as a valid profile path`);\r\n        }\r\n\r\n        const login = await LocalStorage.get(\"login\");\r\n        if (login?.profilePath === profilePath) {\r\n            return login;\r\n        }\r\n\r\n        const url = this.getUrl(profilePath);\r\n        const html = await this.fetchText(url);\r\n        const profileData = HTMLParser.getObjectVariable(\"g_rgProfileData\", html);\r\n        const steamId = profileData?.steamid;\r\n\r\n        if (!steamId) { // this should never happen\r\n            throw new Error(\"Failed to retrieve steamID from profile\");\r\n        }\r\n\r\n        await this.logout(true);\r\n\r\n        const value = {steamId, profilePath};\r\n        await LocalStorage.set(\"login\", value);\r\n\r\n        return value;\r\n    }\r\n\r\n    private async logout(force: boolean|undefined=undefined): Promise<void> {\r\n        if (force === undefined) {\r\n            force = (await LocalStorage.get(\"login\") !== undefined)\r\n        }\r\n        if (force) {\r\n            await Promise.all([\r\n                LocalStorage.remove(\"login\"),\r\n                LocalStorage.remove(\"storeCountry\"),\r\n                LocalStorage.remove(\"currency\")\r\n            ]);\r\n        }\r\n    }\r\n\r\n    // TODO This and (at least) the login calls don't seem appropriate in this class\r\n    private async setStoreCountry(newCountry: string): Promise<void> {\r\n        await LocalStorage.set(\"storeCountry\", newCountry);\r\n    }\r\n\r\n    private async getStoreCountry(): Promise<string|null> {\r\n        return (await LocalStorage.get(\"storeCountry\")) ?? null;\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch(message.action) {\r\n\r\n            case EAction.BadgeInfo:\r\n                return this.fetchBadgeInfo(message.params.steamId, message.params.appid);\r\n\r\n            case EAction.WorkshopFileSize:\r\n                return this.getWorkshopFileSize(message.params.id, message.params.preventFetch);\r\n\r\n            case EAction.Reviews:\r\n                return this.getReviews(message.params.steamId, message.params.pages);\r\n\r\n            case EAction.Login:\r\n                return this.login(message.params.profilePath);\r\n\r\n            case EAction.Logout:\r\n                return this.logout(message.params.force ?? undefined);\r\n\r\n            case EAction.StoreCountry_Set:\r\n                return this.setStoreCountry(message.params.newCountry);\r\n\r\n            case EAction.StoreCountry_Get:\r\n                return this.getStoreCountry();\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "import Api from \"../Api\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport type {\r\n    TAppDetail,\r\n    TDynamicStoreStatusResponse,\r\n    TPackageDetail,\r\n    TWishlistGame\r\n} from \"./_types\";\r\nimport LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport Errors from \"@Core/Errors/Errors\";\r\nimport HTMLParser from \"@Core/Html/HtmlParser\";\r\nimport TimeUtils from \"@Core/Utils/TimeUtils\";\r\nimport {Unrecognized} from \"@Background/background\";\r\nimport type DomParserInterface from \"@Background/Modules/Dom/DomParserInterface\";\r\nimport DomParserFactory from \"@Background/Modules/Dom/DomParserFactory\";\r\n\r\n// helper types for clarity\r\ntype TAppid = number;\r\ntype TSubid = number;\r\n\r\nexport default class SteamStoreApi extends Api implements MessageHandlerInterface {\r\n\r\n    constructor() {\r\n        super(\"https://store.steampowered.com/\");\r\n    }\r\n\r\n    private async fetchPage(\r\n        url: string|URL\r\n    ): Promise<string> {\r\n        let response = await fetch(url, {credentials: \"include\"});\r\n\r\n        if (!response.ok) {\r\n            throw new Errors.HTTPError(response.status, response.statusText);\r\n        }\r\n\r\n        if (new URL(response.url).pathname === \"/login/\") {\r\n            throw new Errors.LoginError(\"store\");\r\n        }\r\n\r\n        return await response.text();\r\n    }\r\n\r\n    private async fetchPackageApps(subid: TSubid): Promise<TAppid[]> {\r\n        const url = this.getUrl(\"/api/packagedetails/\", {\"packageids\": subid});\r\n        const data = await this.fetchJson<{\r\n            [strSubid: string]: {\r\n                success: boolean,\r\n                data: TPackageDetail\r\n            }\r\n        }>(url)\r\n\r\n        const details = data[String(subid)];\r\n        return details && details.success\r\n            ? details.data.apps.map(obj => obj.id)\r\n            : []\r\n    }\r\n\r\n    public async getPackageApps(subids: number[]): Promise<Map<TSubid, TAppid[]>> {\r\n\r\n        let result = new Map<TSubid, TAppid[]>;\r\n\r\n        let toFetch: number[] = [];\r\n        const data = await IndexedDB.getObject(\"packages\", subids);\r\n        for (let [subid, entry] of Object.entries(data)) {\r\n            if (!entry || TimeUtils.isInPast(entry.expiry)) {\r\n                toFetch.push(Number(subid));\r\n            } else {\r\n                result.set(Number(subid), entry.appids);\r\n            }\r\n        }\r\n\r\n        if (toFetch.length > 0) {\r\n            let newData: Array<[TSubid, {appids: number[], expiry: number}]> = [];\r\n            for (let subid of toFetch) {\r\n                const appids = await this.fetchPackageApps(subid);\r\n                newData.push([\r\n                    subid,\r\n                    {appids, expiry: TimeUtils.now() + 86400}\r\n                ]);\r\n                result.set(subid, appids);\r\n            }\r\n\r\n            if (newData.length > 0) {\r\n                await IndexedDB.putMany(\"packages\", newData);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    private async wishlistAdd(appid: number): Promise<void> {\r\n        let result: Record<string, any>|undefined;\r\n        const sessionid = await this.fetchSessionId();\r\n\r\n        if (sessionid) {\r\n            const url = this.getUrl(\"/api/addtowishlist\");\r\n            result = await this.fetchJson(url, {\r\n                method: \"POST\",\r\n                credentials: \"include\",\r\n                body: new URLSearchParams({\r\n                    sessionid,\r\n                    appid: String(appid)\r\n                })\r\n            });\r\n        }\r\n\r\n        if (!result || !result.success) {\r\n            throw new Error(`Failed to add app ${appid} to wishlist`);\r\n        }\r\n\r\n        await this.clearDynamicStore();\r\n    }\r\n\r\n    private async wishlistRemove(appid: number): Promise<void> {\r\n        let result: Record<string, any>|undefined;\r\n        const sessionid = await this.fetchSessionId();\r\n\r\n        if (sessionid) {\r\n            const url = this.getUrl(\"/api/removefromwishlist\")\r\n            result = await this.fetchJson(url, {\r\n                method: \"POST\",\r\n                credentials: \"include\",\r\n                body: new URLSearchParams({\r\n                    sessionid,\r\n                    appid: String(appid)\r\n                })\r\n            });\r\n        }\r\n\r\n        if (!result || !result.success) {\r\n            throw new Error(`Failed to remove app ${appid} from wishlist`);\r\n        }\r\n\r\n        await this.clearDynamicStore();\r\n    }\r\n\r\n    private async getCurrencyFromWallet(parser: DomParserInterface): Promise<string|null> {\r\n        const url = this.getUrl(\"/steamaccount/addfunds\");\r\n        const html = await this.fetchPage(url);\r\n        return parser.parseCurrencyFromWallet(html);\r\n    }\r\n\r\n    private async getCurrencyFromApp(parser: DomParserInterface): Promise<string|null> {\r\n        const url = this.getUrl(\"/app/220\");\r\n        const html = await this.fetchPage(url);\r\n        return parser.parseCurrencyFromApp(html);\r\n    }\r\n\r\n    private async getCurrency(): Promise<string> {\r\n        let stored = await LocalStorage.get(\"currency\");\r\n        if (stored && TimeUtils.isInFuture(stored.expiry)) {\r\n            return stored.data;\r\n        }\r\n\r\n        const parser = DomParserFactory.getParser();\r\n\r\n        let currency = await this.getCurrencyFromWallet(parser);\r\n        if (!currency) {\r\n            currency = await this.getCurrencyFromApp(parser);\r\n            if (!currency) {\r\n                throw new Error(\"Store currency could not be determined from app 220\");\r\n            }\r\n        }\r\n\r\n        await LocalStorage.set(\"currency\", {\r\n            data: currency,\r\n            expiry: TimeUtils.now() + 86400\r\n        });\r\n        return currency;\r\n    }\r\n\r\n    private async fetchSessionId(): Promise<string|null> {\r\n        const url = this.getUrl(\"/about/\");\r\n        const html = await this.fetchPage(url);\r\n        return HTMLParser.getStringVariable(\"g_sessionID\", html);\r\n    }\r\n\r\n    private async fetchPurchaseDates(lang: string): Promise<Array<[string, string]>> {\r\n        const url = this.getUrl(\"/account/licenses/\", {\"l\": lang});\r\n        const html = await this.fetchPage(url);\r\n        const parser = DomParserFactory.getParser();\r\n\r\n        return parser.parsePurchaseDates(html);\r\n    }\r\n\r\n    private async getPurchaseDate(appName: string, lang: string): Promise<string|null> {\r\n        if (await IndexedDB.isStoreExpired(\"purchases\")) {\r\n            const purchaseDates = await this.fetchPurchaseDates(lang);\r\n            await IndexedDB.putMany(\"purchases\", purchaseDates);\r\n            await IndexedDB.setStoreExpiry(\"purchases\", 86400);\r\n        }\r\n\r\n        return await IndexedDB.get(\"purchases\", appName) ?? null;\r\n    }\r\n\r\n    private clearPurchases(): Promise<void> {\r\n        return IndexedDB.clear(\"purchases\");\r\n    }\r\n\r\n    private async refreshDynamicStore(): Promise<void> {\r\n        const isExpired = await IndexedDB.isStoreExpired(\"dynamicStore\");\r\n        if (!isExpired) {\r\n            return;\r\n        }\r\n\r\n        const url = this.getUrl(\"dynamicstore/userdata\");\r\n        const store = await this.fetchJson<{\r\n            // note: incomplete\r\n            rgOwnedApps: number[],\r\n            rgOwnedPackages: number[],\r\n            rgIgnoredApps: Record<number, number>,\r\n            rgWishlist: number[],\r\n            rgFollowedApps: number[]\r\n        }>(url, {cache: \"no-cache\"});\r\n\r\n        const {rgOwnedApps, rgOwnedPackages, rgIgnoredApps, rgWishlist, rgFollowedApps} = store;\r\n\r\n        let ignored: number[] = [];\r\n        let ignoredOwnedElsewhere: number[] = [];\r\n\r\n        for (let [appid_, value] of Object.entries(rgIgnoredApps)) {\r\n            const appid = Number(appid_);\r\n            if (value === 0) {\r\n                ignored.push(appid);\r\n            } else if (value === 2) {\r\n                ignoredOwnedElsewhere.push(appid);\r\n            }\r\n        }\r\n\r\n        await IndexedDB.putMany(\"dynamicStore\", [\r\n            [\"ignored\", ignored],\r\n            [\"ignoredOwnedElsewhere\", ignoredOwnedElsewhere],\r\n            [\"ownedApps\", rgOwnedApps],\r\n            [\"ownedPackages\", rgOwnedPackages],\r\n            [\"wishlisted\", rgWishlist],\r\n            [\"followed\", rgFollowedApps]\r\n        ]);\r\n        await IndexedDB.setStoreExpiry(\"dynamicStore\", 5*60);\r\n    }\r\n\r\n    private async getDynamicStoreStatus(ids: string[]): Promise<TDynamicStoreStatusResponse> {\r\n        await this.refreshDynamicStore();\r\n\r\n        const db = IndexedDB.db;\r\n        const tx = db.transaction(\"dynamicStore\");\r\n        const index = tx.store.index(\"idx_appid\");\r\n\r\n        let ignored: string[] = [];\r\n        let ignoredOwned: string[] = [];\r\n        let owned: string[] = [];\r\n        let wishlisted: string[] = [];\r\n        let followed: string[] = [];\r\n\r\n        for (const strId of ids) {\r\n            const parts = strId.split(\"/\", 2);\r\n            if (parts.length != 2) {\r\n                continue;\r\n            }\r\n\r\n            const type = parts[0];\r\n            const id = Number(parts[1]);\r\n\r\n            const keys = await index.getAllKeys(id);\r\n            for (let key of keys) {\r\n                switch(key) {\r\n                    case \"ignored\": ignored.push(strId); break;\r\n                    case \"ignoredOwnedElsewhere\": ignoredOwned.push(strId); break;\r\n                    case \"wishlisted\": wishlisted.push(strId); break;\r\n                    case \"followed\": followed.push(strId); break;\r\n                    case \"ownedApps\":\r\n                        if (type === \"app\") {\r\n                            owned.push(strId);\r\n                        }\r\n                        break;\r\n                    case \"ownedPackages\":\r\n                        if (type === \"sub\") {\r\n                            owned.push(strId);\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return {ignored, ignoredOwned, owned, wishlisted, followed};\r\n    }\r\n\r\n    private async dynamicStoreRandomApp(): Promise<number|null> {\r\n        await this.refreshDynamicStore();\r\n\r\n        const ownedApps = await IndexedDB.get(\"dynamicStore\", \"ownedApps\");\r\n        if (!ownedApps || !Array.isArray(ownedApps) || ownedApps.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        return ownedApps[Math.floor(Math.random() * ownedApps.length)]!;\r\n    }\r\n\r\n    private async clearDynamicStore(): Promise<void> {\r\n        await IndexedDB.clear(\"dynamicStore\");\r\n    }\r\n\r\n    private async fetchAppDetails(appid: number, filter: string|undefined=undefined): Promise<TAppDetail|null> {\r\n        const url = this.getUrl(\"api/appdetails/\", {\r\n            appids: appid,\r\n            filter: filter\r\n        });\r\n\r\n        const data = await this.fetchJson<{\r\n            [appid: string]: {\r\n                success: boolean,\r\n                data: TAppDetail\r\n            }\r\n        }|null>(url, {credentials: \"include\"});\r\n\r\n        const strAppid = String(appid);\r\n        if (data && data[strAppid]) {\r\n            const details = data[strAppid]!;\r\n            if (details.success) {\r\n                return details.data;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch(message.action) {\r\n            case EAction.Wishlist_Add:\r\n                return this.wishlistAdd(message.params.appid);\r\n\r\n            case EAction.Wishlist_Remove:\r\n                return this.wishlistRemove(message.params.appid);\r\n\r\n            case EAction.AppDetails:\r\n                return this.fetchAppDetails(message.params.appid, message.params.filter ?? undefined);\r\n\r\n            case EAction.Currency:\r\n                return this.getCurrency();\r\n\r\n            case EAction.SessionId:\r\n                return this.fetchSessionId();\r\n\r\n            case EAction.Purchases:\r\n                return this.getPurchaseDate(message.params.appName, message.params.lang);\r\n\r\n            case EAction.Purchases_Clear:\r\n                return this.clearPurchases();\r\n\r\n            case EAction.DynamicStore_Clear:\r\n                return this.clearDynamicStore();\r\n\r\n            case EAction.DynamicStore_Status:\r\n                return this.getDynamicStoreStatus(message.params.ids);\r\n\r\n            case EAction.DynamicStore_RandomApp:\r\n                return this.dynamicStoreRandomApp();\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "// This is the basic configuration for the Augmented Steam extension\r\n\r\nexport default {\r\n    ApiServerHost: \"https://api.augmentedsteam.com\",\r\n    PublicHost: \"https://augmentedsteam.com\",\r\n    ITADApiServerHost: \"https://api.isthereanydeal.com\",\r\n    ITADServer: \"https://isthereanydeal.com\",\r\n    ITADClientId: \"5fe78af07889f43a\",\r\n    ITADDiscord: \"https://discord.gg/yn57q7f\",\r\n} as const;\r\n", "import Config from \"config\";\r\nimport browser, {type Tabs, type WebRequest} from \"webextension-polyfill\";\r\nimport AccessToken from \"@Background/Modules/IsThereAnyDeal/AccessToken\";\r\n\r\ntype Tab = Tabs.Tab;\r\ntype OnUpdatedChangeInfoType = Tabs.OnUpdatedChangeInfoType;\r\ntype OnRemovedRemoveInfoType = Tabs.OnRemovedRemoveInfoType;\r\n\r\nexport default class Authorization {\r\n\r\n    private readonly RedirectURI = \"https://isthereanydeal.com/connectaugmentedsteam\";\r\n\r\n    private generateString(length: number): string {\r\n        const source = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.~\";\r\n        let arr = new Uint8Array(length);\r\n        crypto.getRandomValues(arr)\r\n        return arr.reduce((result, value) => result + source.charAt(Math.floor(value % source.length)), \"\");\r\n    }\r\n\r\n    private async sha256(str: string): Promise<string> {\r\n        const encoder = new TextEncoder();\r\n        const data = encoder.encode(str);\r\n\r\n        let sha256Buffer = await crypto.subtle.digest(\"SHA-256\", data);\r\n        return String.fromCharCode(...new Uint8Array(sha256Buffer))\r\n    }\r\n\r\n    private base64url(str: string): string {\r\n        return btoa(str)\r\n            .replace(/\\+/g, '-')\r\n            .replace(/\\//g, '_')\r\n            .replace(/=+$/, '');\r\n    }\r\n\r\n    private async getResponseUrl(authTabId: number): Promise<URL> {\r\n        return new Promise<URL>((resolve, reject) => {\r\n            const updateListener = (tabId: number, changeInfo: OnUpdatedChangeInfoType, _tab: Tab): void => {\r\n                if (tabId !== authTabId) {\r\n                    return;\r\n                }\r\n\r\n                if (!changeInfo.url?.startsWith(this.RedirectURI)) {\r\n                    return;\r\n                }\r\n\r\n                browser.tabs.onUpdated.removeListener(updateListener);\r\n                browser.tabs.onRemoved.removeListener(removeListener);\r\n                browser.tabs.remove(tabId);\r\n                resolve(new URL(changeInfo.url!));\r\n            }\r\n\r\n            const removeListener = (tabId: number, _removeInfo: OnRemovedRemoveInfoType): void => {\r\n                if (tabId !== authTabId) {\r\n                    return;\r\n                }\r\n\r\n                browser.tabs.onUpdated.removeListener(updateListener);\r\n                browser.tabs.onRemoved.removeListener(removeListener);\r\n                reject();\r\n            }\r\n\r\n            browser.tabs.onUpdated.addListener(updateListener);\r\n            browser.tabs.onRemoved.addListener(removeListener);\r\n        });\r\n    }\r\n\r\n    async authorize(scope: string[]) {\r\n        const verifier = this.generateString(64);\r\n        const state = this.generateString(30);\r\n\r\n        const authUrl = new URL(`${Config.ITADServer}/oauth/authorize/`);\r\n        authUrl.searchParams.set(\"response_type\", \"code\");\r\n        authUrl.searchParams.set(\"client_id\", Config.ITADClientId);\r\n        authUrl.searchParams.set(\"redirect_uri\", this.RedirectURI);\r\n        authUrl.searchParams.set(\"scope\", scope.join(\" \"));\r\n        authUrl.searchParams.set(\"state\", state);\r\n        authUrl.searchParams.set(\"code_challenge\", this.base64url(await this.sha256(verifier)));\r\n        authUrl.searchParams.set(\"code_challenge_method\", \"S256\");\r\n\r\n        const tab = await browser.tabs.create({\"url\": authUrl.toString()});\r\n        if (!tab.id) {\r\n            throw new Error(\"Missing tab id\");\r\n        }\r\n\r\n        const responseUrl = await this.getResponseUrl(tab.id);\r\n\r\n        if (responseUrl.searchParams.get(\"state\") !== state) {\r\n            throw new Error(\"Failed to verify state parameter from URL fragment\");\r\n        }\r\n\r\n        const code = responseUrl.searchParams.get(\"code\");\r\n        if (!code) {\r\n            throw new Error(\"Failed to receive code\");\r\n        }\r\n\r\n        const tokenUrl = new URL(\"oauth/token/\", Config.ITADServer);\r\n        const params = new URLSearchParams();\r\n        params.set(\"grant_type\", \"authorization_code\");\r\n        params.set(\"client_id\", Config.ITADClientId);\r\n        params.set(\"redirect_uri\", this.RedirectURI);\r\n        params.set(\"code\", code);\r\n        params.set(\"code_verifier\", verifier);\r\n\r\n        let response = await fetch(tokenUrl, {\r\n            method: \"POST\",\r\n            body: params\r\n        });\r\n        const tokens = await response.json() as {access_token: string, expires_in: number};\r\n\r\n        const accessToken = tokens.access_token;\r\n        const expiresIn = tokens.expires_in;\r\n\r\n        if (!accessToken || !expiresIn) {\r\n            throw new Error(`Authorization failed`);\r\n        }\r\n\r\n        await AccessToken.create(accessToken, Number(expiresIn));\r\n    }\r\n}\r\n", "import LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport TimeUtils from \"@Core/Utils/TimeUtils\";\r\n\r\nexport default class AccessToken {\r\n\r\n    private static loadPromise: Promise<string|null>|undefined = undefined;\r\n\r\n    static load(): Promise<string|null> {\r\n        if (!this.loadPromise) {\r\n            this.loadPromise = (async () => {\r\n                const data = await LocalStorage.get(\"access_token\");\r\n                if (!data) {\r\n                    return null;\r\n                }\r\n\r\n                if (TimeUtils.isInPast(data.expiry)) {\r\n                    await LocalStorage.remove(\"access_token\");\r\n                    return null;\r\n                }\r\n\r\n                return data.token;\r\n            })();\r\n        }\r\n\r\n        return this.loadPromise;\r\n    }\r\n\r\n    static async create(token: string, expiresIn: number) {\r\n        await LocalStorage.set(\"access_token\", {\r\n            token: token,\r\n            expiry: TimeUtils.now() + expiresIn\r\n        })\r\n        this.loadPromise = undefined;\r\n    }\r\n\r\n    static async clear(): Promise<void> {\r\n        await LocalStorage.remove(\"access_token\");\r\n        this.loadPromise = undefined;\r\n    }\r\n}\r\n", "\r\nexport default class OutOfCapacityError extends Error {\r\n\r\n    public ratio: number;\r\n\r\n    constructor(ratio: number, message: string|undefined = undefined) {\r\n        super(message);\r\n\r\n        this.name = \"OutOfCapacityError\";\r\n        this.ratio = ratio;\r\n    }\r\n}\r\n", "\r\nexport default class CapacityInfo {\r\n\r\n    public closeToFull: boolean;\r\n    public utilization: number;\r\n\r\n    constructor(closeToFull: boolean = false, utilization: number) {\r\n        this.closeToFull = closeToFull;\r\n        this.utilization = utilization;\r\n    }\r\n}\r\n", "import type AdapterInterface from \"@Content/Modules/UserNotes/Adapters/AdapterInterface\";\r\nimport OutOfCapacityError from \"@Content/Modules/UserNotes/OutOfCapacityError\";\r\nimport CapacityInfo from \"@Content/Modules/UserNotes/CapacityInfo\";\r\nimport SyncedStorage from \"@Core/Storage/SyncedStorage\";\r\n\r\nexport default class SyncedStorageAdapter implements AdapterInterface{\r\n\r\n    private async getNotesMap(): Promise<Map<number, string>> {\r\n        return new Map<number, string>(\r\n            Object.entries((await SyncedStorage.get(\"user_notes\")) ?? {})\r\n                .map(([appid, note]) => [Number(appid), note])\r\n        );\r\n    }\r\n\r\n    async get(...appids: number[]): Promise<Map<number, string|null>> {\r\n\r\n        const result = new Map<number, string|null>(\r\n            appids.map(appid => [appid, null])\r\n        );\r\n\r\n        const notes = await SyncedStorage.get(\"user_notes\");\r\n        if (notes) {\r\n            for (let [appidStr, note] of Object.entries(notes)) {\r\n                const appid = Number(appidStr);\r\n                if (!result.has(appid)) {\r\n                    continue;\r\n                }\r\n                result.set(appid, note);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    async set(appid: number, note: string): Promise<CapacityInfo> {\r\n        const notes = await this.getNotesMap();\r\n        notes.set(appid, note);\r\n\r\n        const notesObj = Object.fromEntries(notes.entries());\r\n\r\n        const storageUsage = this.getNotesSize(notesObj) / SyncedStorage.QUOTA_BYTES_PER_ITEM;\r\n        if (storageUsage > 1) {\r\n            throw new OutOfCapacityError(storageUsage, \"Can't set this user note, out of capacity\");\r\n        }\r\n\r\n        await SyncedStorage.set(\"user_notes\", notesObj);\r\n        return new CapacityInfo(storageUsage > 0.85, storageUsage);\r\n    }\r\n\r\n    async delete(appid: number): Promise<void> {\r\n        const notes = await this.getNotesMap();\r\n        notes.delete(appid);\r\n\r\n        return notes.size > 0\r\n            ? SyncedStorage.set(\"user_notes\", Object.fromEntries(notes.entries()))\r\n            : SyncedStorage.remove(\"user_notes\");\r\n    }\r\n\r\n    async export(): Promise<Record<string, string>> {\r\n        const map = await this.getNotesMap();\r\n        return Object.fromEntries(map.entries());\r\n    }\r\n\r\n    async import(notes: Record<string, string>): Promise<void> {\r\n        const storageUsage = this.getNotesSize(notes) / SyncedStorage.QUOTA_BYTES_PER_ITEM;\r\n        if (storageUsage > 1) {\r\n            throw new OutOfCapacityError(storageUsage, \"Import to synced storage failed, too much data for this adapter\");\r\n        }\r\n        return SyncedStorage.set(\"user_notes\", notes);\r\n    }\r\n\r\n    clear(): Promise<void> {\r\n        return SyncedStorage.remove(\"user_notes\");\r\n    }\r\n\r\n    private getNotesSize(notes: Record<number, string>): number {\r\n        return \"user_notes\".length + JSON.stringify(notes).length;\r\n    }\r\n}\r\n", "import Api from \"../Api\";\r\nimport Config from \"config\";\r\nimport IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport type {\r\n    TCollectionCopiesResponse,\r\n    TCollectionCopy,\r\n    TGetNotesApiResponse,\r\n    TGetStoreListResponse,\r\n    TInCollectionResponse,\r\n    TInWaitlistResponse,\r\n    TLastImportResponse,\r\n    TNotesList,\r\n    TPushNotesStatus,\r\n    TShopInfo, TSyncEvent\r\n} from \"./_types\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport Authorization from \"./Authorization\";\r\nimport Settings, {SettingsStore} from \"@Options/Data/Settings\";\r\nimport AccessToken from \"@Background/Modules/IsThereAnyDeal/AccessToken\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport Errors from \"@Core/Errors/Errors\";\r\nimport LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport TimeUtils from \"@Core/Utils/TimeUtils\";\r\nimport {Unrecognized} from \"@Background/background\";\r\nimport {__userNote_syncErrorEmpty, __userNote_syncErrorLength, __userNote_syncErrorUnknown} from \"@Strings/_strings\";\r\nimport SyncedStorageAdapter from \"@Content/Modules/UserNotes/Adapters/SyncedStorageAdapter\";\r\n\r\nconst MaxNoteLength = 250;\r\nconst SyncEventsLimit = 40;\r\nconst StoreListTTL = 84600;\r\nconst PushGamesInterval = 5*60;\r\nconst PullWaitlistInterval = 15*60;\r\nconst PullCollectionInterval = 15*60;\r\nconst PullNotesInterval = 2*60;\r\n\r\nconst RequiredScopes = [\r\n    \"wait_read\",\r\n    \"wait_write\",\r\n    \"coll_read\",\r\n    \"coll_write\",\r\n    \"notes_read\",\r\n    \"notes_write\"\r\n];\r\n\r\nexport default class ITADApi extends Api implements MessageHandlerInterface {\r\n\r\n    constructor() {\r\n        super(Config.ITADApiServerHost);\r\n    }\r\n\r\n    private async fetchStoreList(): Promise<TShopInfo[]> {\r\n        const url = this.getUrl(\"service/shops/v1\");\r\n        const storeList = (await this.fetchJson(url));\r\n\r\n        if (!Array.isArray(storeList)) {\r\n            throw new Error(\"Can't read store list from response\");\r\n        }\r\n\r\n        return storeList.map(store => {return {\r\n            id: store.id,\r\n            title: store.title\r\n        }});\r\n    }\r\n\r\n    /**\r\n     * @return Promise<Map<string,string>>    Map<steamId, itadId>\r\n     */\r\n    private async fetchSteamIds(gids: string[]): Promise<Map<string, string>> {\r\n        const url = this.getUrl(\"lookup/shop/61/id/v1\");\r\n        let obj = await this.fetchJson<Record<string, string[]|null>>(url, {\r\n            method: \"POST\",\r\n            headers: {\"content-type\": \"application/json\"},\r\n            body: JSON.stringify(gids)\r\n        });\r\n\r\n        let map: Map<string, string> = new Map();\r\n        for (let [itad, steamIds] of Object.entries(obj)) {\r\n            if (steamIds !== null) {\r\n                for (let steamId of steamIds) {\r\n                    map.set(steamId, itad);\r\n                }\r\n            }\r\n        }\r\n        return map;\r\n    }\r\n\r\n    private async fetchGameIds(steamIds: string[]): Promise<Map<string, string>> {\r\n        const url = this.getUrl(\"lookup/id/shop/61/v1\");\r\n        let obj = await this.fetchJson<Record<string, string|null>>(url, {\r\n            method: \"POST\",\r\n            headers: {\"content-type\": \"application/json\"},\r\n            body: JSON.stringify(steamIds)\r\n        });\r\n\r\n        let map = new Map();\r\n        for (let [steam, itad] of Object.entries(obj)) {\r\n            if (itad !== null) {\r\n                map.set(steam, itad);\r\n            }\r\n        }\r\n        return map;\r\n    }\r\n\r\n    private async fetchCollection(): Promise<Map<string, TCollectionCopy[]>|null> {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            return null;\r\n        }\r\n\r\n        const collectionResponse = await this.fetchJson<{id: string}[]>(\r\n            this.getUrl(\"/collection/games/v1\"), {\r\n                headers: {\"authorization\": \"Bearer \" + accessToken}\r\n            });\r\n\r\n        if (collectionResponse.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        const collection = new Map<string, TCollectionCopy[]>();\r\n        for (let game of collectionResponse) {\r\n            collection.set(game.id, []);\r\n        }\r\n\r\n        const copiesResponse = await this.fetchJson<TCollectionCopiesResponse>(\r\n            this.getUrl(\"/collection/copies/v1\"), {\r\n                headers: {\"authorization\": \"Bearer \" + accessToken}\r\n            });\r\n\r\n        for (let item of copiesResponse) {\r\n            const gid = item.game.id;\r\n            let copy: TCollectionCopy = {\r\n                redeemed: item.redeemed\r\n            };\r\n            if (item.shop) {\r\n                copy.shop = item.shop.name;\r\n            }\r\n            if (item.note) {\r\n                copy.note = item.note;\r\n            }\r\n            if (item.tags.length > 0) {\r\n                copy.tags = item.tags.map(tag => tag.tag);\r\n            }\r\n\r\n            collection.get(gid)?.push(copy);\r\n        }\r\n\r\n        const idMap = await this.fetchSteamIds([...collection.keys()])\r\n        let result: Map<string, TCollectionCopy[]> = new Map<string, TCollectionCopy[]>();\r\n        for (let [steamId, itadId] of idMap.entries()) {\r\n            result.set(steamId, collection.get(itadId) ?? []);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private async fetchWaitlist() {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            return null;\r\n        }\r\n\r\n        const url = this.getUrl(\"/waitlist/games/v1\")\r\n        let waitlist = await this.fetchJson<{id: string}[]>(url, {\r\n            headers: {\"authorization\": \"Bearer \" + accessToken}\r\n        });\r\n        if (waitlist.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        let gids = waitlist.map(entry => entry.id);\r\n        return await this.fetchSteamIds(gids);\r\n    }\r\n\r\n    private async getStoreList(): Promise<TGetStoreListResponse> {\r\n        if (await IndexedDB.isStoreExpired(\"storeList\")) {\r\n            let result = await this.fetchStoreList();\r\n            await IndexedDB.replaceAll(\"storeList\", result.map(store => [store.id, store]));\r\n            await IndexedDB.setStoreExpiry(\"storeList\", StoreListTTL);\r\n            return result;\r\n        } else {\r\n            return await IndexedDB.db.getAll(\"storeList\");\r\n        }\r\n    }\r\n\r\n    private async isConnected(): Promise<boolean> {\r\n        return (await AccessToken.load()) !== null;\r\n    }\r\n\r\n    private async disconnect(): Promise<void> {\r\n        await AccessToken.clear();\r\n        await LocalStorage.remove(\"lastItadImport\");\r\n        await LocalStorage.remove(\"syncEvents\");\r\n        return IndexedDB.clear(\"collection\", \"waitlist\", \"itadImport\");\r\n    }\r\n\r\n    private async getLastImport(): Promise<TLastImportResponse> {\r\n        return (await LocalStorage.get(\"lastItadImport\")) ?? {from: null, to: null};\r\n    }\r\n\r\n    private async recordLastImport(): Promise<void> {\r\n        let lastImport = await this.getLastImport();\r\n        lastImport.from = TimeUtils.now();\r\n        await LocalStorage.set(\"lastItadImport\", lastImport);\r\n    }\r\n\r\n    private async getSyncEvents(): Promise<TSyncEvent[]> {\r\n        return (await LocalStorage.get(\"syncEvents\")) ?? [];\r\n    }\r\n\r\n    private async recordSyncEvent(section: string, type: \"push\"|\"pull\", count: number): Promise<void> {\r\n        const events = await this.getSyncEvents();\r\n        events.unshift({section, type, timestamp: TimeUtils.now(), count});\r\n        await LocalStorage.set(\"syncEvents\", events.slice(0, SyncEventsLimit));\r\n    }\r\n\r\n    private async removeFromWaitlist(appids: number[]) {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            throw new Error(\"Missing access token\");\r\n        }\r\n\r\n        if (appids.length === 0) {\r\n            throw new Error(\"Can't remove nothing from ITAD Waitlist!\");\r\n        }\r\n        const steamIds = appids.map(appid => `app/${appid}`);\r\n\r\n        let gids = await Promise.all(\r\n            steamIds.map(id => IndexedDB.get(\"waitlist\", id))\r\n        );\r\n        gids = gids.filter(value => value); // filter out undefined values\r\n\r\n        if (gids.length > 0) {\r\n            const url = this.getUrl(\"waitlist/games/v1\");\r\n            let response = await fetch(url, {\r\n                method: \"DELETE\",\r\n                headers: {\"authorization\": \"Bearer \" + accessToken},\r\n                body: JSON.stringify(gids)\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Errors.HTTPError(response.status, response.statusText);\r\n            }\r\n\r\n            return IndexedDB.delete(\"waitlist\", ...steamIds)\r\n        }\r\n        // TODO error handling\r\n    }\r\n\r\n    private async addToWaitlist(appids: number[]) {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            throw new Error(\"Missing access token\");\r\n        }\r\n\r\n        const steamIds = appids.map(appid => `app/${appid}`);\r\n        const map = await this.fetchGameIds(steamIds);\r\n\r\n        if (map.size !== 0) {\r\n            let response = await fetch(new URL(\"waitlist/games/v1\", Config.ITADApiServerHost), {\r\n                method: \"PUT\",\r\n                headers: {\"authorization\": \"Bearer \" + accessToken},\r\n                body: JSON.stringify(Array.from(map.values()))\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Errors.HTTPError(response.status, response.statusText);\r\n            }\r\n\r\n            return IndexedDB.putMany(\"waitlist\", [...map]);\r\n        }\r\n\r\n        // TODO error handling\r\n    }\r\n\r\n    private async addToCollection(appids: number[], subids: number[]) {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            throw new Error(\"Missing access token\");\r\n        }\r\n\r\n        const steamids = [\r\n            ...appids.map(appid => `app/${appid}`),\r\n            ...subids.map(subid => `sub/${subid}`),\r\n        ];\r\n\r\n        if (steamids.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const map = await this.fetchGameIds(steamids);\r\n\r\n        if (map.size !== 0) {\r\n            let response = await fetch(new URL(\"collection/games/v1\", Config.ITADApiServerHost), {\r\n                method: \"PUT\",\r\n                headers: {\"authorization\": \"Bearer \" + accessToken},\r\n                body: JSON.stringify(Array.from(map.values()))\r\n            });\r\n\r\n            if (response.ok) {\r\n                return IndexedDB.putMany(\"collection\", [...map.keys()].map(key => [key, []]))\r\n            }\r\n        }\r\n\r\n        // TODO error handling\r\n    }\r\n\r\n    private async exportToItad(force: boolean): Promise<void> {\r\n        await SettingsStore.load();\r\n\r\n        if (!Settings.itad_sync_library && !Settings.itad_sync_wishlist) {\r\n            return;\r\n        }\r\n\r\n        if (!force) {\r\n            const lastImport = await this.getLastImport();\r\n\r\n            if (lastImport.to && TimeUtils.isInFuture(lastImport.to + PushGamesInterval)) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (Settings.itad_sync_library) {\r\n            const tx = IndexedDB.db.transaction([\"dynamicStore\", \"itadImport\"]);\r\n            const dynamicStore = tx.objectStore(\"dynamicStore\");\r\n            const itadImport = tx.objectStore(\"itadImport\");\r\n\r\n            const lastOwnedApps: Set<number> = new Set(await itadImport.get(\"lastOwnedApps\") ?? []);\r\n            const lastOwnedPackages: Set<number> = new Set(await itadImport.get(\"lastOwnedPackages\") ?? []);\r\n\r\n            const ownedApps: number[] = await dynamicStore.get(\"ownedApps\") ?? [];\r\n            const ownedPackages: number[] = await dynamicStore.get(\"ownedPackages\") ?? [];\r\n            await tx.done;\r\n\r\n            const newOwnedApps: number[] = ownedApps.filter(id => force || !lastOwnedApps.has(id));\r\n            const newOwnedPackages: number[] = ownedPackages.filter(id => force || !lastOwnedPackages.has(id));\r\n\r\n            if (newOwnedApps.length > 0 || newOwnedPackages.length > 0) {\r\n                await this.addToCollection(newOwnedApps, newOwnedPackages);\r\n                await IndexedDB.putMany(\"itadImport\", [\r\n                    [\"lastOwnedApps\", ownedApps],\r\n                    [\"lastOwnedPackages\", ownedPackages]\r\n                ])\r\n            }\r\n            await this.recordSyncEvent(\"collection\", \"push\", newOwnedApps.length + newOwnedPackages.length);\r\n        }\r\n\r\n        if (Settings.itad_sync_wishlist) {\r\n            const tx = IndexedDB.db.transaction([\"dynamicStore\", \"itadImport\"]);\r\n            const dynamicStore = tx.objectStore(\"dynamicStore\");\r\n            const itadImport = tx.objectStore(\"itadImport\");\r\n\r\n            const lastWishlisted: Set<number> = new Set(await itadImport.get(\"lastWishlisted\") ?? []);\r\n            const wishlisted: number[] = await dynamicStore.get(\"wishlisted\") ?? [];\r\n            await tx.done;\r\n\r\n            const newWishlisted: number[] = wishlisted.filter(id => force || !lastWishlisted.has(id));\r\n\r\n            if (newWishlisted.length > 0) {\r\n                await this.addToWaitlist(newWishlisted);\r\n                await IndexedDB.put(\"itadImport\", wishlisted, \"lastWishlisted\");\r\n            }\r\n            await this.recordSyncEvent(\"waitlist\", \"push\", newWishlisted.length);\r\n        }\r\n\r\n        let lastImport = await this.getLastImport();\r\n        lastImport.to = TimeUtils.now();\r\n\r\n        await LocalStorage.set(\"lastItadImport\", lastImport);\r\n    }\r\n\r\n    private async importWaitlist(force: boolean): Promise<void> {\r\n        await SettingsStore.load();\r\n\r\n        if (!Settings.itad_sync_wishlist) {\r\n            return;\r\n        }\r\n        if (force || await IndexedDB.isStoreExpired(\"waitlist\")) {\r\n            const data = await this.fetchWaitlist();\r\n            await IndexedDB.replaceAll(\"waitlist\", data ? [...data.entries()] : []);\r\n            await IndexedDB.setStoreExpiry(\"waitlist\", PullWaitlistInterval);\r\n            await this.recordLastImport();\r\n            await this.recordSyncEvent(\"waitlist\", \"pull\", data?.size ?? 0);\r\n        }\r\n    }\r\n\r\n    private async importCollection(force: boolean): Promise<void> {\r\n        await SettingsStore.load();\r\n\r\n        if (!Settings.itad_sync_library) {\r\n            return;\r\n        }\r\n        if (force || await IndexedDB.isStoreExpired(\"collection\")) {\r\n            const data = await this.fetchCollection();\r\n            await IndexedDB.replaceAll(\"collection\", data ? [...data.entries()] : []);\r\n            await IndexedDB.setStoreExpiry(\"collection\", PullCollectionInterval);\r\n            await this.recordLastImport();\r\n            await this.recordSyncEvent(\"collection\", \"pull\", data?.size ?? 0);\r\n        }\r\n    }\r\n\r\n    private async sync(force: boolean): Promise<void> {\r\n        await SettingsStore.load();\r\n\r\n        await this.exportToItad(force);\r\n        await this.importWaitlist(force);\r\n        await this.importCollection(force);\r\n\r\n        if (Settings.itad_sync_notes) {\r\n            await this.pullNotes(force);\r\n        }\r\n    }\r\n\r\n    private async inWaitlist(storeIds: string[]): Promise<TInWaitlistResponse> {\r\n        await this.importWaitlist(false);\r\n        return IndexedDB.contains(\"waitlist\", storeIds);\r\n    }\r\n\r\n    private async inCollection(storeIds: string[]): Promise<TInCollectionResponse> {\r\n        await this.importCollection(false);\r\n        return IndexedDB.contains(\"collection\", storeIds);\r\n    }\r\n\r\n    private async getFromCollection(storeId: string): Promise<TCollectionCopy[]|null> {\r\n        await this.importCollection(false);\r\n        return (await IndexedDB.get(\"collection\", storeId)) ?? null;\r\n    }\r\n\r\n    private async pullNotes(force: boolean): Promise<number> {\r\n        await SettingsStore.load();\r\n\r\n        if (!force && !(await IndexedDB.isStoreExpired(\"notes\"))) {\r\n            return 0;\r\n        }\r\n\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            throw new Errors.OAuthUnauthorized();\r\n        }\r\n\r\n        const response = await this.fetchJson<TGetNotesApiResponse>(\r\n            this.getUrl(\"/user/notes/v1\"), {\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"authorization\": \"Bearer \" + accessToken,\r\n                    \"accept\": \"application/json\"\r\n                }\r\n            });\r\n\r\n        const result: Map<number, string> = new Map();\r\n\r\n        if (response.length !== 0) {\r\n            const notes: Map<string, string> = new Map<string, string>(\r\n                response.map(o => [o.gid, o.note])\r\n            );\r\n\r\n            const steamIds = await this.fetchSteamIds([...notes.keys()]);\r\n\r\n            for (let [steamId, gid] of steamIds) {\r\n                if (!steamId.startsWith(\"app/\")) {\r\n                    continue;\r\n                }\r\n\r\n                const appid = Number(steamId.substring(4));\r\n                const note = notes.get(gid)!;\r\n\r\n                result.set(appid, note);\r\n            }\r\n\r\n            switch(Settings.user_notes_adapter) {\r\n                case \"synced_storage\":\r\n                    /**\r\n                     * A little bit of hack, but SyncedStorageAdapter may be used in Background,\r\n                     * and it does better handling that I would want to do here.\r\n                     * Synced Storage should be removed in future versions.\r\n                     */\r\n                    const adapter = new SyncedStorageAdapter();\r\n                    for (const [appid, note] of result) {\r\n                        await adapter.set(appid, note);\r\n                    }\r\n                    break;\r\n\r\n                case \"idb\":\r\n                    await IndexedDB.putMany(\"notes\",\r\n                        [...result.entries()].map(([appid, note]) => [Number(appid), note])\r\n                    );\r\n                    break;\r\n            }\r\n        }\r\n\r\n        await IndexedDB.setStoreExpiry(\"notes\", PullNotesInterval);\r\n        await this.recordLastImport();\r\n        await this.recordSyncEvent(\"notes\", \"pull\", result.size);\r\n        return result.size;\r\n    }\r\n\r\n    private async pushNotes(notes: TNotesList): Promise<TPushNotesStatus> {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            throw new Errors.OAuthUnauthorized();\r\n        }\r\n\r\n        const status: TPushNotesStatus = {\r\n            pushed: 0,\r\n            errors: []\r\n        }\r\n\r\n        if (notes.length === 0) {\r\n            return status;\r\n        }\r\n\r\n        const map: Map<number, string> = new Map<number, string>(notes);\r\n        const appids = [...map.keys()].map(appid => `app/${appid}`);\r\n\r\n        const gids = await this.fetchGameIds(appids);\r\n\r\n        let toPush: Array<{\r\n            gid: string,\r\n            note: string\r\n        }> = [];\r\n\r\n        for (let [appid, note] of map.entries()) {\r\n            note = note.trim();\r\n            if (note === \"\") {\r\n                status.errors.push([appid, __userNote_syncErrorEmpty, null]);\r\n                continue;\r\n            }\r\n\r\n            if (note.length > MaxNoteLength) {\r\n                status.errors.push([appid, __userNote_syncErrorLength, {\r\n                    length: note.length,\r\n                    max: MaxNoteLength\r\n                }]);\r\n                continue;\r\n            }\r\n\r\n            const gid: string|null = gids.get(`app/${appid}`) ?? null;\r\n            if (gid === null) {\r\n                status.errors.push([appid, __userNote_syncErrorUnknown, null]);\r\n                continue;\r\n            }\r\n\r\n            toPush.push({gid, note});\r\n        }\r\n\r\n        if (toPush.length !== 0) {\r\n            const response = await fetch(\r\n                this.getUrl(\"/user/notes/v1\"), {\r\n                    method: \"PUT\",\r\n                    headers: {\r\n                        \"authorization\": \"Bearer \" + accessToken,\r\n                        \"content-type\": \"application/json\",\r\n                        \"accept\": \"application/json\",\r\n                    },\r\n                    body: JSON.stringify(toPush)\r\n                });\r\n\r\n            if (!response.ok) {\r\n                throw new Errors.HTTPError(response.status, response.statusText);\r\n            }\r\n        }\r\n\r\n        status.pushed = toPush.length;\r\n        await this.recordSyncEvent(\"notes\", \"push\", status.pushed);\r\n        return status;\r\n    }\r\n\r\n    private async deleteNotes(appids: number[]): Promise<void> {\r\n        const accessToken = await AccessToken.load();\r\n        if (!accessToken) {\r\n            throw new Errors.OAuthUnauthorized();\r\n        }\r\n\r\n        const gids = await this.fetchGameIds(\r\n            appids.map(appid => `app/${appid}`)\r\n        );\r\n\r\n        const response = await fetch(\r\n            this.getUrl(\"/user/notes/v1\"), {\r\n                method: \"DELETE\",\r\n                headers: {\r\n                    \"authorization\": \"Bearer \" + accessToken,\r\n                    \"content-type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify([...gids.values()])\r\n            });\r\n\r\n        if (!response.ok) {\r\n            throw new Errors.HTTPError(response.status, response.statusText);\r\n        }\r\n    }\r\n\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch(message.action) {\r\n            case EAction.StoreList:\r\n                return this.getStoreList();\r\n\r\n            case EAction.Authorize:\r\n                return ((new Authorization()).authorize(RequiredScopes));\r\n\r\n            case EAction.Disconnect:\r\n                return this.disconnect();\r\n\r\n            case EAction.IsConnected:\r\n                return this.isConnected();\r\n\r\n            case EAction.Export:\r\n                return this.exportToItad(message.params.force);\r\n\r\n            case EAction.Sync:\r\n                return this.sync(message.params.force);\r\n\r\n            case EAction.LastImport:\r\n                return this.getLastImport();\r\n\r\n            case EAction.SyncEvents:\r\n                return this.getSyncEvents();\r\n\r\n            case EAction.InWaitlist:\r\n                return this.inWaitlist(message.params.storeIds);\r\n\r\n            case EAction.AddToWaitlist:\r\n                return this.addToWaitlist(message.params.appids);\r\n\r\n            case EAction.RemoveFromWaitlist:\r\n                return this.removeFromWaitlist(message.params.appids);\r\n\r\n            case EAction.InCollection:\r\n                return this.inCollection(message.params.storeIds);\r\n\r\n            case EAction.GetFromCollection:\r\n                return this.getFromCollection(message.params.storeId);\r\n\r\n            case EAction.ITAD_Notes_Pull:\r\n                return this.pullNotes(true);\r\n\r\n            case EAction.ITAD_Notes_Push:\r\n                return this.pushNotes(message.params.notes);\r\n\r\n            case EAction.ITAD_Notes_Delete:\r\n                return this.deleteNotes(message.params.appids);\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "import IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport Config from \"config\";\r\nimport Api from \"../Api\";\r\nimport type {\r\n    TProfileData,\r\n    TDlcInfo,\r\n    TFetchMarketCardAveragePricesResponse,\r\n    TFetchMarketCardPricesResponse,\r\n    TFetchPricesResponse,\r\n    TFetchProfileBackgroundsGamesResponse,\r\n    TFetchProfileBackgroundsResponse,\r\n    TFetchRatesResponse,\r\n    TStorePageData,\r\n    TFetchTwitchStreamResponse,\r\n    TIsEarlyAccessResponse,\r\n    TSimilarResponse\r\n} from \"@Background/Modules/AugmentedSteam/_types\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport TimeUtils from \"@Core/Utils/TimeUtils\";\r\nimport {Unrecognized} from \"@Background/background\";\r\n\r\nexport default class AugmentedSteamApi extends Api implements MessageHandlerInterface{\r\n\r\n    constructor() {\r\n        super(Config.ApiServerHost);\r\n    }\r\n\r\n    private fetchStorePageData(appid: number): Promise<TStorePageData> {\r\n        const url = this.getUrl(`app/${appid}/v2`);\r\n        return this.fetchJson(url);\r\n    }\r\n\r\n    private fetchRates(to: string[]): Promise<{[from: string]: {[to: string]: number}}> {\r\n        const url = this.getUrl(`rates/v1`, {to: to.join(\",\")});\r\n        return this.fetchJson(url);\r\n    }\r\n\r\n    private fetchEarlyAccess(): Promise<Array<number>> {\r\n        const url = this.getUrl(\"early-access/v1\");\r\n        return this.fetchJson(url);\r\n    }\r\n\r\n    private fetchSteamPeek(appid: number): Promise<TSimilarResponse> {\r\n        const url = this.getUrl(`similar/${appid}/v2`, {count: 15});\r\n        return this.fetchJson(url);\r\n    }\r\n\r\n    private fetchDlcInfo(appid: number): Promise<TDlcInfo> {\r\n        const url = this.getUrl(`dlc/${appid}/v2`);\r\n        return this.fetchJson<TDlcInfo>(url);\r\n    }\r\n\r\n    private fetchProfile(steamId: string): Promise<TProfileData> {\r\n        const url = this.getUrl(`profile/${steamId}/v2`);\r\n        return this.fetchJson(url);\r\n    }\r\n\r\n    private fetchTwitch(twitchChannelId: string): Promise<TFetchTwitchStreamResponse> {\r\n        const url = this.getUrl(`twitch/${twitchChannelId}/stream/v2`);\r\n        return this.fetchJson<TFetchTwitchStreamResponse>(url);\r\n    }\r\n\r\n    private fetchProfileBackgrounds(appid: number): Promise<TFetchProfileBackgroundsResponse> {\r\n        const url = this.getUrl(\"profile/background/list/v2\", {appid});\r\n        return this.fetchJson<TFetchProfileBackgroundsResponse>(url);\r\n    }\r\n\r\n    private fetchProfileBackgroundsGames(): Promise<TFetchProfileBackgroundsGamesResponse> {\r\n        const url = this.getUrl(\"profile/background/games/v1\");\r\n        return this.fetchJson<TFetchProfileBackgroundsGamesResponse>(url);\r\n    }\r\n\r\n    private fetchMarketAverageCardPrices(currency: string, appids: number[]): Promise<TFetchMarketCardAveragePricesResponse> {\r\n        const url = this.getUrl(\"market/cards/average-prices/v2\", {\r\n            currency,\r\n            appids: appids.join(\",\")\r\n        });\r\n        return this.fetchJson(url);\r\n    }\r\n\r\n    private fetchPrices(\r\n        country: string,\r\n        apps: number[],\r\n        subs: number[],\r\n        bundles: number[],\r\n        voucher: boolean,\r\n        shops: number[]\r\n    ): Promise<TFetchPricesResponse> {\r\n        const url = this.getUrl(\"prices/v2\");\r\n\r\n        return this.fetchJson<TFetchPricesResponse>(url, {\r\n            method: \"POST\",\r\n            body: JSON.stringify({country, apps, subs, bundles, voucher, shops})\r\n        });\r\n    }\r\n\r\n    private async getProfileData(steamId: string): Promise<TProfileData> {\r\n        const ttl = 24*60*60;\r\n\r\n        let data = await IndexedDB.get(\"profiles\", steamId);\r\n\r\n        if (!data || TimeUtils.isInPast(data.expiry)) {\r\n            data = {\r\n                data: await this.fetchProfile(steamId),\r\n                expiry: TimeUtils.now() + ttl\r\n            };\r\n            await IndexedDB.put(\"profiles\", data, steamId);\r\n        }\r\n\r\n        return data.data;\r\n    }\r\n\r\n    private clearOwn(steamId: string): Promise<void> {\r\n        return IndexedDB.delete(\"profiles\", steamId);\r\n    }\r\n\r\n    async getStorePageData(appid: number): Promise<TStorePageData> {\r\n        const ttl = 60*60;\r\n\r\n        let data = await IndexedDB.get(\"storePageData\", appid);\r\n\r\n        if (!data || TimeUtils.isInPast(data.expiry)) {\r\n            data = {\r\n                data: await this.fetchStorePageData(appid),\r\n                expiry: TimeUtils.now() + ttl\r\n            }\r\n            await IndexedDB.put(\"storePageData\", data, appid);\r\n        }\r\n\r\n        return data.data;\r\n    }\r\n\r\n    expireStorePageData(appid: number): Promise<void> {\r\n        return IndexedDB.delete(\"storePageData\", appid);\r\n    }\r\n\r\n    async getRates(to: string[]): Promise<TFetchRatesResponse> {\r\n        const ttl = 60*60;\r\n        const key = to.join(\",\");\r\n\r\n        let rates = await IndexedDB.get(\"rates\", key);\r\n\r\n        if (!rates || TimeUtils.isInPast(rates.expiry)) {\r\n            rates = {\r\n                data: await this.fetchRates(to),\r\n                expiry: TimeUtils.now() + ttl\r\n            };\r\n            await IndexedDB.put(\"rates\", rates, key);\r\n        }\r\n        return rates.data;\r\n    }\r\n\r\n    clearRates() {\r\n        return IndexedDB.clear(\"rates\");\r\n    }\r\n\r\n    async isEarlyAccess(appids: number[]): Promise<TIsEarlyAccessResponse> {\r\n        const ttl = 2*60*60;\r\n        const isExpired = await IndexedDB.isStoreExpired(\"earlyAccessAppids\");\r\n\r\n        if (isExpired) {\r\n            const appids = await this.fetchEarlyAccess();\r\n\r\n            await IndexedDB.replaceAll(\r\n                \"earlyAccessAppids\",\r\n                appids.map(appid => [appid, appid]),\r\n            );\r\n            await IndexedDB.setStoreExpiry(\"earlyAccessAppids\", ttl)\r\n        }\r\n\r\n        return IndexedDB.contains(\"earlyAccessAppids\", appids);\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch (message.action) {\r\n\r\n            case EAction.Prices: {\r\n                const {country, apps, subs, bundles, voucher, shops} = message.params;\r\n                return this.fetchPrices(country, apps, subs, bundles, voucher, shops);\r\n            }\r\n\r\n            case EAction.DlcInfo:\r\n                return this.fetchDlcInfo(message.params.appid);\r\n\r\n            case EAction.StorePageData:\r\n                return this.getStorePageData(message.params.appid);\r\n\r\n            case EAction.StorePageData_Expire:\r\n                return this.expireStorePageData(message.params.appid);\r\n\r\n            case EAction.Rates:\r\n                return this.getRates(message.params.to);\r\n\r\n            case EAction.Rates_Clear:\r\n                return this.clearRates();\r\n\r\n            case EAction.IsEA:\r\n                return this.isEarlyAccess(message.params.appids);\r\n\r\n            case EAction.ProfileBackground:\r\n                return this.fetchProfileBackgrounds(message.params.appid);\r\n\r\n            case EAction.ProfileBackgroundGames:\r\n                return this.fetchProfileBackgroundsGames();\r\n\r\n            case EAction.TwitchStream:\r\n                return this.fetchTwitch(message.params.channelId);\r\n\r\n            case EAction.Market_AverageCardPrices:\r\n                return this.fetchMarketAverageCardPrices(message.params.currency, message.params.appids);\r\n\r\n            case EAction.SteamPeek:\r\n                return this.fetchSteamPeek(message.params.appid);\r\n\r\n            case EAction.Profile:\r\n                return this.getProfileData(message.params.steamId);\r\n\r\n            case EAction.Profile_Clear:\r\n                return this.clearOwn(message.params.steamId);\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "import type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport {Unrecognized} from \"@Background/background\";\r\n\r\nexport default class UserNotesApi implements MessageHandlerInterface {\r\n\r\n    private getNote(appids: number[]): Promise<Record<number, string|undefined>> {\r\n        return IndexedDB.getObject(\"notes\", appids);\r\n    }\r\n\r\n    private async setNote(appid: number, note: string): Promise<void> {\r\n        await IndexedDB.put(\"notes\", note, appid)\r\n    }\r\n\r\n    private deleteNote(appid: number): Promise<void> {\r\n        return IndexedDB.delete(\"notes\", appid);\r\n    }\r\n\r\n    private async getAllNotes(): Promise<Record<number, string>> {\r\n        const db = IndexedDB.db;\r\n        let cursor = await db.transaction(\"notes\").store.openCursor();\r\n\r\n        let result: Record<number, string> = {};\r\n        while (cursor) {\r\n            result[cursor.key] = cursor.value;\r\n            cursor = await cursor.continue();\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private async setAllNotes(notes: Record<number|string, string>): Promise<void> {\r\n        await this.clearNotes();\r\n\r\n        return IndexedDB.putMany(\"notes\",\r\n            Object.entries(notes).map(([appid, note]) => [Number(appid), note])\r\n        );\r\n    }\r\n\r\n    private clearNotes(): Promise<void> {\r\n        return IndexedDB.clear(\"notes\");\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch(message.action) {\r\n            case EAction.Notes_Get:\r\n                return this.getNote(message.params.appids);\r\n\r\n            case EAction.Notes_Set:\r\n                return this.setNote(message.params.appid, message.params.note);\r\n\r\n            case EAction.Notes_Delete:\r\n                return this.deleteNote(message.params.appid);\r\n\r\n            case EAction.Notes_GetAll:\r\n                return this.getAllNotes();\r\n\r\n            case EAction.Notes_SetAll:\r\n                return this.setAllNotes(message.params.notes);\r\n\r\n            case EAction.Notes_Clear:\r\n                return this.clearNotes();\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "\r\nexport default abstract class GameId {\r\n\r\n    private readonly full: string;\r\n\r\n    protected constructor(\r\n        private type_: \"app\"|\"sub\"|\"bundle\",\r\n        private id_: number\r\n    ) {\r\n        this.full = `${this.type_}/${this.id_}`;\r\n    }\r\n\r\n    get type(): \"app\"|\"sub\"|\"bundle\" {\r\n        return this.type_;\r\n    }\r\n\r\n    get number(): number {\r\n        return this.id_;\r\n    }\r\n\r\n    get string(): string {\r\n        return this.full;\r\n    };\r\n}\r\n", "import GameId from \"@Core/GameId/GameId\";\r\n\r\n// TODO refactor to return instance\r\nexport default class AppId extends GameId {\r\n\r\n    static fromUrl(url: string) {\r\n        const m = url.match(/(?:store\\.steampowered|steamcommunity)\\.com\\/(?:app|games|market\\/listings)\\/(\\d+)\\/?/);\r\n        return m && m[1] !== undefined\r\n            ? Number(m[1])\r\n            : null;\r\n    }\r\n\r\n    static fromCDNUrl(url: string): number|null {\r\n        const CDNRegex_1 = /(?:cdn\\.(?:(?:akamai|cloudflare|fastly)\\.)?steamstatic\\.com\\/steam|steamcdn-a\\.akamaihd\\.net\\/steam|steamcommunity\\/public\\/images)\\/apps\\/(\\d+)\\//;\r\n        const CDNRegex_2 = /shared\\.(?:(?:akamai|cloudflare|fastly)\\.)?steamstatic\\.com\\/store_item_assets\\/steam\\/apps\\/(\\d+)\\//;\r\n        const m = url.match(CDNRegex_1) ?? url.match(CDNRegex_2);\r\n        return m && m[1] !== undefined\r\n            ? Number(m[1])\r\n            : null;\r\n    }\r\n\r\n    static fromGameCardUrl(url: string): number|null {\r\n        const m = url.match(/\\/gamecards\\/(\\d+)/);\r\n        return m && m[1] !== undefined\r\n            ? Number(m[1])\r\n            : null;\r\n    }\r\n\r\n    static fromElement(element: HTMLElement|null): number|null {\r\n        if (!element) {\r\n            return null;\r\n        }\r\n\r\n        const appid = element.dataset.dsAppid;\r\n        if (appid) {\r\n            return Number(appid);\r\n        }\r\n\r\n        const href = element.getAttribute(\"href\");\r\n        if (!href) {\r\n            return null;\r\n        }\r\n\r\n        return this.fromUrl(href);\r\n    }\r\n\r\n    static fromImageElement(element: HTMLImageElement|null): number|null {\r\n        if (!element) {\r\n            return null;\r\n        }\r\n\r\n        const src = element.getAttribute(\"src\");\r\n        if (src) {\r\n            return this.fromCDNUrl(src);\r\n        } else if (element.dataset.imageUrl) {\r\n            return this.fromCDNUrl(element.dataset.imageUrl);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    static fromText(text: string): number[] {\r\n        const regex = /(?:store\\.steampowered|steamcommunity)\\.com\\/app\\/(\\d+)\\/?/g;\r\n        const result: number[] = [];\r\n        let m;\r\n        while ((m = regex.exec(text)) !== null) {\r\n            result.push(Number(m[1]));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    constructor(id: number) {\r\n        super(\"app\", id);\r\n    }\r\n}\r\n", "import type {TCoupon} from \"@Background/Modules/Community/_types\";\r\nimport IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport Api from \"@Background/Modules/Api\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport {\r\n    ContextId,\r\n    type HasItemResponse,\r\n    type InventoryData,\r\n    type InventoryResponse\r\n} from \"@Background/Modules/Inventory/_types\";\r\nimport SteamStoreApi from \"@Background/Modules/Store/SteamStoreApi\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport Errors from \"@Core/Errors/Errors\";\r\nimport AppId from \"@Core/GameId/AppId\";\r\nimport {Unrecognized} from \"@Background/background\";\r\n\r\n\r\nexport default class InventoryApi extends Api implements MessageHandlerInterface {\r\n\r\n    private refreshCouponsPromise: Promise<void>|undefined;\r\n    private refreshGiftsPromise: Promise<void>|undefined;\r\n\r\n    constructor() {\r\n        super(\"https://steamcommunity.com/\");\r\n    }\r\n\r\n    private async loadInventory(contextId: number) {\r\n        const login = await LocalStorage.get(\"login\");\r\n\r\n        if (!login || !login.steamId) {\r\n            console.warn(\"Must be signed in to access Inventory\");\r\n            return null;\r\n        }\r\n\r\n        let data: InventoryData|null = null;\r\n\r\n        let url = new URL(`/inventory/${login.steamId}/753/${contextId}`, \"https://steamcommunity.com/\");\r\n        url.searchParams.set(\"l\", \"english\");\r\n        url.searchParams.set(\"count\", \"2000\");\r\n\r\n        let hasMoreItems = false;\r\n        do {\r\n            hasMoreItems = false;\r\n\r\n            let response = await fetch(url, {credentials: \"include\"});\r\n\r\n            if (!response.ok) {\r\n                if (response.status === 403) {\r\n                    throw new Errors.LoginError(\"community\");\r\n                }\r\n\r\n                throw new Errors.HTTPError(response.status, response.statusText);\r\n            }\r\n\r\n            let result: InventoryResponse = await response.json();\r\n\r\n            if (result && result.success) {\r\n                if (!data) {\r\n                    data = {\r\n                        \"assets\": [],\r\n                        \"descriptions\": []\r\n                    };\r\n                }\r\n                if (result.assets) {\r\n                    data.assets.push(...result.assets);\r\n                }\r\n                if (result.descriptions) {\r\n                    data.descriptions.push(...result.descriptions);\r\n                }\r\n\r\n                if (result.last_assetid) {\r\n                    url.searchParams.set(\"start_assetid\", result.last_assetid);\r\n                }\r\n\r\n                if (result.more_items) {\r\n                    hasMoreItems = true;\r\n                }\r\n            }\r\n        } while (hasMoreItems);\r\n\r\n        if (!data) {\r\n            throw new Error(`Could not retrieve Inventory 753/${contextId}`);\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    private async fetchCoupons() {\r\n        const data = await this.loadInventory(ContextId.Coupons);\r\n        if (!data) {\r\n            return null;\r\n        }\r\n\r\n        const coupons: Map<number, TCoupon> = new Map();\r\n\r\n        for (const description of data.descriptions) {\r\n            if (!description.type || description.type !== \"Coupon\") {\r\n                continue;\r\n            }\r\n            if (!description.actions) {\r\n                continue;\r\n            }\r\n\r\n            const coupon: TCoupon = {\r\n                appids: [],\r\n                image_url: description.icon_url,\r\n                title: description.name,\r\n                discount: Number(description.name.match(/([1-9][0-9])%/)![1]),\r\n                id: `${description.classid}_${description.instanceid}`\r\n            };\r\n            description.descriptions.forEach((desc, i) => {\r\n                const value = desc.value;\r\n                if (value.startsWith(\"Can't be applied with other discounts.\")) {\r\n                    coupon.discount_note = value;\r\n                    coupon.discount_note_id = i;\r\n                    coupon.discount_doesnt_stack = true;\r\n                } else if (value.startsWith(\"(Valid\")) {\r\n                    coupon.valid_id = i;\r\n                    coupon.valid = value;\r\n                }\r\n            });\r\n\r\n            for (const action of description.actions) {\r\n                const match = action.link.match(/[1-9][0-9]*(?:,[1-9][0-9]*)*/);\r\n                if (!match) {\r\n                    console.warn(\"Couldn't find packageid(s) for link %s\", action.link);\r\n                    continue;\r\n                }\r\n\r\n                for (let packageidStr of match[0].split(\",\")) {\r\n                    let packageid = Number(packageidStr);\r\n                    if (!coupons.has(packageid) || coupons.get(packageid)!.discount < coupon.discount) {\r\n                        coupons.set(packageid, coupon);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        const packages = await (new SteamStoreApi()).getPackageApps([...coupons.keys()]);\r\n        for (const [subid, coupon] of coupons.entries()) {\r\n            coupon.appids = packages.get(subid) ?? [];\r\n        }\r\n\r\n        return coupons;\r\n    }\r\n\r\n    private async fetchGiftsAndPasses() { // context#1, gifts and guest passes\r\n        const data = await this.loadInventory(ContextId.GiftsAndPasses);\r\n        if (!data) {\r\n            return null;\r\n        }\r\n\r\n        const gifts: number[] = [];\r\n        const passes: number[] = [];\r\n\r\n        let isPackage = false;\r\n        for (const description of data.descriptions) {\r\n\r\n            const desc = description.descriptions?.find(d => d.type === \"html\");\r\n            if (desc) {\r\n                const appids = AppId.fromText(desc.value);\r\n                if (appids.length > 0) {\r\n\r\n                    // Gift package with multiple apps\r\n                    isPackage = true;\r\n\r\n                    for (const appid of appids) {\r\n                        if (description.type === \"Gift\") {\r\n                            gifts.push(appid);\r\n                        } else {\r\n                            passes.push(appid);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Single app\r\n            if (!isPackage && description.actions && description.actions.length > 1) {\r\n                const appid = AppId.fromUrl(description.actions[0]!.link);\r\n                if (appid) {\r\n                    if (description.type === \"Gift\") {\r\n                        gifts.push(appid);\r\n                    } else {\r\n                        passes.push(appid);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return {gifts, passes};\r\n    }\r\n\r\n    private async fetchItems() {\r\n        const data = await this.loadInventory(ContextId.CommunityItems);\r\n        if (!data) {\r\n            return null;\r\n        }\r\n\r\n        return data.descriptions.map(item => item.market_hash_name);\r\n    }\r\n\r\n\r\n    private async refreshCoupons(): Promise<void> {\r\n        if (!this.refreshCouponsPromise) {\r\n            this.refreshCouponsPromise = (async() => {\r\n                const isExpired = await IndexedDB.isStoreExpired(\"coupons\");\r\n                if (isExpired) {\r\n                    let coupons = await this.fetchCoupons();\r\n                    if (coupons === null) {\r\n                        await IndexedDB.clear(\"coupons\");\r\n                    } else {\r\n                        await IndexedDB.replaceAll(\"coupons\", [...coupons.entries()])\r\n                        await IndexedDB.setStoreExpiry(\"coupons\", 60*60);\r\n                    }\r\n                }\r\n            })();\r\n        }\r\n        return this.refreshCouponsPromise;\r\n    }\r\n\r\n    private async getCoupon(appid: number): Promise<TCoupon|undefined> {\r\n        await this.refreshCoupons();\r\n        return IndexedDB.getFromIndex(\"coupons\", \"idx_appid\", appid);\r\n    }\r\n\r\n    private async getCouponsAppids(appids: number[]): Promise<string[]> {\r\n        await this.refreshCoupons();\r\n\r\n        const tx = IndexedDB.db.transaction(\"coupons\");\r\n        const couponsSet = new Set(await tx.store.index(\"idx_appid\").getAllKeys());\r\n\r\n        const result: string[] = [];\r\n        for (let appid of appids) {\r\n            if (couponsSet.has(appid)) {\r\n                result.push(\"app/\"+appid);\r\n            }\r\n        }\r\n\r\n        await tx.done;\r\n        return result;\r\n    }\r\n\r\n    private async refreshGiftsAndPasses(): Promise<void> {\r\n        if (!this.refreshGiftsPromise) {\r\n            this.refreshGiftsPromise = (async() => {\r\n                const isExpired = await IndexedDB.isStoreExpired(\"giftsAndPasses\");\r\n                if (isExpired) {\r\n                    let data = await this.fetchGiftsAndPasses();\r\n                    if (data === null) {\r\n                        await IndexedDB.clear(\"giftsAndPasses\");\r\n                    } else {\r\n                        await IndexedDB.replaceAll(\"giftsAndPasses\", [\r\n                            [\"gifts\", data.gifts],\r\n                            [\"passes\", data.passes]\r\n                        ]);\r\n                        await IndexedDB.setStoreExpiry(\"giftsAndPasses\", 60*60);\r\n                    }\r\n                }\r\n            })();\r\n        }\r\n        return this.refreshGiftsPromise;\r\n    }\r\n\r\n    private async getGiftsAppids(appids: number[]): Promise<string[]> {\r\n        await this.refreshGiftsAndPasses();\r\n\r\n        const tx = IndexedDB.db.transaction(\"giftsAndPasses\");\r\n        const giftsSet = new Set((await tx.store.get(\"gifts\")) ?? []);\r\n\r\n        const result: string[] = [];\r\n        for (let appid of appids) {\r\n            if (giftsSet.has(appid)) {\r\n                result.push(\"app/\"+appid);\r\n            }\r\n        }\r\n\r\n        await tx.done;\r\n        return result;\r\n    }\r\n\r\n\r\n    private async getPassesAppids(appids: number[]): Promise<string[]> {\r\n        await this.refreshGiftsAndPasses();\r\n\r\n        const tx = IndexedDB.db.transaction(\"giftsAndPasses\");\r\n        const passesSet = new Set((await tx.store.get(\"passes\")) ?? []);\r\n\r\n        const result: string[] = [];\r\n        for (let appid of appids) {\r\n            if (passesSet.has(appid)) {\r\n                result.push(\"app/\"+appid);\r\n            }\r\n        }\r\n\r\n        await tx.done;\r\n        return result;\r\n    }\r\n\r\n    private async hasItem(hashes: string[]): Promise<HasItemResponse> {\r\n        const isExpired = await IndexedDB.isStoreExpired(\"items\");\r\n        if (isExpired) {\r\n            let data = await this.fetchItems();\r\n            if (data === null) {\r\n                await IndexedDB.clear(\"items\");\r\n            } else {\r\n                await IndexedDB.replaceAll(\"items\", data.map(hash => [hash, hash]));\r\n                await IndexedDB.setStoreExpiry(\"items\", 60*60);\r\n            }\r\n        }\r\n\r\n        return await IndexedDB.contains(\"items\", hashes);\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch(message.action) {\r\n            case EAction.Inventory_GetCoupon:\r\n                return this.getCoupon(message.params.appid);\r\n\r\n            case EAction.Inventory_GetCouponsAppids:\r\n                return this.getCouponsAppids(message.params.appids);\r\n\r\n            case EAction.Inventory_GetGiftsAppids:\r\n                return this.getGiftsAppids(message.params.appids);\r\n\r\n            case EAction.Inventory_GetPassesAppids:\r\n                return this.getPassesAppids(message.params.appids);\r\n\r\n            case EAction.Inventory_HasItem:\r\n                return this.hasItem(message.params.hashes);\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "import IndexedDB from \"@Background/Db/IndexedDB\";\r\nimport type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport LocalStorage from \"@Core/Storage/LocalStorage\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport {Unrecognized} from \"@Background/background\";\r\n\r\nexport default class CacheApi implements MessageHandlerInterface{\r\n\r\n    private async clearCache(): Promise<void> {\r\n        await LocalStorage.remove(\r\n            \"currency\",\r\n            // @ts-expect-error\r\n            \"market_stats\", // deprecated entry, remove after some time\r\n            \"market_stats2\"\r\n        );\r\n\r\n        await IndexedDB.clear(\r\n            \"coupons\",\r\n            \"giftsAndPasses\",\r\n            \"items\",\r\n            \"earlyAccessAppids\",\r\n            \"purchases\",\r\n            \"dynamicStore\",\r\n            \"packages\",\r\n            \"profiles\",\r\n            \"rates\",\r\n            \"collection\",\r\n            \"waitlist\",\r\n            \"itadImport\",\r\n            \"workshopFileSizes\",\r\n            \"reviews\",\r\n            \"storeList\",\r\n            \"storePageData\",\r\n            \"expiries\"\r\n        );\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch (message.action) {\r\n            case EAction.CacheClear: {\r\n                return this.clearCache();\r\n            }\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "export enum ContextType {\r\n    Unknown,\r\n    Background,\r\n    ContentScript,\r\n    Options,\r\n    Offscreen\r\n}\r\n\r\nexport default class Environment {\r\n\r\n    private static currentContext: ContextType = ContextType.Unknown;\r\n\r\n    public static set CurrentContext(context: ContextType) {\r\n        this.currentContext = context;\r\n    }\r\n\r\n    static isBackgroundScript(): boolean {\r\n        return this.currentContext === ContextType.Background;\r\n    }\r\n\r\n    static isContentScript(): boolean {\r\n        return this.currentContext === ContextType.ContentScript;\r\n    }\r\n\r\n    static isOptions(): boolean {\r\n        return this.currentContext === ContextType.Options;\r\n    }\r\n}\r\n", "import Info from \"@Core/Info\";\r\n\r\ntype VersionTypes = Version|string|Array<string|number>;\r\n\r\nexport default class Version {\r\n\r\n    private readonly major: number;\r\n    private readonly minor: number;\r\n    private readonly patch:number;\r\n\r\n    constructor(major: number, minor: number = 0, patch: number = 0) {\r\n        console.assert([major, minor, patch].filter(Number.isInteger).length === 3, `${major}.${minor}.${patch} must be integers`);\r\n        this.major = major;\r\n        this.minor = minor;\r\n        this.patch = patch;\r\n    }\r\n\r\n    static from(version: VersionTypes) {\r\n        if (version instanceof Version) {\r\n            return new Version(version.major, version.minor, version.patch);\r\n        }\r\n        if (typeof version == \"string\") {\r\n            return Version.fromString(version);\r\n        }\r\n        if (Array.isArray(version)) {\r\n            return Version.fromArray(version);\r\n        }\r\n        throw new Error(`Could not construct a Version from ${version}`);\r\n    }\r\n\r\n    static fromArray(version: Array<string|number>): Version {\r\n        if (version.length === 0) {\r\n            throw new Error();\r\n        }\r\n\r\n        return new Version(\r\n            Number(version[0]),\r\n            Number(version[1] ?? 0),\r\n            Number(version[2] ?? 0)\r\n        );\r\n    }\r\n\r\n    static fromString(version: string): Version {\r\n        return Version.fromArray(version.split(\".\"));\r\n    }\r\n\r\n    static coerce(version: VersionTypes): Version {\r\n        if (version instanceof Version) {\r\n            return version;\r\n        }\r\n        return Version.from(version);\r\n    }\r\n\r\n    toString(): string {\r\n        return `${this.major}.${this.minor}.${this.patch}`;\r\n    }\r\n\r\n    toArray(): [number, number, number] {\r\n        return [this.major, this.minor, this.patch];\r\n    }\r\n\r\n    toJSON(): string {\r\n        return this.toString();\r\n    }\r\n\r\n    isCurrent(): boolean {\r\n        return this.isSameOrAfter(Info.version);\r\n    }\r\n\r\n    isSame(version: VersionTypes): boolean {\r\n        const _version = Version.coerce(version);\r\n        return this.major === _version.major\r\n            && this.minor === _version.minor\r\n            && this.patch === _version.patch;\r\n    }\r\n\r\n    isBefore(version: VersionTypes): boolean {\r\n        const _version = Version.coerce(version);\r\n        if (this.major < _version.major) { return true; }\r\n        if (this.major > _version.major) { return false; }\r\n\r\n        // this.major == _version.major\r\n        if (this.minor < _version.minor) { return true; }\r\n        if (this.minor > _version.minor) { return false; }\r\n\r\n        // this.minor == _version.minor\r\n        if (this.patch < _version.patch) { return true; }\r\n        return false;\r\n    }\r\n\r\n    isSameOrBefore(version: VersionTypes): boolean {\r\n        return this.isSame(version) || this.isBefore(version);\r\n    }\r\n\r\n    isAfter(version: VersionTypes): boolean {\r\n        const _version = Version.coerce(version);\r\n        return _version.isBefore(this);\r\n    }\r\n\r\n    isSameOrAfter(version: VersionTypes): boolean {\r\n        const _version = Version.coerce(version);\r\n        return _version.isSameOrBefore(this);\r\n    }\r\n}\r\n", "import Version from \"@Core/Version\";\r\nimport {SyncedStorage} from \"@Core/Storage/SyncedStorage\";\r\nimport {SettingsStore} from \"@Options/Data/Settings\";\r\nimport AccessToken from \"@Background/Modules/IsThereAnyDeal/AccessToken\";\r\n\r\nexport default class SettingsMigration {\r\n\r\n    public static async migrate(oldVersion: Version): Promise<void> {\r\n        const storage = new SyncedStorage<any>();\r\n\r\n        if (oldVersion.isSameOrBefore(\"2.0.0\")) {\r\n            await storage.remove(\"showfakeccwarning\");\r\n            await storage.remove(\"hideaboutlinks\");\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"2.0.1\")) {\r\n            await storage.remove(\"hide_dlcunownedgames\");\r\n            await storage.remove(\"hide_wishlist\");\r\n            await storage.remove(\"hide_cart\");\r\n            await storage.remove(\"hide_notdiscounted\");\r\n            await storage.remove(\"hide_mixed\");\r\n            await storage.remove(\"hide_negative\");\r\n            await storage.remove(\"hide_priceabove\");\r\n            await storage.remove(\"priceabove_value\");\r\n            await storage.remove(\"hide_owned\");\r\n            await storage.remove(\"hide_ignored\");\r\n            await storage.remove(\"highlight_notdiscounted\");\r\n            await storage.remove(\"showallfriendsthatown\");\r\n\r\n            const showusernotes = storage.get(\"showusernotes\");\r\n            if (showusernotes !== undefined) {\r\n                await SettingsStore.set(\"user_notes_app\", Boolean(showusernotes));\r\n                await SettingsStore.set(\"user_notes_wishlist\", Boolean(showusernotes));\r\n                await storage.remove(\"showusernotes\");\r\n            }\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"2.1.0\")) {\r\n            await storage.remove(\"showcomparelinks\");\r\n\r\n            const links = await storage.get(\"profile_custom_link\");\r\n            for (const link of links) {\r\n                if (link.url && !link.url.includes(\"[ID]\")) {\r\n                    link.url += \"[ID]\";\r\n                }\r\n            }\r\n            await SettingsStore.set(\"profile_custom_link\", links);\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"2.3.3\")) {\r\n            const options = await storage.get(\"customize_apppage\");\r\n            for (const customizerKey of [\"steamchart\", \"surveys\", \"steamspy\"]) {\r\n                if (Object.prototype.hasOwnProperty.call(options, customizerKey) && typeof options[customizerKey] === \"boolean\") {\r\n                    delete options[customizerKey];\r\n                }\r\n            }\r\n\r\n            await SettingsStore.set(\"customize_apppage\", options);\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"2.4.1\")) {\r\n            await storage.remove(\"showallachievements\");\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"2.5.0\")) {\r\n            await storage.remove(\"replaceaccountname\");\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"3.0.0\")) {\r\n            const shopUpdateMap = {\r\n                \"adventureshop\":1,\"allyouplay\":2,\"amazonus\":3,\"battlenet\":4,\"bistore\":5,\"bundlestars\":6,\"coinplay\":7,\r\n                \"cybermanta\":8,\"desura\":9,\"digitaldownload\":10,\"direct2drive\":11,\"discord\":12,\"dlgamer\":13,\"dotemu\":14,\r\n                \"dreamgame\":15,\"epic\":16,\"fireflower\":17,\"funstock\":18,\"game2\":19,\"gamebillet\":20,\"gamefly\":21,\r\n                \"gamejolt\":22,\"gameolith\":23,\"gamersgate\":24,\"gamesload\":25,\"gamesplanet\":26,\"gamesplanetde\":27,\r\n                \"gamesplanetfr\":28,\"gamesplanetus\":29,\"gamesrepublic\":30,\"gamesrocket\":31,\"gametap\":32,\"gemly\":33,\r\n                \"getgames\":34,\"gog\":35,\"greenmangaming\":36,\"humblestore\":37,\"humblewidgets\":38,\"chrono\":39,\r\n                \"imperialgames\":40,\"impulse\":41,\"indiegalastore\":42,\"indiegamestand\":43,\"itchio\":44,\"lbostore\":45,\r\n                \"less4games\":46,\"macgamestore\":47,\"microsoft\":48,\"newegg\":49,\"nuuvem\":50,\"oculus\":51,\"origin\":52,\"paradox\":53,\r\n                \"playfield\":54,\"playism\":55,\"razer\":56,\"savemi\":57,\"shinyloot\":58,\"silagames\":59,\"squenix\":60,\"steam\":61,\r\n                \"uplay\":62,\"voidu\":63,\"wingamestore\":64,\"joybuggy\":65,\"noctre\":66,\"etailmarket\":67\r\n            }\r\n\r\n            const excluded = await storage.get(\"excluded_stores\");\r\n            await SettingsStore.set(\"excluded_stores\", excluded\r\n                // @ts-ignore\r\n                .map((oldKey: any) => shopUpdateMap[oldKey] ?? null)\r\n                .filter((value: number|null) => value))\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"3.1.0\")) {\r\n            await storage.remove(\"addtocart_no_redirect\");\r\n            await storage.remove(\"show_steamspy_info\");\r\n            await storage.remove(\"show_survey_info\");\r\n            await storage.remove(\"show_steamchart_info\");\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"4.0.1\")) {\r\n            await SettingsStore.set(\"itad_sync_library\", (await storage.get(\"itad_import_library\") ?? true));\r\n            await SettingsStore.set(\"itad_sync_wishlist\", (await storage.get(\"itad_import_wishlist\") ?? true));\r\n            await storage.remove(\"itad_import_library\");\r\n            await storage.remove(\"itad_import_wishlist\");\r\n            await AccessToken.clear(); // new scopes are required\r\n        }\r\n\r\n        if (oldVersion.isSameOrBefore(\"4.1.2\")) {\r\n            await storage.remove(\"showdeckcompat\");\r\n        }\r\n    }\r\n}\r\n", "import type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport {Unrecognized} from \"@Background/background\";\r\nimport browser, {type Tabs, type WebRequest, webRequest} from \"webextension-polyfill\";\r\n\r\ntype OnCompleteCallback = (request: WebRequest.OnCompletedDetailsType) => Promise<void>;\r\n\r\nexport default class WebRequestHandler implements MessageHandlerInterface {\r\n\r\n    /**\r\n     * Map of listeners by tab id => key => callback\r\n     */\r\n    private listeners: Map<number, Map<string, OnCompleteCallback>> = new Map;\r\n\r\n    private unregister(tabid: number) {\r\n        console.log(`Unregister webrequest listeners for tab ${tabid}, tab no longer exists`);\r\n        const current: Map<string, OnCompleteCallback> = this.listeners.get(tabid) ?? new Map;\r\n        for (const listener of current.values()) {\r\n            webRequest.onCompleted.removeListener(listener);\r\n        }\r\n        this.listeners.delete(tabid);\r\n    }\r\n\r\n    private async register(tabid: number, key: string, urls: string[]): Promise<void> {\r\n        const callback = async (request: WebRequest.OnCompletedDetailsType): Promise<void> => {\r\n            try {\r\n                await browser.tabs.get(tabid);\r\n            } catch {\r\n                this.unregister(tabid);\r\n                return;\r\n            }\r\n\r\n            browser.tabs.sendMessage(tabid, {\r\n                key,\r\n                url: request.url\r\n            });\r\n        }\r\n\r\n        const current: Map<string, OnCompleteCallback> = this.listeners.get(tabid) ?? new Map();\r\n        if (!current.has(key)) {\r\n            current.set(key, callback);\r\n            this.listeners.set(tabid, current);\r\n\r\n            webRequest.onCompleted.addListener(callback, {urls});\r\n        }\r\n    }\r\n\r\n    handle(message: any, tab: Tabs.Tab): typeof Unrecognized|Promise<any> {\r\n        if (!tab.id) {\r\n            throw new Error(\"Requires tab\");\r\n        }\r\n\r\n        switch(message.action) {\r\n            case EAction.Listener_Register:\r\n                return this.register(tab.id, message.params.key, message.params.urls);\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n", "import type MessageHandlerInterface from \"@Background/MessageHandlerInterface\";\r\nimport {EAction} from \"@Background/EAction\";\r\nimport {Unrecognized} from \"@Background/background\";\r\n\r\nexport default class SessionCacheApi implements MessageHandlerInterface{\r\n\r\n    #storage = new Map<string, any>();\r\n\r\n    private setValue(prefix: string, key: string, value: any): void {\r\n        this.#storage.set(prefix+\"/\"+key, value);\r\n    }\r\n\r\n    private getValue(prefix: string, key: string): any {\r\n        return this.#storage.get(prefix+\"/\"+key) ?? null;\r\n    }\r\n\r\n    handle(message: any): typeof Unrecognized|Promise<any> {\r\n\r\n        switch (message.action) {\r\n            case EAction.SessionCacheSet: {\r\n                this.setValue(message.params.prefix, message.params.key, message.params.value);\r\n                return Promise.resolve();\r\n            }\r\n\r\n            case EAction.SessionCacheGet: {\r\n                return Promise.resolve(this.getValue(message.params.prefix, message.params.key));\r\n            }\r\n        }\r\n\r\n        return Unrecognized;\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": ["globalThis", "chrome", "runtime", "id", "Error", "browser", "Object", "getPrototypeOf", "prototype", "CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE", "wrapAPIs", "extensionAPIs", "apiMetadata", "keys", "length", "DefaultWeakMap", "WeakMap", "constructor", "createItem", "items", "undefined", "get", "key", "has", "set", "isThenable", "value", "then", "makeCallback", "promise", "metadata", "callbackArgs", "lastError", "reject", "message", "singleCallbackArg", "resolve", "pluralizeArguments", "numArgs", "wrapAsyncFunction", "name", "target", "args", "minArgs", "maxArgs", "Promise", "fallbackToNoCallback", "cbError", "console", "warn", "noCallback", "wrapMethod", "method", "wrapper", "Proxy", "apply", "targetMethod", "thisObj", "call", "hasOwnProperty", "Function", "bind", "wrapObject", "wrappers", "cache", "create", "handlers", "proxyTarget", "prop", "receiver", "defineProperty", "configurable", "enumerable", "desc", "Reflect", "deleteProperty", "wrapEvent", "wrapperMap", "addListener", "listener", "hasListener", "removeListener", "onRequestFinishedWrappers", "req", "wrappedReq", "getContent", "onMessageWrappers", "sender", "sendResponse", "didCallSendResponse", "wrappedSendResponse", "sendResponsePromise", "response", "result", "err", "isResultThenable", "sendPromisedResult", "msg", "error", "__mozWebExtensionPolyfillReject__", "catch", "wrappedSendMessageCallback", "reply", "wrappedSendMessage", "apiNamespaceObj", "wrappedCb", "push", "sendMessage", "staticWrappers", "devtools", "network", "onRequestFinished", "onMessage", "onMessageExternal", "tabs", "settingMetadata", "clear", "privacy", "services", "websites", "module", "exports", "background_exports", "__export", "Unrecognized", "__options_contextSteamStore", "__options_contextSteamLucky", "__options_contextSteamMarket", "__options_contextItad", "__options_contextBartervg", "__options_contextSteamdb", "__options_contextSteamdbInstant", "__options_contextSteamKeys", "__userNote_syncErrorEmpty", "__userNote_syncErrorUnknown", "__userNote_syncErrorLength", "import_webextension_polyfill", "Info_default", "browser", "import_webextension_polyfill", "import_webextension_polyfill", "Storage", "storageArea", "key", "object", "value", "keys", "SyncedStorage", "Storage", "browser", "SyncedStorage_default", "DefaultSettings", "Info_default", "Event", "listener", "SettingsStore", "SyncedStorage", "key", "value", "data", "Settings_default", "target", "prop", "import_webextension_polyfill", "ExtensionResources", "_ExtensionResources", "pathname", "browser", "Language", "_Language", "language", "languages", "import_webextension_polyfill", "ErrorParser", "errStr", "info", "Background", "action", "params", "result", "browser", "e", "error", "ErrorParser", "SteamStoreApiFacade", "appid", "Background", "filter", "appName", "lang", "ids", "Localization", "code", "ExtensionResources", "current", "stored", "Settings_default", "Language", "SteamStoreApiFacade", "lang", "L", "key", "replacements", "text", "value", "import_webextension_polyfill", "ContextMenu", "_ContextMenu", "__options_contextSteamStore", "Settings_default", "__options_contextSteamLucky", "__options_contextSteamMarket", "__options_contextItad", "__options_contextBartervg", "__options_contextSteamdb", "__options_contextSteamdbInstant", "__options_contextSteamKeys", "browser", "info", "menuItem", "url", "query", "steamKeys", "SettingsStore", "Localization", "id", "locale", "query_", "enabled", "L", "instanceOfAny", "object", "constructors", "c", "idbProxyableTypes", "cursorAdvanceMethods", "getIdbProxyableTypes", "getCursorAdvanceMethods", "cursorRequestMap", "transactionDoneMap", "transactionStoreNamesMap", "transformCache", "reverseTransformCache", "promisifyRequest", "request", "promise", "resolve", "reject", "unlisten", "success", "error", "wrap", "value", "cacheDonePromiseForTransaction", "tx", "done", "complete", "idbProxyTraps", "target", "prop", "receiver", "replaceTraps", "callback", "wrapFunction", "func", "storeNames", "args", "unwrap", "transformCachableValue", "newValue", "openDB", "name", "version", "blocked", "upgrade", "blocking", "terminated", "request", "openPromise", "wrap", "event", "db", "readMethods", "writeMethods", "cachedMethods", "getMethod", "target", "prop", "targetFuncName", "useIndex", "isWrite", "method", "storeName", "args", "tx", "replaceTraps", "oldTraps", "receiver", "upgrade", "db", "oldVersion", "newVersion", "tx", "collectionKeys", "collection", "key", "Migration_default", "import_webextension_polyfill", "LocalStorage", "Storage", "browser", "LocalStorage_default", "Timer", "duration", "resolve", "onDone", "ResettableTimer", "TimeUtils", "timestamp", "IndexedDB", "_IndexedDB", "openDB", "Info_default", "Migration_default", "dbCleanup", "LocalStorage_default", "TimeUtils", "promises", "tx", "cursor", "storeName", "indexName", "expiry", "ttlSeconds", "value", "key", "data", "store", "keys", "result", "k", "key_", "LoginError", "type", "ServerOutageError", "msg", "OAuthUnauthorized", "HTTPError", "code", "message", "FeatureDependencyError", "featureName", "Errors_default", "Api", "origin", "path", "query", "url", "key", "value", "init", "response", "Errors_default", "HTMLParser", "source", "regex", "m", "node", "nameOrRegex", "v", "import_webextension_polyfill", "OffscreenDocument", "OffscreenDomParser", "matchedClients", "client", "browser", "op", "html", "response", "DomParserFactory", "OffscreenDomParser", "SteamCommunityApi", "Api", "url", "response", "Errors_default", "steamid", "appid", "id", "html", "size", "DomParserFactory", "preventFetch", "entry", "IndexedDB", "TimeUtils", "steamId", "pages", "parser", "reviews", "defaultOrder", "p", "parsedReviews", "review", "profilePath", "login", "LocalStorage_default", "HTMLParser", "value", "force", "newCountry", "message", "Unrecognized", "SteamStoreApi", "Api", "url", "response", "Errors_default", "subid", "details", "obj", "subids", "result", "toFetch", "data", "IndexedDB", "entry", "TimeUtils", "newData", "appids", "appid", "sessionid", "parser", "html", "stored", "LocalStorage_default", "DomParserFactory", "currency", "HTMLParser", "lang", "appName", "purchaseDates", "store", "rgOwnedApps", "rgOwnedPackages", "rgIgnoredApps", "rgWishlist", "rgFollowedApps", "ignored", "ignoredOwnedElsewhere", "appid_", "value", "ids", "index", "ignoredOwned", "owned", "wishlisted", "followed", "strId", "parts", "type", "id", "keys", "key", "ownedApps", "filter", "strAppid", "message", "Unrecognized", "config_default", "import_webextension_polyfill", "AccessToken", "data", "LocalStorage_default", "TimeUtils", "token", "expiresIn", "Authorization", "length", "source", "arr", "result", "value", "str", "data", "sha256Buffer", "authTabId", "resolve", "reject", "updateListener", "tabId", "changeInfo", "_tab", "browser", "removeListener", "_removeInfo", "scope", "verifier", "state", "authUrl", "config_default", "tab", "responseUrl", "code", "tokenUrl", "params", "tokens", "accessToken", "expiresIn", "AccessToken", "OutOfCapacityError", "ratio", "message", "CapacityInfo", "closeToFull", "utilization", "SyncedStorageAdapter", "SyncedStorage_default", "appid", "note", "appids", "result", "notes", "appidStr", "notesObj", "storageUsage", "OutOfCapacityError", "CapacityInfo", "map", "MaxNoteLength", "SyncEventsLimit", "StoreListTTL", "PushGamesInterval", "PullWaitlistInterval", "PullCollectionInterval", "PullNotesInterval", "RequiredScopes", "ITADApi", "Api", "config_default", "url", "storeList", "store", "gids", "obj", "map", "itad", "steamIds", "steamId", "steam", "accessToken", "AccessToken", "collectionResponse", "collection", "game", "copiesResponse", "item", "gid", "copy", "tag", "idMap", "result", "itadId", "waitlist", "entry", "IndexedDB", "LocalStorage_default", "lastImport", "TimeUtils", "section", "type", "count", "events", "appids", "appid", "id", "value", "response", "Errors_default", "subids", "steamids", "subid", "key", "force", "SettingsStore", "Settings_default", "tx", "dynamicStore", "itadImport", "lastOwnedApps", "lastOwnedPackages", "ownedApps", "ownedPackages", "newOwnedApps", "newOwnedPackages", "lastWishlisted", "wishlisted", "newWishlisted", "data", "storeIds", "storeId", "notes", "o", "note", "adapter", "SyncedStorageAdapter", "status", "toPush", "__userNote_syncErrorEmpty", "__userNote_syncErrorLength", "__userNote_syncErrorUnknown", "message", "Authorization", "Unrecognized", "AugmentedSteamApi", "Api", "config_default", "appid", "url", "to", "steamId", "twitchChannelId", "currency", "appids", "country", "apps", "subs", "bundles", "voucher", "shops", "data", "IndexedDB", "TimeUtils", "key", "rates", "message", "Unrecognized", "UserNotesApi", "appids", "IndexedDB", "appid", "note", "cursor", "result", "notes", "message", "Unrecognized", "import_webextension_polyfill", "GameId", "type_", "id_", "AppId", "GameId", "url", "m", "CDNRegex_1", "CDNRegex_2", "element", "appid", "href", "src", "text", "regex", "result", "id", "InventoryApi", "Api", "contextId", "login", "LocalStorage_default", "data", "url", "hasMoreItems", "response", "Errors_default", "result", "coupons", "description", "coupon", "desc", "i", "value", "action", "match", "packageidStr", "packageid", "packages", "SteamStoreApi", "subid", "gifts", "passes", "isPackage", "d", "appids", "AppId", "appid", "item", "IndexedDB", "tx", "couponsSet", "giftsSet", "passesSet", "hashes", "hash", "message", "Unrecognized", "CacheApi", "LocalStorage_default", "IndexedDB", "message", "Unrecognized", "Environment", "context", "Version", "_Version", "major", "minor", "patch", "version", "Info_default", "_version", "SettingsMigration", "oldVersion", "storage", "SyncedStorage", "showusernotes", "SettingsStore", "links", "link", "options", "customizerKey", "shopUpdateMap", "excluded", "oldKey", "value", "AccessToken", "import_webextension_polyfill", "WebRequestHandler", "tabid", "current", "listener", "key", "urls", "callback", "request", "browser", "message", "tab", "Unrecognized", "SessionCacheApi", "#storage", "prefix", "key", "value", "message", "Unrecognized", "Environment", "Unrecognized", "browser", "detail", "oldVersion", "Version", "IndexedDB", "SettingsMigration", "CacheApi", "Storage", "messageHandlers", "AugmentedSteamApi", "SteamCommunityApi", "InventoryApi", "ITADApi", "SteamStoreApi", "UserNotesApi", "WebRequestHandler", "SessionCacheApi", "message", "sender", "SettingsStore", "response", "handler", "err", "ContextMenu"]
}
