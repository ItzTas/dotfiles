const pluginName = "alowave.faceit_stats";
function InitializePlugins() {
    /**
     * This function is called n times depending on n plugin count,
     * Create the plugin list if it wasn't already created
     */
    !window.PLUGIN_LIST && (window.PLUGIN_LIST = {});
    // initialize a container for the plugin
    if (!window.PLUGIN_LIST[pluginName]) {
        window.PLUGIN_LIST[pluginName] = {};
    }
}
InitializePlugins()
const __call_server_method__ = (methodName, kwargs) => Millennium.callServerMethod(pluginName, methodName, kwargs)
const __wrapped_callable__ = (route) => MILLENNIUM_API.callable(__call_server_method__, route)
var millennium_main=function(e){"use strict";return function(){const e={};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}(),e.default=async function(){console.log("FaceIt Stats loaded.");const e=await Millennium.findElement(document,".profile_rightcol");if(e.length>0){console.log("Detected rightcol.");const n=document.createElement("div");n.className="account-row",n.innerHTML='\n            <div class="faceit-loading-container">\n                <div class="faceit-spinner"></div>\n                <div class="faceit-loading-text">Loading Faceit data...</div>\n            </div>\n        ',e[0].insertBefore(n,e[0].children[1]);try{const t=new DOMParser,a=`${window.location.href}/?xml=1`,s=await fetch(a),c=await s.text(),i=t.parseFromString(c,"application/xml"),o=i.querySelector("steamID64")?.textContent||"0",l=i.querySelector("memberSince")?.textContent||"N/A",r=parseInt(i.querySelector("vacBanned")?.textContent||"0",10),d=i.querySelector("tradeBanState")?.textContent||"Not played.",u=parseInt(i.querySelector("isLimitedAccount")?.textContent||"0",10),m=`${window.location.href}/games?tab=all&xml=1`,v=await fetch(m),g=await v.text(),f=t.parseFromString(g,"application/xml"),p=Array.from(f.querySelectorAll("game")).find((e=>"730"===e.querySelector("appID")?.textContent)),h=p&&p.querySelector("hoursOnRecord")?.textContent||"Private",w=p?p.querySelector("hoursLast2Weeks")?.textContent||"0":"Private",_=`${window.location.href}/stats/CSGO?xml=1`,y=await fetch(_),k=await y.text(),$=t.parseFromString(k,"application/xml"),S=$.querySelector("achievement > unlockTimestamp")?.textContent??null,x=S?new Date(1e3*parseInt(S,10)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"None",b=await __call_server_method__("get_user_by_steamId",{steamId:o}),C=JSON.parse(b),F=await __call_server_method__("get_aim_rating",{steamId:o}),I=document.createElement("div");I.innerHTML=`\n            <div class="account-row">\n                <div id="steaminfo_76561198328925991" class="account-steaminfo-container">\n                    <div class="account-steaminfo-row">\n                        <ul style="margin: 0; padding: 0;">\n                            <li class="tick acc_created">Created: <span class="account-steaminfo-row-value">${l}</span></li>\n                        </ul>\n                    </div>\n                    <div class="account-steaminfo-row">\n                        <ul style="margin: 0; padding: 0;">\n                            <li class="tick">Restrictions:\n                                <span class="account-steaminfo-row-value ${0===r?"account-steaminfo-row-value-confirmed":"account-steaminfo-row-value-urgent"}">VAC</span>\n                                <span class="account-steaminfo-row-value ${"None"===d?"account-steaminfo-row-value-confirmed":"account-steaminfo-row-value-urgent"}">Trade</span>\n                                <span class="account-steaminfo-row-value ${0===u?"account-steaminfo-row-value-confirmed":"account-steaminfo-row-value-urgent"}">Limited</span>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="account-steaminfo-row">\n                        <ul style="margin: 0; padding: 0;">\n                            <li class="cross">CS2 since: <span class="account-steaminfo-row-value">${x}</span></li>\n                        </ul>\n                    </div>\n                    <div class="account-steaminfo-row">\n                        <ul style="margin: 0; padding: 0;">\n                            <li class="tick">CS total hours: <a target="_blank" class="nolink" href="https://steamcommunity.com/profiles/${o}/games/?tab=all" rel="noopener"><span class="account-steaminfo-row-value">${h}</span></a></li>\n                        </ul>\n                    </div>\n                    <div class="account-steaminfo-row">\n                        <ul style="margin: 0; padding: 0;">\n                            <li class="tick">CS2 last 2 weeks hours: <a target="_blank" class="nolink" href="https://steamcommunity.com/profiles/${o}/games/?tab=recent" rel="noopener"><span class="account-steaminfo-row-value">${w}</span></a></li>\n                        </ul>\n                    </div>\n                    <div class="account-steaminfo-row">\n                        <ul style="margin: 0; padding: 0;">\n                            <li class="tick">Leetify aim rating: <a target="_blank" class="nolink" href="https://leetify.com/app/profile/${o}" rel="noopener"><span class="account-steaminfo-row-value">${0!=F?`${F}%`:"N/A"}</span></a></li>\n                        </ul>\n                    </div>\n                </div>\n                <div class="account-faceitinfo-container">\n                    <div class="account-faceit-cover" style="background-image: url(${C?.cover_image_url??""})"></div>\n                    ${C?`\n                            <a target="_blank" class="nolink" href="https://www.faceit.com/en/players/${C?.nickname??""}" rel="noopener">\n                                <img src="https://steamloopback.host/FaceItFinder/faceit_arrow.png" class="account-faceitinfo-container-arrow" alt="FaceIt profile arrow">\n                            </a>\n                            <div class="account-faceit-title">\n                                <a target="_blank" class="nolink" href="https://www.faceit.com/en/players/${C?.nickname??""}" rel="noopener">\n                                    <img class="account-faceit-flag" src="https://faceitfinder.com/resources/flags/svg/${C?.country??"default"}.svg" alt="FaceIt country flag" width="26" height="20">\n                                    <span class="account-faceit-title-username">${C?.nickname??"Unknown"}</span>\n                                </a>\n                            </div>\n                            <div class="account-faceit-level">\n                                <a target="_blank" class="nolink" href="https://www.faceit.com/en/players/${C?.nickname??""}/stats/cs2" rel="noopener">\n                                    <img src="https://steamloopback.host/FaceItFinder/skill_level_${C?.skill_level??0}_lg.png" alt="FaceIt level ${C?.skill_level??0} icon" width="48" height="48">\n                                </a>\n                            </div>\n                            <div class="stats_pager">\n                                <div class="account-faceit-stats page1">\n                                    <div class="account-faceit-stats-single">Matches: <strong>${C?.stats?.matches??"N/A"}</strong></div>\n                                    <div class="account-faceit-stats-single">ELO: <strong>${C?.faceit_elo??"N/A"}</strong></div>\n                                    <div class="account-faceit-stats-single">K/D: <strong>${C?.stats?.avg_kd??"N/A"}</strong></div>\n                                </div>\n                                <div class="account-faceit-stats page2 hidden">\n                                    <div class="account-faceit-stats-single">H/S: <strong>${C?.stats?.avg_hs??"N/A"}</strong></div>\n                                    <div class="account-faceit-stats-single">ADR: <strong>${C?.stats?.adr??"N/A"}</strong></div>\n                                    <div class="account-faceit-stats-single">WIN: <strong>${C?.stats?.winrate??"N/A"}</strong></div>\n                                </div>\n                            </div>\n                            <div class="account-faceit-detailed-stats">\n                                <a class="nolink" href="https://faceittracker.net/players/${C?.nickname??""}">Show detailed Faceit stats</a>\n                            </div>\n                            `:'<div class="account-faceit-message"><strong>No FaceIt account found.</strong></div>'}\n                </div>\n            </div>\n            `,e[0].removeChild(n),e[0].insertBefore(I,e[0].children[1]);const L=I.querySelector(".stats_pager");L&&L.addEventListener("click",(()=>{const e=L.querySelector(".page1"),n=L.querySelector(".page2");e.classList.contains("hidden")?(e.classList.remove("hidden"),n.classList.add("hidden")):(e.classList.add("hidden"),n.classList.remove("hidden"))}))}catch(t){console.log(t);try{e[0].removeChild(n);const t=document.createElement("div");t.className="account-row",t.innerHTML='\n                    <div class="account-container">\n                        <div class="account-faceit-message">\n                            <strong>Failed to load Faceit data.</strong>\n                        </div>\n                    </div>\n                ',e[0].insertBefore(t,e[0].children[1])}catch(e){console.log("Error cleaning up loading spinner:",e)}}}else console.error('Parent container ".profile_rightcol" not found')},Object.defineProperty(e,"__esModule",{value:!0}),e}({});

function ExecuteWebkitModule() {
    // Assign the plugin on plugin list.
    Object.assign(window.PLUGIN_LIST[pluginName], millennium_main);
    // Run the rolled up plugins default exported function
    millennium_main["default"]();
}
ExecuteWebkitModule()